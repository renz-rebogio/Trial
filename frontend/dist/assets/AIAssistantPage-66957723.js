var ya=Object.defineProperty;var _a=(s,t,e)=>t in s?ya(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var A=(s,t,e)=>(_a(s,typeof t!="symbol"?t+"":t,e),e);import{c as Et,j as f,m as Vs,B as ro,u as z,p as kn,_ as As,I as va,F as wa,a as ft,q as ka,L as Sa,x as Ma,w as Ca,E as Aa}from"./index-b765cb56.js";import{C as De,a as je,b as Te,d as lo,c as Oe}from"./card-e310dec2.js";import{T as Pa}from"./textarea-963d3648.js";import{U as co}from"./upload-cloud-d777fa41.js";import{X as Na}from"./x-circle-003a14ef.js";import{A as Da,b as pt}from"./boogasiAiClient-c7014b7f.js";import{C as ja}from"./check-circle-09be6f02.js";import{A as os}from"./alert-triangle-ba820bf9.js";import{I as Ta}from"./info-823ce63d.js";import{T as Ys}from"./trending-up-60645cd5.js";import{L as Oa}from"./lock-69a1ac57.js";const ho=Et("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Ia=Et("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]),Ra=Et("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]),La=Et("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),Fa=Et("Combine",[["rect",{width:"8",height:"8",x:"2",y:"2",rx:"2",key:"z1hh3n"}],["path",{d:"M14 2c1.1 0 2 .9 2 2v4c0 1.1-.9 2-2 2",key:"83orz6"}],["path",{d:"M20 2c1.1 0 2 .9 2 2v4c0 1.1-.9 2-2 2",key:"k86dmt"}],["path",{d:"M10 18H5c-1.7 0-3-1.3-3-3v-1",key:"6vokjl"}],["polyline",{points:"7 21 10 18 7 15",key:"1k02g0"}],["rect",{width:"8",height:"8",x:"14",y:"14",rx:"2",key:"1fa9i4"}]]),Ea=Et("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Ba=Et("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),$a=Et("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),za=()=>f.jsxs(Vs.div,{className:"text-center mb-12",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[f.jsx("div",{className:"inline-block p-3 bg-gradient-to-r from-primary to-secondary rounded-full mb-4 shadow-lg",children:f.jsx(ro,{className:"h-10 w-10 text-primary-foreground"})}),f.jsx("h1",{className:"text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary via-secondary to-accent mb-4",children:"Boogasi AI Financial Assistant"}),f.jsx("p",{className:"text-lg md:text-xl text-muted-foreground max-w-3xl mx-auto",children:"Upload your financial documents (statements, invoices) or enter data manually. Our AI will analyze, summarize, and provide actionable insights."})]}),zt=10;function Ha({selectedFiles:s=[],handleFileChange:t,removeFile:e,manualTransactions:n,setManualTransactions:i,acceptedFileTypes:o=".csv, .pdf, .png, .jpeg, .jpg"}){const a=z.useRef(null),[r,l]=z.useState(!1),c=()=>{var p;s.length<zt&&((p=a.current)==null||p.click())},d=p=>{typeof t=="function"&&t(p)},h=p=>{var x;if(p.preventDefault(),l(!1),s.length>=zt)return;const m=(x=p.dataTransfer)==null?void 0:x.files;if(!m||m.length===0)return;typeof t=="function"&&t({target:{files:m}})},u=p=>{p.preventDefault(),p.dataTransfer.dropEffect="copy",l(!0)},g=p=>{p.preventDefault(),l(!1)};return f.jsxs(De,{className:"glassmorphic shadow-xl border-[hsl(var(--brighter-teal))]/30 bg-[hsl(var(--card-bg-bright-teal-tint))]",children:[f.jsxs(je,{children:[f.jsx(Te,{className:"text-2xl text-primary-foreground",children:"Input Your Financial Data"}),f.jsxs(lo,{className:"text-muted-foreground",children:["Upload up to ",zt," files (CSV, PDF, PNG, JPG) or paste transaction data."]})]}),f.jsxs(Oe,{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsxs(kn,{htmlFor:"transactions-file-input",className:"text-lg font-medium text-primary-foreground",children:["Upload Files (Max ",zt,")"]}),f.jsxs("div",{className:As("mt-2 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md transition-all cursor-pointer",r?"border-[hsl(var(--boogasi-green-val))] bg-[hsl(var(--boogasi-green-val))]/10":"border-muted-foreground/50 hover:border-[hsl(var(--boogasi-green-val))]",s.length>=zt&&"opacity-50 cursor-not-allowed"),onClick:c,onDrop:h,onDragOver:u,onDragLeave:g,children:[f.jsxs("div",{className:"space-y-1 text-center pointer-events-none",children:[f.jsx(co,{className:As("mx-auto h-12 w-12 text-muted-foreground icon-neon-green file-upload-icon",r&&"text-[hsl(var(--boogasi-green-val))]")}),f.jsxs("div",{className:"flex text-sm text-muted-foreground",children:[f.jsx("span",{className:"font-medium text-[hsl(var(--boogasi-blue-val))]",children:r?"Drop files here":"Click to select files"}),f.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"CSV, PDF, PNG, JPG up to 5MB each"})]}),f.jsx(va,{ref:a,id:"transactions-file-input",name:"transactions-file-input",type:"file",className:"sr-only",onChange:d,accept:o,multiple:!0,disabled:s.length>=zt})]}),s.length>0&&f.jsxs("div",{className:"mt-4 space-y-2",children:[f.jsxs("p",{className:"text-sm font-medium text-primary-foreground",children:["Selected Files (",s.length,"/",zt,"):"]}),f.jsx("ul",{className:"max-h-40 overflow-y-auto space-y-1 rounded-md border border-border p-2 bg-input/50",children:s.map((p,m)=>f.jsxs("li",{className:"flex items-center justify-between text-sm text-muted-foreground p-1.5 rounded hover:bg-muted/50",children:[f.jsxs("div",{className:"flex items-center truncate",children:[f.jsx(wa,{className:As("h-4 w-4 mr-2 flex-shrink-0 icon-neon-green selected-file-icon")}),f.jsx("span",{className:"truncate",title:p.name,children:p.name})]}),f.jsx(ft,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>e(m),children:f.jsx(Na,{className:"h-4 w-4 text-[hsl(var(--boogasi-pink-val))]"})})]},m))})]})]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-0 flex items-center",children:f.jsx("span",{className:"w-full border-t border-border"})}),f.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:f.jsx("span",{className:"bg-card px-2 text-muted-foreground",children:"Or"})})]}),f.jsxs("div",{children:[f.jsx(kn,{htmlFor:"manual-transactions",className:"text-lg font-medium text-primary-foreground",children:"Manual Transaction Input (CSV Format)"}),f.jsx(Pa,{id:"manual-transactions",placeholder:"Paste transactions here (e.g., Date,Description,Category,Amount)...",className:"mt-2 min-h-[150px] bg-input text-foreground placeholder:text-muted-foreground border-border focus:border-[hsl(var(--brighter-teal))] focus:ring-[hsl(var(--brighter-teal))]",value:n,onChange:p=>i(p.target.value)}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Format: Date, Description, Category, Amount (one transaction per line)."})]})]})]})}const Sn=(s=0)=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(s);function Wa(s){try{const t=s.match(/rgb\s*\(\s*(\d+),\s*(\d+),\s*(\d+)\s*\)/i);if(t){const e=Number(t[1]),n=Number(t[2]),i=Number(t[3]);return(.299*e+.587*n+.114*i)/255>.6?"#111":"#fff"}}catch{}return"#111"}function bs({insights:s={},transactions:t=[],hiddenTxIndices:e=new Set}){const n=(s==null?void 0:s.flagged)||(s==null?void 0:s.flags)||[],[i,o]=z.useState(()=>new Set),a=z.useMemo(()=>{const r=new Map;n.forEach(c=>{c.index!=null?r.set(Number(c.index),c):c.id!=null&&r.set(Number(c.id),c)});const l=[];return t.forEach((c,d)=>{const h=d,u=r.get(h)||n.find(g=>{var p;return g.date&&c.date&&g.date===((p=c.date)==null?void 0:p.toString().slice(0,10))&&Math.abs((Number(g.amount)||0)-(Number(c.amount)||0))<.01&&String(g.description||"").slice(0,40).toLowerCase()===String(c.description||"").slice(0,40).toLowerCase()});u&&l.push({txIndex:d,tx:c,flag:u})}),l},[n,t]);return a.length?f.jsxs("div",{className:"rounded-lg border bg-white shadow p-4 text-gray-800",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Flagged transactions"}),f.jsxs("span",{className:"text-sm text-gray-500",children:[a.length," flagged"]})]}),f.jsx("ul",{className:"space-y-3",children:a.map(({txIndex:r,tx:l,flag:c})=>{if(i.has(r)||e.has(r))return null;const d=c.severity==="high"?"#ef4444":c.severity==="medium"?"#f59e0b":"#fde68a",h=Wa(d);return f.jsxs("li",{className:"p-3 border rounded flex justify-between items-start bg-white",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-baseline space-x-3",children:[f.jsx("span",{className:"text-sm text-gray-600",children:new Date(c.date||l.date||l.date_raw).toLocaleDateString("en-PH")}),f.jsx("strong",{className:"text-sm text-gray-800",children:l.description||c.description})]}),f.jsxs("div",{className:"mt-1 text-sm text-gray-800",children:[Sn(l.amount??c.amount),f.jsx("span",{style:{background:d,color:h},className:"ml-3 text-xs inline-block px-2 py-0.5 rounded",children:c.severity||"medium"})]}),f.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Reasons:"," ",(c.reasons||[c.reason]).filter(Boolean).join(", ")]}),c.baseline&&f.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["baseline median:"," ",Sn(c.baseline.median??c.baseline.median)," ","• mad:"," ",Number(c.baseline.mad??c.baseline.mad).toFixed(2)]})]}),f.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[f.jsx("button",{className:"text-sm text-indigo-600 hover:underline",onClick:()=>{o(u=>new Set([...u,r]))},children:"Dismiss"}),f.jsx("button",{className:"text-sm text-red-600 hover:underline",onClick:()=>{const u=new CustomEvent("hideTransaction",{detail:{index:r}});window.dispatchEvent(u),o(g=>new Set([...g,r]))},children:"Hide from list"})]})]},r)})})]}):null}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Ie(s){return s+.5|0}const Dt=(s,t,e)=>Math.max(Math.min(s,e),t);function ge(s){return Dt(Ie(s*2.55),0,255)}function Rt(s){return Dt(Ie(s*255),0,255)}function Ct(s){return Dt(Ie(s/2.55)/100,0,1)}function Mn(s){return Dt(Ie(s*100),0,100)}const ht={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Us=[..."0123456789ABCDEF"],Va=s=>Us[s&15],Ya=s=>Us[(s&240)>>4]+Us[s&15],Ee=s=>(s&240)>>4===(s&15),Ua=s=>Ee(s.r)&&Ee(s.g)&&Ee(s.b)&&Ee(s.a);function Ka(s){var t=s.length,e;return s[0]==="#"&&(t===4||t===5?e={r:255&ht[s[1]]*17,g:255&ht[s[2]]*17,b:255&ht[s[3]]*17,a:t===5?ht[s[4]]*17:255}:(t===7||t===9)&&(e={r:ht[s[1]]<<4|ht[s[2]],g:ht[s[3]]<<4|ht[s[4]],b:ht[s[5]]<<4|ht[s[6]],a:t===9?ht[s[7]]<<4|ht[s[8]]:255})),e}const Xa=(s,t)=>s<255?t(s):"";function Ga(s){var t=Ua(s)?Va:Ya;return s?"#"+t(s.r)+t(s.g)+t(s.b)+Xa(s.a,t):void 0}const qa=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function uo(s,t,e){const n=t*Math.min(e,1-e),i=(o,a=(o+s/30)%12)=>e-n*Math.max(Math.min(a-3,9-a,1),-1);return[i(0),i(8),i(4)]}function Ja(s,t,e){const n=(i,o=(i+s/60)%6)=>e-e*t*Math.max(Math.min(o,4-o,1),0);return[n(5),n(3),n(1)]}function Za(s,t,e){const n=uo(s,1,.5);let i;for(t+e>1&&(i=1/(t+e),t*=i,e*=i),i=0;i<3;i++)n[i]*=1-t-e,n[i]+=t;return n}function Qa(s,t,e,n,i){return s===i?(t-e)/n+(t<e?6:0):t===i?(e-s)/n+2:(s-t)/n+4}function ln(s){const e=s.r/255,n=s.g/255,i=s.b/255,o=Math.max(e,n,i),a=Math.min(e,n,i),r=(o+a)/2;let l,c,d;return o!==a&&(d=o-a,c=r>.5?d/(2-o-a):d/(o+a),l=Qa(e,n,i,d,o),l=l*60+.5),[l|0,c||0,r]}function cn(s,t,e,n){return(Array.isArray(t)?s(t[0],t[1],t[2]):s(t,e,n)).map(Rt)}function dn(s,t,e){return cn(uo,s,t,e)}function tr(s,t,e){return cn(Za,s,t,e)}function er(s,t,e){return cn(Ja,s,t,e)}function fo(s){return(s%360+360)%360}function sr(s){const t=qa.exec(s);let e=255,n;if(!t)return;t[5]!==n&&(e=t[6]?ge(+t[5]):Rt(+t[5]));const i=fo(+t[2]),o=+t[3]/100,a=+t[4]/100;return t[1]==="hwb"?n=tr(i,o,a):t[1]==="hsv"?n=er(i,o,a):n=dn(i,o,a),{r:n[0],g:n[1],b:n[2],a:e}}function nr(s,t){var e=ln(s);e[0]=fo(e[0]+t),e=dn(e),s.r=e[0],s.g=e[1],s.b=e[2]}function ir(s){if(!s)return;const t=ln(s),e=t[0],n=Mn(t[1]),i=Mn(t[2]);return s.a<255?`hsla(${e}, ${n}%, ${i}%, ${Ct(s.a)})`:`hsl(${e}, ${n}%, ${i}%)`}const Cn={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},An={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function or(){const s={},t=Object.keys(An),e=Object.keys(Cn);let n,i,o,a,r;for(n=0;n<t.length;n++){for(a=r=t[n],i=0;i<e.length;i++)o=e[i],r=r.replace(o,Cn[o]);o=parseInt(An[a],16),s[r]=[o>>16&255,o>>8&255,o&255]}return s}let Be;function ar(s){Be||(Be=or(),Be.transparent=[0,0,0,0]);const t=Be[s.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const rr=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function lr(s){const t=rr.exec(s);let e=255,n,i,o;if(t){if(t[7]!==n){const a=+t[7];e=t[8]?ge(a):Dt(a*255,0,255)}return n=+t[1],i=+t[3],o=+t[5],n=255&(t[2]?ge(n):Dt(n,0,255)),i=255&(t[4]?ge(i):Dt(i,0,255)),o=255&(t[6]?ge(o):Dt(o,0,255)),{r:n,g:i,b:o,a:e}}}function cr(s){return s&&(s.a<255?`rgba(${s.r}, ${s.g}, ${s.b}, ${Ct(s.a)})`:`rgb(${s.r}, ${s.g}, ${s.b})`)}const Ps=s=>s<=.0031308?s*12.92:Math.pow(s,1/2.4)*1.055-.055,te=s=>s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4);function dr(s,t,e){const n=te(Ct(s.r)),i=te(Ct(s.g)),o=te(Ct(s.b));return{r:Rt(Ps(n+e*(te(Ct(t.r))-n))),g:Rt(Ps(i+e*(te(Ct(t.g))-i))),b:Rt(Ps(o+e*(te(Ct(t.b))-o))),a:s.a+e*(t.a-s.a)}}function $e(s,t,e){if(s){let n=ln(s);n[t]=Math.max(0,Math.min(n[t]+n[t]*e,t===0?360:1)),n=dn(n),s.r=n[0],s.g=n[1],s.b=n[2]}}function go(s,t){return s&&Object.assign(t||{},s)}function Pn(s){var t={r:0,g:0,b:0,a:255};return Array.isArray(s)?s.length>=3&&(t={r:s[0],g:s[1],b:s[2],a:255},s.length>3&&(t.a=Rt(s[3]))):(t=go(s,{r:0,g:0,b:0,a:1}),t.a=Rt(t.a)),t}function hr(s){return s.charAt(0)==="r"?lr(s):sr(s)}class we{constructor(t){if(t instanceof we)return t;const e=typeof t;let n;e==="object"?n=Pn(t):e==="string"&&(n=Ka(t)||ar(t)||hr(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=go(this._rgb);return t&&(t.a=Ct(t.a)),t}set rgb(t){this._rgb=Pn(t)}rgbString(){return this._valid?cr(this._rgb):void 0}hexString(){return this._valid?Ga(this._rgb):void 0}hslString(){return this._valid?ir(this._rgb):void 0}mix(t,e){if(t){const n=this.rgb,i=t.rgb;let o;const a=e===o?.5:e,r=2*a-1,l=n.a-i.a,c=((r*l===-1?r:(r+l)/(1+r*l))+1)/2;o=1-c,n.r=255&c*n.r+o*i.r+.5,n.g=255&c*n.g+o*i.g+.5,n.b=255&c*n.b+o*i.b+.5,n.a=a*n.a+(1-a)*i.a,this.rgb=n}return this}interpolate(t,e){return t&&(this._rgb=dr(this._rgb,t._rgb,e)),this}clone(){return new we(this.rgb)}alpha(t){return this._rgb.a=Rt(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=Ie(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return $e(this._rgb,2,t),this}darken(t){return $e(this._rgb,2,-t),this}saturate(t){return $e(this._rgb,1,t),this}desaturate(t){return $e(this._rgb,1,-t),this}rotate(t){return nr(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function wt(){}const ur=(()=>{let s=0;return()=>s++})();function H(s){return s==null}function U(s){if(Array.isArray&&Array.isArray(s))return!0;const t=Object.prototype.toString.call(s);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function F(s){return s!==null&&Object.prototype.toString.call(s)==="[object Object]"}function G(s){return(typeof s=="number"||s instanceof Number)&&isFinite(+s)}function dt(s,t){return G(s)?s:t}function I(s,t){return typeof s>"u"?t:s}const fr=(s,t)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100:+s/t,po=(s,t)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100*t:+s;function Y(s,t,e){if(s&&typeof s.call=="function")return s.apply(e,t)}function W(s,t,e,n){let i,o,a;if(U(s))if(o=s.length,n)for(i=o-1;i>=0;i--)t.call(e,s[i],i);else for(i=0;i<o;i++)t.call(e,s[i],i);else if(F(s))for(a=Object.keys(s),o=a.length,i=0;i<o;i++)t.call(e,s[a[i]],a[i])}function as(s,t){let e,n,i,o;if(!s||!t||s.length!==t.length)return!1;for(e=0,n=s.length;e<n;++e)if(i=s[e],o=t[e],i.datasetIndex!==o.datasetIndex||i.index!==o.index)return!1;return!0}function rs(s){if(U(s))return s.map(rs);if(F(s)){const t=Object.create(null),e=Object.keys(s),n=e.length;let i=0;for(;i<n;++i)t[e[i]]=rs(s[e[i]]);return t}return s}function mo(s){return["__proto__","prototype","constructor"].indexOf(s)===-1}function gr(s,t,e,n){if(!mo(s))return;const i=t[s],o=e[s];F(i)&&F(o)?ke(i,o,n):t[s]=rs(o)}function ke(s,t,e){const n=U(t)?t:[t],i=n.length;if(!F(s))return s;e=e||{};const o=e.merger||gr;let a;for(let r=0;r<i;++r){if(a=n[r],!F(a))continue;const l=Object.keys(a);for(let c=0,d=l.length;c<d;++c)o(l[c],s,a,e)}return s}function xe(s,t){return ke(s,t,{merger:pr})}function pr(s,t,e){if(!mo(s))return;const n=t[s],i=e[s];F(n)&&F(i)?xe(n,i):Object.prototype.hasOwnProperty.call(t,s)||(t[s]=rs(i))}const Nn={"":s=>s,x:s=>s.x,y:s=>s.y};function mr(s){const t=s.split("."),e=[];let n="";for(const i of t)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(e.push(n),n="");return e}function br(s){const t=mr(s);return e=>{for(const n of t){if(n==="")break;e=e&&e[n]}return e}}function Lt(s,t){return(Nn[t]||(Nn[t]=br(t)))(s)}function hn(s){return s.charAt(0).toUpperCase()+s.slice(1)}const Se=s=>typeof s<"u",Ft=s=>typeof s=="function",Dn=(s,t)=>{if(s.size!==t.size)return!1;for(const e of s)if(!t.has(e))return!1;return!0};function xr(s){return s.type==="mouseup"||s.type==="click"||s.type==="contextmenu"}const $=Math.PI,K=2*$,yr=K+$,ls=Number.POSITIVE_INFINITY,_r=$/180,q=$/2,Ht=$/4,jn=$*2/3,jt=Math.log10,vt=Math.sign;function ye(s,t,e){return Math.abs(s-t)<e}function Tn(s){const t=Math.round(s);s=ye(s,t,s/1e3)?t:s;const e=Math.pow(10,Math.floor(jt(s))),n=s/e;return(n<=1?1:n<=2?2:n<=5?5:10)*e}function vr(s){const t=[],e=Math.sqrt(s);let n;for(n=1;n<e;n++)s%n===0&&(t.push(n),t.push(s/n));return e===(e|0)&&t.push(e),t.sort((i,o)=>i-o).pop(),t}function wr(s){return typeof s=="symbol"||typeof s=="object"&&s!==null&&!(Symbol.toPrimitive in s||"toString"in s||"valueOf"in s)}function cs(s){return!wr(s)&&!isNaN(parseFloat(s))&&isFinite(s)}function kr(s,t){const e=Math.round(s);return e-t<=s&&e+t>=s}function bo(s,t,e){let n,i,o;for(n=0,i=s.length;n<i;n++)o=s[n][e],isNaN(o)||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function mt(s){return s*($/180)}function un(s){return s*(180/$)}function On(s){if(!G(s))return;let t=1,e=0;for(;Math.round(s*t)/t!==s;)t*=10,e++;return e}function xo(s,t){const e=t.x-s.x,n=t.y-s.y,i=Math.sqrt(e*e+n*n);let o=Math.atan2(n,e);return o<-.5*$&&(o+=K),{angle:o,distance:i}}function Ks(s,t){return Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))}function Sr(s,t){return(s-t+yr)%K-$}function st(s){return(s%K+K)%K}function Me(s,t,e,n){const i=st(s),o=st(t),a=st(e),r=st(o-i),l=st(a-i),c=st(i-o),d=st(i-a);return i===o||i===a||n&&o===a||r>l&&c<d}function lt(s,t,e){return Math.max(t,Math.min(e,s))}function Mr(s){return lt(s,-32768,32767)}function At(s,t,e,n=1e-6){return s>=Math.min(t,e)-n&&s<=Math.max(t,e)+n}function fn(s,t,e){e=e||(a=>s[a]<t);let n=s.length-1,i=0,o;for(;n-i>1;)o=i+n>>1,e(o)?i=o:n=o;return{lo:i,hi:n}}const Xs=(s,t,e,n)=>fn(s,e,n?i=>{const o=s[i][t];return o<e||o===e&&s[i+1][t]===e}:i=>s[i][t]<e),Cr=(s,t,e)=>fn(s,e,n=>s[n][t]>=e);function Ar(s,t,e){let n=0,i=s.length;for(;n<i&&s[n]<t;)n++;for(;i>n&&s[i-1]>e;)i--;return n>0||i<s.length?s.slice(n,i):s}const yo=["push","pop","shift","splice","unshift"];function Pr(s,t){if(s._chartjs){s._chartjs.listeners.push(t);return}Object.defineProperty(s,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),yo.forEach(e=>{const n="_onData"+hn(e),i=s[e];Object.defineProperty(s,e,{configurable:!0,enumerable:!1,value(...o){const a=i.apply(this,o);return s._chartjs.listeners.forEach(r=>{typeof r[n]=="function"&&r[n](...o)}),a}})})}function In(s,t){const e=s._chartjs;if(!e)return;const n=e.listeners,i=n.indexOf(t);i!==-1&&n.splice(i,1),!(n.length>0)&&(yo.forEach(o=>{delete s[o]}),delete s._chartjs)}function _o(s){const t=new Set(s);return t.size===s.length?s:Array.from(t)}const vo=function(){return typeof window>"u"?function(s){return s()}:window.requestAnimationFrame}();function wo(s,t){let e=[],n=!1;return function(...i){e=i,n||(n=!0,vo.call(window,()=>{n=!1,s.apply(t,e)}))}}function Nr(s,t){let e;return function(...n){return t?(clearTimeout(e),e=setTimeout(s,t,n)):s.apply(this,n),t}}const gn=s=>s==="start"?"left":s==="end"?"right":"center",et=(s,t,e)=>s==="start"?t:s==="end"?e:(t+e)/2,Dr=(s,t,e,n)=>s===(n?"left":"right")?e:s==="center"?(t+e)/2:t,ze=s=>s===0||s===1,Rn=(s,t,e)=>-(Math.pow(2,10*(s-=1))*Math.sin((s-t)*K/e)),Ln=(s,t,e)=>Math.pow(2,-10*s)*Math.sin((s-t)*K/e)+1,_e={linear:s=>s,easeInQuad:s=>s*s,easeOutQuad:s=>-s*(s-2),easeInOutQuad:s=>(s/=.5)<1?.5*s*s:-.5*(--s*(s-2)-1),easeInCubic:s=>s*s*s,easeOutCubic:s=>(s-=1)*s*s+1,easeInOutCubic:s=>(s/=.5)<1?.5*s*s*s:.5*((s-=2)*s*s+2),easeInQuart:s=>s*s*s*s,easeOutQuart:s=>-((s-=1)*s*s*s-1),easeInOutQuart:s=>(s/=.5)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2),easeInQuint:s=>s*s*s*s*s,easeOutQuint:s=>(s-=1)*s*s*s*s+1,easeInOutQuint:s=>(s/=.5)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2),easeInSine:s=>-Math.cos(s*q)+1,easeOutSine:s=>Math.sin(s*q),easeInOutSine:s=>-.5*(Math.cos($*s)-1),easeInExpo:s=>s===0?0:Math.pow(2,10*(s-1)),easeOutExpo:s=>s===1?1:-Math.pow(2,-10*s)+1,easeInOutExpo:s=>ze(s)?s:s<.5?.5*Math.pow(2,10*(s*2-1)):.5*(-Math.pow(2,-10*(s*2-1))+2),easeInCirc:s=>s>=1?s:-(Math.sqrt(1-s*s)-1),easeOutCirc:s=>Math.sqrt(1-(s-=1)*s),easeInOutCirc:s=>(s/=.5)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1),easeInElastic:s=>ze(s)?s:Rn(s,.075,.3),easeOutElastic:s=>ze(s)?s:Ln(s,.075,.3),easeInOutElastic(s){return ze(s)?s:s<.5?.5*Rn(s*2,.1125,.45):.5+.5*Ln(s*2-1,.1125,.45)},easeInBack(s){return s*s*((1.70158+1)*s-1.70158)},easeOutBack(s){return(s-=1)*s*((1.70158+1)*s+1.70158)+1},easeInOutBack(s){let t=1.70158;return(s/=.5)<1?.5*(s*s*(((t*=1.525)+1)*s-t)):.5*((s-=2)*s*(((t*=1.525)+1)*s+t)+2)},easeInBounce:s=>1-_e.easeOutBounce(1-s),easeOutBounce(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},easeInOutBounce:s=>s<.5?_e.easeInBounce(s*2)*.5:_e.easeOutBounce(s*2-1)*.5+.5};function pn(s){if(s&&typeof s=="object"){const t=s.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Fn(s){return pn(s)?s:new we(s)}function Ns(s){return pn(s)?s:new we(s).saturate(.5).darken(.1).hexString()}const jr=["x","y","borderWidth","radius","tension"],Tr=["color","borderColor","backgroundColor"];function Or(s){s.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),s.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),s.set("animations",{colors:{type:"color",properties:Tr},numbers:{type:"number",properties:jr}}),s.describe("animations",{_fallback:"animation"}),s.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function Ir(s){s.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const En=new Map;function Rr(s,t){t=t||{};const e=s+JSON.stringify(t);let n=En.get(e);return n||(n=new Intl.NumberFormat(s,t),En.set(e,n)),n}function Re(s,t,e){return Rr(t,e).format(s)}const ko={values(s){return U(s)?s:""+s},numeric(s,t,e){if(s===0)return"0";const n=this.chart.options.locale;let i,o=s;if(e.length>1){const c=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(c<1e-4||c>1e15)&&(i="scientific"),o=Lr(s,e)}const a=jt(Math.abs(o)),r=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:i,minimumFractionDigits:r,maximumFractionDigits:r};return Object.assign(l,this.options.ticks.format),Re(s,n,l)},logarithmic(s,t,e){if(s===0)return"0";const n=e[t].significand||s/Math.pow(10,Math.floor(jt(s)));return[1,2,3,5,10,15].includes(n)||t>.8*e.length?ko.numeric.call(this,s,t,e):""}};function Lr(s,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&s!==Math.floor(s)&&(e=s-Math.floor(s)),e}var xs={formatters:ko};function Fr(s){s.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:xs.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),s.route("scale.ticks","color","","color"),s.route("scale.grid","color","","borderColor"),s.route("scale.border","color","","borderColor"),s.route("scale.title","color","","color"),s.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),s.describe("scales",{_fallback:"scale"}),s.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Jt=Object.create(null),Gs=Object.create(null);function ve(s,t){if(!t)return s;const e=t.split(".");for(let n=0,i=e.length;n<i;++n){const o=e[n];s=s[o]||(s[o]=Object.create(null))}return s}function Ds(s,t,e){return typeof t=="string"?ke(ve(s,t),e):ke(ve(s,""),t)}class Er{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>Ns(i.backgroundColor),this.hoverBorderColor=(n,i)=>Ns(i.borderColor),this.hoverColor=(n,i)=>Ns(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return Ds(this,t,e)}get(t){return ve(this,t)}describe(t,e){return Ds(Gs,t,e)}override(t,e){return Ds(Jt,t,e)}route(t,e,n,i){const o=ve(this,t),a=ve(this,n),r="_"+e;Object.defineProperties(o,{[r]:{value:o[e],writable:!0},[e]:{enumerable:!0,get(){const l=this[r],c=a[i];return F(l)?Object.assign({},c,l):I(l,c)},set(l){this[r]=l}}})}apply(t){t.forEach(e=>e(this))}}var X=new Er({_scriptable:s=>!s.startsWith("on"),_indexable:s=>s!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Or,Ir,Fr]);function Br(s){return!s||H(s.size)||H(s.family)?null:(s.style?s.style+" ":"")+(s.weight?s.weight+" ":"")+s.size+"px "+s.family}function ds(s,t,e,n,i){let o=t[i];return o||(o=t[i]=s.measureText(i).width,e.push(i)),o>n&&(n=o),n}function $r(s,t,e,n){n=n||{};let i=n.data=n.data||{},o=n.garbageCollect=n.garbageCollect||[];n.font!==t&&(i=n.data={},o=n.garbageCollect=[],n.font=t),s.save(),s.font=t;let a=0;const r=e.length;let l,c,d,h,u;for(l=0;l<r;l++)if(h=e[l],h!=null&&!U(h))a=ds(s,i,o,a,h);else if(U(h))for(c=0,d=h.length;c<d;c++)u=h[c],u!=null&&!U(u)&&(a=ds(s,i,o,a,u));s.restore();const g=o.length/2;if(g>e.length){for(l=0;l<g;l++)delete i[o[l]];o.splice(0,g)}return a}function Wt(s,t,e){const n=s.currentDevicePixelRatio,i=e!==0?Math.max(e/2,.5):0;return Math.round((t-i)*n)/n+i}function Bn(s,t){!t&&!s||(t=t||s.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,s.width,s.height),t.restore())}function qs(s,t,e,n){So(s,t,e,n,null)}function So(s,t,e,n,i){let o,a,r,l,c,d,h,u;const g=t.pointStyle,p=t.rotation,m=t.radius;let b=(p||0)*_r;if(g&&typeof g=="object"&&(o=g.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){s.save(),s.translate(e,n),s.rotate(b),s.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),s.restore();return}if(!(isNaN(m)||m<=0)){switch(s.beginPath(),g){default:i?s.ellipse(e,n,i/2,m,0,0,K):s.arc(e,n,m,0,K),s.closePath();break;case"triangle":d=i?i/2:m,s.moveTo(e+Math.sin(b)*d,n-Math.cos(b)*m),b+=jn,s.lineTo(e+Math.sin(b)*d,n-Math.cos(b)*m),b+=jn,s.lineTo(e+Math.sin(b)*d,n-Math.cos(b)*m),s.closePath();break;case"rectRounded":c=m*.516,l=m-c,a=Math.cos(b+Ht)*l,h=Math.cos(b+Ht)*(i?i/2-c:l),r=Math.sin(b+Ht)*l,u=Math.sin(b+Ht)*(i?i/2-c:l),s.arc(e-h,n-r,c,b-$,b-q),s.arc(e+u,n-a,c,b-q,b),s.arc(e+h,n+r,c,b,b+q),s.arc(e-u,n+a,c,b+q,b+$),s.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*m,d=i?i/2:l,s.rect(e-d,n-l,2*d,2*l);break}b+=Ht;case"rectRot":h=Math.cos(b)*(i?i/2:m),a=Math.cos(b)*m,r=Math.sin(b)*m,u=Math.sin(b)*(i?i/2:m),s.moveTo(e-h,n-r),s.lineTo(e+u,n-a),s.lineTo(e+h,n+r),s.lineTo(e-u,n+a),s.closePath();break;case"crossRot":b+=Ht;case"cross":h=Math.cos(b)*(i?i/2:m),a=Math.cos(b)*m,r=Math.sin(b)*m,u=Math.sin(b)*(i?i/2:m),s.moveTo(e-h,n-r),s.lineTo(e+h,n+r),s.moveTo(e+u,n-a),s.lineTo(e-u,n+a);break;case"star":h=Math.cos(b)*(i?i/2:m),a=Math.cos(b)*m,r=Math.sin(b)*m,u=Math.sin(b)*(i?i/2:m),s.moveTo(e-h,n-r),s.lineTo(e+h,n+r),s.moveTo(e+u,n-a),s.lineTo(e-u,n+a),b+=Ht,h=Math.cos(b)*(i?i/2:m),a=Math.cos(b)*m,r=Math.sin(b)*m,u=Math.sin(b)*(i?i/2:m),s.moveTo(e-h,n-r),s.lineTo(e+h,n+r),s.moveTo(e+u,n-a),s.lineTo(e-u,n+a);break;case"line":a=i?i/2:Math.cos(b)*m,r=Math.sin(b)*m,s.moveTo(e-a,n-r),s.lineTo(e+a,n+r);break;case"dash":s.moveTo(e,n),s.lineTo(e+Math.cos(b)*(i?i/2:m),n+Math.sin(b)*m);break;case!1:s.closePath();break}s.fill(),t.borderWidth>0&&s.stroke()}}function Pt(s,t,e){return e=e||.5,!t||s&&s.x>t.left-e&&s.x<t.right+e&&s.y>t.top-e&&s.y<t.bottom+e}function ys(s,t){s.save(),s.beginPath(),s.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),s.clip()}function _s(s){s.restore()}function zr(s,t,e,n,i){if(!t)return s.lineTo(e.x,e.y);if(i==="middle"){const o=(t.x+e.x)/2;s.lineTo(o,t.y),s.lineTo(o,e.y)}else i==="after"!=!!n?s.lineTo(t.x,e.y):s.lineTo(e.x,t.y);s.lineTo(e.x,e.y)}function Hr(s,t,e,n){if(!t)return s.lineTo(e.x,e.y);s.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?e.cp2x:e.cp1x,n?e.cp2y:e.cp1y,e.x,e.y)}function Wr(s,t){t.translation&&s.translate(t.translation[0],t.translation[1]),H(t.rotation)||s.rotate(t.rotation),t.color&&(s.fillStyle=t.color),t.textAlign&&(s.textAlign=t.textAlign),t.textBaseline&&(s.textBaseline=t.textBaseline)}function Vr(s,t,e,n,i){if(i.strikethrough||i.underline){const o=s.measureText(n),a=t-o.actualBoundingBoxLeft,r=t+o.actualBoundingBoxRight,l=e-o.actualBoundingBoxAscent,c=e+o.actualBoundingBoxDescent,d=i.strikethrough?(l+c)/2:c;s.strokeStyle=s.fillStyle,s.beginPath(),s.lineWidth=i.decorationWidth||2,s.moveTo(a,d),s.lineTo(r,d),s.stroke()}}function Yr(s,t){const e=s.fillStyle;s.fillStyle=t.color,s.fillRect(t.left,t.top,t.width,t.height),s.fillStyle=e}function Zt(s,t,e,n,i,o={}){const a=U(t)?t:[t],r=o.strokeWidth>0&&o.strokeColor!=="";let l,c;for(s.save(),s.font=i.string,Wr(s,o),l=0;l<a.length;++l)c=a[l],o.backdrop&&Yr(s,o.backdrop),r&&(o.strokeColor&&(s.strokeStyle=o.strokeColor),H(o.strokeWidth)||(s.lineWidth=o.strokeWidth),s.strokeText(c,e,n,o.maxWidth)),s.fillText(c,e,n,o.maxWidth),Vr(s,e,n,c,o),n+=Number(i.lineHeight);s.restore()}function Ce(s,t){const{x:e,y:n,w:i,h:o,radius:a}=t;s.arc(e+a.topLeft,n+a.topLeft,a.topLeft,1.5*$,$,!0),s.lineTo(e,n+o-a.bottomLeft),s.arc(e+a.bottomLeft,n+o-a.bottomLeft,a.bottomLeft,$,q,!0),s.lineTo(e+i-a.bottomRight,n+o),s.arc(e+i-a.bottomRight,n+o-a.bottomRight,a.bottomRight,q,0,!0),s.lineTo(e+i,n+a.topRight),s.arc(e+i-a.topRight,n+a.topRight,a.topRight,0,-q,!0),s.lineTo(e+a.topLeft,n)}const Ur=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Kr=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Xr(s,t){const e=(""+s).match(Ur);if(!e||e[1]==="normal")return t*1.2;switch(s=+e[2],e[3]){case"px":return s;case"%":s/=100;break}return t*s}const Gr=s=>+s||0;function mn(s,t){const e={},n=F(t),i=n?Object.keys(t):t,o=F(s)?n?a=>I(s[a],s[t[a]]):a=>s[a]:()=>s;for(const a of i)e[a]=Gr(o(a));return e}function Mo(s){return mn(s,{top:"y",right:"x",bottom:"y",left:"x"})}function Xt(s){return mn(s,["topLeft","topRight","bottomLeft","bottomRight"])}function nt(s){const t=Mo(s);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Q(s,t){s=s||{},t=t||X.font;let e=I(s.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let n=I(s.style,t.style);n&&!(""+n).match(Kr)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:I(s.family,t.family),lineHeight:Xr(I(s.lineHeight,t.lineHeight),e),size:e,style:n,weight:I(s.weight,t.weight),string:""};return i.string=Br(i),i}function He(s,t,e,n){let i=!0,o,a,r;for(o=0,a=s.length;o<a;++o)if(r=s[o],r!==void 0&&(t!==void 0&&typeof r=="function"&&(r=r(t),i=!1),e!==void 0&&U(r)&&(r=r[e%r.length],i=!1),r!==void 0))return n&&!i&&(n.cacheable=!1),r}function qr(s,t,e){const{min:n,max:i}=s,o=po(t,(i-n)/2),a=(r,l)=>e&&r===0?0:r+l;return{min:a(n,-Math.abs(o)),max:a(i,o)}}function Bt(s,t){return Object.assign(Object.create(s),t)}function bn(s,t=[""],e,n,i=()=>s[0]){const o=e||s;typeof n>"u"&&(n=No("_fallback",s));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:s,_rootScopes:o,_fallback:n,_getTarget:i,override:r=>bn([r,...s],t,o,n)};return new Proxy(a,{deleteProperty(r,l){return delete r[l],delete r._keys,delete s[0][l],!0},get(r,l){return Ao(r,l,()=>il(l,t,s,r))},getOwnPropertyDescriptor(r,l){return Reflect.getOwnPropertyDescriptor(r._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(s[0])},has(r,l){return zn(r).includes(l)},ownKeys(r){return zn(r)},set(r,l,c){const d=r._storage||(r._storage=i());return r[l]=d[l]=c,delete r._keys,!0}})}function ie(s,t,e,n){const i={_cacheable:!1,_proxy:s,_context:t,_subProxy:e,_stack:new Set,_descriptors:Co(s,n),setContext:o=>ie(s,o,e,n),override:o=>ie(s.override(o),t,e,n)};return new Proxy(i,{deleteProperty(o,a){return delete o[a],delete s[a],!0},get(o,a,r){return Ao(o,a,()=>Zr(o,a,r))},getOwnPropertyDescriptor(o,a){return o._descriptors.allKeys?Reflect.has(s,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(s,a)},getPrototypeOf(){return Reflect.getPrototypeOf(s)},has(o,a){return Reflect.has(s,a)},ownKeys(){return Reflect.ownKeys(s)},set(o,a,r){return s[a]=r,delete o[a],!0}})}function Co(s,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:n=t.indexable,_allKeys:i=t.allKeys}=s;return{allKeys:i,scriptable:e,indexable:n,isScriptable:Ft(e)?e:()=>e,isIndexable:Ft(n)?n:()=>n}}const Jr=(s,t)=>s?s+hn(t):t,xn=(s,t)=>F(t)&&s!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Ao(s,t,e){if(Object.prototype.hasOwnProperty.call(s,t)||t==="constructor")return s[t];const n=e();return s[t]=n,n}function Zr(s,t,e){const{_proxy:n,_context:i,_subProxy:o,_descriptors:a}=s;let r=n[t];return Ft(r)&&a.isScriptable(t)&&(r=Qr(t,r,s,e)),U(r)&&r.length&&(r=tl(t,r,s,a.isIndexable)),xn(t,r)&&(r=ie(r,i,o&&o[t],a)),r}function Qr(s,t,e,n){const{_proxy:i,_context:o,_subProxy:a,_stack:r}=e;if(r.has(s))throw new Error("Recursion detected: "+Array.from(r).join("->")+"->"+s);r.add(s);let l=t(o,a||n);return r.delete(s),xn(s,l)&&(l=yn(i._scopes,i,s,l)),l}function tl(s,t,e,n){const{_proxy:i,_context:o,_subProxy:a,_descriptors:r}=e;if(typeof o.index<"u"&&n(s))return t[o.index%t.length];if(F(t[0])){const l=t,c=i._scopes.filter(d=>d!==l);t=[];for(const d of l){const h=yn(c,i,s,d);t.push(ie(h,o,a&&a[s],r))}}return t}function Po(s,t,e){return Ft(s)?s(t,e):s}const el=(s,t)=>s===!0?t:typeof s=="string"?Lt(t,s):void 0;function sl(s,t,e,n,i){for(const o of t){const a=el(e,o);if(a){s.add(a);const r=Po(a._fallback,e,i);if(typeof r<"u"&&r!==e&&r!==n)return r}else if(a===!1&&typeof n<"u"&&e!==n)return null}return!1}function yn(s,t,e,n){const i=t._rootScopes,o=Po(t._fallback,e,n),a=[...s,...i],r=new Set;r.add(n);let l=$n(r,a,e,o||e,n);return l===null||typeof o<"u"&&o!==e&&(l=$n(r,a,o,l,n),l===null)?!1:bn(Array.from(r),[""],i,o,()=>nl(t,e,n))}function $n(s,t,e,n,i){for(;e;)e=sl(s,t,e,n,i);return e}function nl(s,t,e){const n=s._getTarget();t in n||(n[t]={});const i=n[t];return U(i)&&F(e)?e:i||{}}function il(s,t,e,n){let i;for(const o of t)if(i=No(Jr(o,s),e),typeof i<"u")return xn(s,i)?yn(e,n,s,i):i}function No(s,t){for(const e of t){if(!e)continue;const n=e[s];if(typeof n<"u")return n}}function zn(s){let t=s._keys;return t||(t=s._keys=ol(s._scopes)),t}function ol(s){const t=new Set;for(const e of s)for(const n of Object.keys(e).filter(i=>!i.startsWith("_")))t.add(n);return Array.from(t)}function al(s,t,e,n){const{iScale:i}=s,{key:o="r"}=this._parsing,a=new Array(n);let r,l,c,d;for(r=0,l=n;r<l;++r)c=r+e,d=t[c],a[r]={r:i.parse(Lt(d,o),c)};return a}const rl=Number.EPSILON||1e-14,oe=(s,t)=>t<s.length&&!s[t].skip&&s[t],Do=s=>s==="x"?"y":"x";function ll(s,t,e,n){const i=s.skip?t:s,o=t,a=e.skip?t:e,r=Ks(o,i),l=Ks(a,o);let c=r/(r+l),d=l/(r+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const h=n*c,u=n*d;return{previous:{x:o.x-h*(a.x-i.x),y:o.y-h*(a.y-i.y)},next:{x:o.x+u*(a.x-i.x),y:o.y+u*(a.y-i.y)}}}function cl(s,t,e){const n=s.length;let i,o,a,r,l,c=oe(s,0);for(let d=0;d<n-1;++d)if(l=c,c=oe(s,d+1),!(!l||!c)){if(ye(t[d],0,rl)){e[d]=e[d+1]=0;continue}i=e[d]/t[d],o=e[d+1]/t[d],r=Math.pow(i,2)+Math.pow(o,2),!(r<=9)&&(a=3/Math.sqrt(r),e[d]=i*a*t[d],e[d+1]=o*a*t[d])}}function dl(s,t,e="x"){const n=Do(e),i=s.length;let o,a,r,l=oe(s,0);for(let c=0;c<i;++c){if(a=r,r=l,l=oe(s,c+1),!r)continue;const d=r[e],h=r[n];a&&(o=(d-a[e])/3,r[`cp1${e}`]=d-o,r[`cp1${n}`]=h-o*t[c]),l&&(o=(l[e]-d)/3,r[`cp2${e}`]=d+o,r[`cp2${n}`]=h+o*t[c])}}function hl(s,t="x"){const e=Do(t),n=s.length,i=Array(n).fill(0),o=Array(n);let a,r,l,c=oe(s,0);for(a=0;a<n;++a)if(r=l,l=c,c=oe(s,a+1),!!l){if(c){const d=c[t]-l[t];i[a]=d!==0?(c[e]-l[e])/d:0}o[a]=r?c?vt(i[a-1])!==vt(i[a])?0:(i[a-1]+i[a])/2:i[a-1]:i[a]}cl(s,i,o),dl(s,o,t)}function We(s,t,e){return Math.max(Math.min(s,e),t)}function ul(s,t){let e,n,i,o,a,r=Pt(s[0],t);for(e=0,n=s.length;e<n;++e)a=o,o=r,r=e<n-1&&Pt(s[e+1],t),o&&(i=s[e],a&&(i.cp1x=We(i.cp1x,t.left,t.right),i.cp1y=We(i.cp1y,t.top,t.bottom)),r&&(i.cp2x=We(i.cp2x,t.left,t.right),i.cp2y=We(i.cp2y,t.top,t.bottom)))}function fl(s,t,e,n,i){let o,a,r,l;if(t.spanGaps&&(s=s.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")hl(s,i);else{let c=n?s[s.length-1]:s[0];for(o=0,a=s.length;o<a;++o)r=s[o],l=ll(c,r,s[Math.min(o+1,a-(n?0:1))%a],t.tension),r.cp1x=l.previous.x,r.cp1y=l.previous.y,r.cp2x=l.next.x,r.cp2y=l.next.y,c=r}t.capBezierPoints&&ul(s,e)}function _n(){return typeof window<"u"&&typeof document<"u"}function vn(s){let t=s.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function hs(s,t,e){let n;return typeof s=="string"?(n=parseInt(s,10),s.indexOf("%")!==-1&&(n=n/100*t.parentNode[e])):n=s,n}const vs=s=>s.ownerDocument.defaultView.getComputedStyle(s,null);function gl(s,t){return vs(s).getPropertyValue(t)}const pl=["top","right","bottom","left"];function Gt(s,t,e){const n={};e=e?"-"+e:"";for(let i=0;i<4;i++){const o=pl[i];n[o]=parseFloat(s[t+"-"+o+e])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const ml=(s,t,e)=>(s>0||t>0)&&(!e||!e.shadowRoot);function bl(s,t){const e=s.touches,n=e&&e.length?e[0]:s,{offsetX:i,offsetY:o}=n;let a=!1,r,l;if(ml(i,o,s.target))r=i,l=o;else{const c=t.getBoundingClientRect();r=n.clientX-c.left,l=n.clientY-c.top,a=!0}return{x:r,y:l,box:a}}function Ut(s,t){if("native"in s)return s;const{canvas:e,currentDevicePixelRatio:n}=t,i=vs(e),o=i.boxSizing==="border-box",a=Gt(i,"padding"),r=Gt(i,"border","width"),{x:l,y:c,box:d}=bl(s,e),h=a.left+(d&&r.left),u=a.top+(d&&r.top);let{width:g,height:p}=t;return o&&(g-=a.width+r.width,p-=a.height+r.height),{x:Math.round((l-h)/g*e.width/n),y:Math.round((c-u)/p*e.height/n)}}function xl(s,t,e){let n,i;if(t===void 0||e===void 0){const o=s&&vn(s);if(!o)t=s.clientWidth,e=s.clientHeight;else{const a=o.getBoundingClientRect(),r=vs(o),l=Gt(r,"border","width"),c=Gt(r,"padding");t=a.width-c.width-l.width,e=a.height-c.height-l.height,n=hs(r.maxWidth,o,"clientWidth"),i=hs(r.maxHeight,o,"clientHeight")}}return{width:t,height:e,maxWidth:n||ls,maxHeight:i||ls}}const Tt=s=>Math.round(s*10)/10;function yl(s,t,e,n){const i=vs(s),o=Gt(i,"margin"),a=hs(i.maxWidth,s,"clientWidth")||ls,r=hs(i.maxHeight,s,"clientHeight")||ls,l=xl(s,t,e);let{width:c,height:d}=l;if(i.boxSizing==="content-box"){const u=Gt(i,"border","width"),g=Gt(i,"padding");c-=g.width+u.width,d-=g.height+u.height}return c=Math.max(0,c-o.width),d=Math.max(0,n?c/n:d-o.height),c=Tt(Math.min(c,a,l.maxWidth)),d=Tt(Math.min(d,r,l.maxHeight)),c&&!d&&(d=Tt(c/2)),(t!==void 0||e!==void 0)&&n&&l.height&&d>l.height&&(d=l.height,c=Tt(Math.floor(d*n))),{width:c,height:d}}function Hn(s,t,e){const n=t||1,i=Tt(s.height*n),o=Tt(s.width*n);s.height=Tt(s.height),s.width=Tt(s.width);const a=s.canvas;return a.style&&(e||!a.style.height&&!a.style.width)&&(a.style.height=`${s.height}px`,a.style.width=`${s.width}px`),s.currentDevicePixelRatio!==n||a.height!==i||a.width!==o?(s.currentDevicePixelRatio=n,a.height=i,a.width=o,s.ctx.setTransform(n,0,0,n,0,0),!0):!1}const _l=function(){let s=!1;try{const t={get passive(){return s=!0,!1}};_n()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return s}();function Wn(s,t){const e=gl(s,t),n=e&&e.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Kt(s,t,e,n){return{x:s.x+e*(t.x-s.x),y:s.y+e*(t.y-s.y)}}function vl(s,t,e,n){return{x:s.x+e*(t.x-s.x),y:n==="middle"?e<.5?s.y:t.y:n==="after"?e<1?s.y:t.y:e>0?t.y:s.y}}function wl(s,t,e,n){const i={x:s.cp2x,y:s.cp2y},o={x:t.cp1x,y:t.cp1y},a=Kt(s,i,e),r=Kt(i,o,e),l=Kt(o,t,e),c=Kt(a,r,e),d=Kt(r,l,e);return Kt(c,d,e)}const kl=function(s,t){return{x(e){return s+s+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,n){return e-n},leftForLtr(e,n){return e-n}}},Sl=function(){return{x(s){return s},setWidth(s){},textAlign(s){return s},xPlus(s,t){return s+t},leftForLtr(s,t){return s}}};function ne(s,t,e){return s?kl(t,e):Sl()}function jo(s,t){let e,n;(t==="ltr"||t==="rtl")&&(e=s.canvas.style,n=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),s.prevTextDirection=n)}function To(s,t){t!==void 0&&(delete s.prevTextDirection,s.canvas.style.setProperty("direction",t[0],t[1]))}function Oo(s){return s==="angle"?{between:Me,compare:Sr,normalize:st}:{between:At,compare:(t,e)=>t-e,normalize:t=>t}}function Vn({start:s,end:t,count:e,loop:n,style:i}){return{start:s%e,end:t%e,loop:n&&(t-s+1)%e===0,style:i}}function Ml(s,t,e){const{property:n,start:i,end:o}=e,{between:a,normalize:r}=Oo(n),l=t.length;let{start:c,end:d,loop:h}=s,u,g;if(h){for(c+=l,d+=l,u=0,g=l;u<g&&a(r(t[c%l][n]),i,o);++u)c--,d--;c%=l,d%=l}return d<c&&(d+=l),{start:c,end:d,loop:h,style:s.style}}function Io(s,t,e){if(!e)return[s];const{property:n,start:i,end:o}=e,a=t.length,{compare:r,between:l,normalize:c}=Oo(n),{start:d,end:h,loop:u,style:g}=Ml(s,t,e),p=[];let m=!1,b=null,x,y,_;const w=()=>l(i,_,x)&&r(i,_)!==0,v=()=>r(o,x)===0||l(o,_,x),S=()=>m||w(),C=()=>!m||v();for(let M=d,P=d;M<=h;++M)y=t[M%a],!y.skip&&(x=c(y[n]),x!==_&&(m=l(x,i,o),b===null&&S()&&(b=r(x,i)===0?M:P),b!==null&&C()&&(p.push(Vn({start:b,end:M,loop:u,count:a,style:g})),b=null),P=M,_=x));return b!==null&&p.push(Vn({start:b,end:h,loop:u,count:a,style:g})),p}function Ro(s,t){const e=[],n=s.segments;for(let i=0;i<n.length;i++){const o=Io(n[i],s.points,t);o.length&&e.push(...o)}return e}function Cl(s,t,e,n){let i=0,o=t-1;if(e&&!n)for(;i<t&&!s[i].skip;)i++;for(;i<t&&s[i].skip;)i++;for(i%=t,e&&(o+=i);o>i&&s[o%t].skip;)o--;return o%=t,{start:i,end:o}}function Al(s,t,e,n){const i=s.length,o=[];let a=t,r=s[t],l;for(l=t+1;l<=e;++l){const c=s[l%i];c.skip||c.stop?r.skip||(n=!1,o.push({start:t%i,end:(l-1)%i,loop:n}),t=a=c.stop?l:null):(a=l,r.skip&&(t=l)),r=c}return a!==null&&o.push({start:t%i,end:a%i,loop:n}),o}function Pl(s,t){const e=s.points,n=s.options.spanGaps,i=e.length;if(!i)return[];const o=!!s._loop,{start:a,end:r}=Cl(e,i,o,n);if(n===!0)return Yn(s,[{start:a,end:r,loop:o}],e,t);const l=r<a?r+i:r,c=!!s._fullLoop&&a===0&&r===i-1;return Yn(s,Al(e,a,l,c),e,t)}function Yn(s,t,e,n){return!n||!n.setContext||!e?t:Nl(s,t,e,n)}function Nl(s,t,e,n){const i=s._chart.getContext(),o=Un(s.options),{_datasetIndex:a,options:{spanGaps:r}}=s,l=e.length,c=[];let d=o,h=t[0].start,u=h;function g(p,m,b,x){const y=r?-1:1;if(p!==m){for(p+=l;e[p%l].skip;)p-=y;for(;e[m%l].skip;)m+=y;p%l!==m%l&&(c.push({start:p%l,end:m%l,loop:b,style:x}),d=x,h=m%l)}}for(const p of t){h=r?h:p.start;let m=e[h%l],b;for(u=h+1;u<=p.end;u++){const x=e[u%l];b=Un(n.setContext(Bt(i,{type:"segment",p0:m,p1:x,p0DataIndex:(u-1)%l,p1DataIndex:u%l,datasetIndex:a}))),Dl(b,d)&&g(h,u-1,p.loop,d),m=x,d=b}h<u-1&&g(h,u-1,p.loop,d)}return c}function Un(s){return{backgroundColor:s.backgroundColor,borderCapStyle:s.borderCapStyle,borderDash:s.borderDash,borderDashOffset:s.borderDashOffset,borderJoinStyle:s.borderJoinStyle,borderWidth:s.borderWidth,borderColor:s.borderColor}}function Dl(s,t){if(!t)return!1;const e=[],n=function(i,o){return pn(o)?(e.includes(o)||e.push(o),e.indexOf(o)):o};return JSON.stringify(s,n)!==JSON.stringify(t,n)}function Ve(s,t,e){return s.options.clip?s[e]:t[e]}function jl(s,t){const{xScale:e,yScale:n}=s;return e&&n?{left:Ve(e,t,"left"),right:Ve(e,t,"right"),top:Ve(n,t,"top"),bottom:Ve(n,t,"bottom")}:t}function Lo(s,t){const e=t._clip;if(e.disabled)return!1;const n=jl(t,s.chartArea);return{left:e.left===!1?0:n.left-(e.left===!0?0:e.left),right:e.right===!1?s.width:n.right+(e.right===!0?0:e.right),top:e.top===!1?0:n.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?s.height:n.bottom+(e.bottom===!0?0:e.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Tl{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,n,i){const o=e.listeners[i],a=e.duration;o.forEach(r=>r({chart:t,initial:e.initial,numSteps:a,currentStep:Math.min(n-e.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=vo.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const o=n.items;let a=o.length-1,r=!1,l;for(;a>=0;--a)l=o[a],l._active?(l._total>n.duration&&(n.duration=l._total),l.tick(t),r=!0):(o[a]=o[o.length-1],o.pop());r&&(i.draw(),this._notify(i,n,t,"progress")),o.length||(n.running=!1,this._notify(i,n,t,"complete"),n.initial=!1),e+=o.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let n=e.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,n)),n}listen(t,e,n){this._getAnims(t).listeners[e].push(n)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((n,i)=>Math.max(n,i._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const n=e.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var St=new Tl;const Kn="transparent",Ol={boolean(s,t,e){return e>.5?t:s},color(s,t,e){const n=Fn(s||Kn),i=n.valid&&Fn(t||Kn);return i&&i.valid?i.mix(n,e).hexString():t},number(s,t,e){return s+(t-s)*e}};class Il{constructor(t,e,n,i){const o=e[n];i=He([t.to,i,o,t.from]);const a=He([t.from,o,i]);this._active=!0,this._fn=t.fn||Ol[t.type||typeof a],this._easing=_e[t.easing]||_e.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=n,this._from=a,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,n){if(this._active){this._notify(!1);const i=this._target[this._prop],o=n-this._start,a=this._duration-o;this._start=n,this._duration=Math.floor(Math.max(a,t.duration)),this._total+=o,this._loop=!!t.loop,this._to=He([t.to,e,i,t.from]),this._from=He([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,n=this._duration,i=this._prop,o=this._from,a=this._loop,r=this._to;let l;if(this._active=o!==r&&(a||e<n),!this._active){this._target[i]=r,this._notify(!0);return}if(e<0){this._target[i]=o;return}l=e/n%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(o,r,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,n)=>{t.push({res:e,rej:n})})}_notify(t){const e=t?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][e]()}}class Fo{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!F(t))return;const e=Object.keys(X.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const o=t[i];if(!F(o))return;const a={};for(const r of e)a[r]=o[r];(U(o.properties)&&o.properties||[i]).forEach(r=>{(r===i||!n.has(r))&&n.set(r,a)})})}_animateOptions(t,e){const n=e.options,i=Ll(t,n);if(!i)return[];const o=this._createAnimations(i,n);return n.$shared&&Rl(t.options.$animations,n).then(()=>{t.options=n},()=>{}),o}_createAnimations(t,e){const n=this._properties,i=[],o=t.$animations||(t.$animations={}),a=Object.keys(e),r=Date.now();let l;for(l=a.length-1;l>=0;--l){const c=a[l];if(c.charAt(0)==="$")continue;if(c==="options"){i.push(...this._animateOptions(t,e));continue}const d=e[c];let h=o[c];const u=n.get(c);if(h)if(u&&h.active()){h.update(u,d,r);continue}else h.cancel();if(!u||!u.duration){t[c]=d;continue}o[c]=h=new Il(u,t,c,d),i.push(h)}return i}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const n=this._createAnimations(t,e);if(n.length)return St.add(this._chart,n),!0}}function Rl(s,t){const e=[],n=Object.keys(t);for(let i=0;i<n.length;i++){const o=s[n[i]];o&&o.active()&&e.push(o.wait())}return Promise.all(e)}function Ll(s,t){if(!t)return;let e=s.options;if(!e){s.options=t;return}return e.$shared&&(s.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function Xn(s,t){const e=s&&s.options||{},n=e.reverse,i=e.min===void 0?t:0,o=e.max===void 0?t:0;return{start:n?o:i,end:n?i:o}}function Fl(s,t,e){if(e===!1)return!1;const n=Xn(s,e),i=Xn(t,e);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}function El(s){let t,e,n,i;return F(s)?(t=s.top,e=s.right,n=s.bottom,i=s.left):t=e=n=i=s,{top:t,right:e,bottom:n,left:i,disabled:s===!1}}function Eo(s,t){const e=[],n=s._getSortedDatasetMetas(t);let i,o;for(i=0,o=n.length;i<o;++i)e.push(n[i].index);return e}function Gn(s,t,e,n={}){const i=s.keys,o=n.mode==="single";let a,r,l,c;if(t===null)return;let d=!1;for(a=0,r=i.length;a<r;++a){if(l=+i[a],l===e){if(d=!0,n.all)continue;break}c=s.values[l],G(c)&&(o||t===0||vt(t)===vt(c))&&(t+=c)}return!d&&!n.all?0:t}function Bl(s,t){const{iScale:e,vScale:n}=t,i=e.axis==="x"?"x":"y",o=n.axis==="x"?"x":"y",a=Object.keys(s),r=new Array(a.length);let l,c,d;for(l=0,c=a.length;l<c;++l)d=a[l],r[l]={[i]:d,[o]:s[d]};return r}function js(s,t){const e=s&&s.options.stacked;return e||e===void 0&&t.stack!==void 0}function $l(s,t,e){return`${s.id}.${t.id}.${e.stack||e.type}`}function zl(s){const{min:t,max:e,minDefined:n,maxDefined:i}=s.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:i?e:Number.POSITIVE_INFINITY}}function Hl(s,t,e){const n=s[t]||(s[t]={});return n[e]||(n[e]={})}function qn(s,t,e,n){for(const i of t.getMatchingVisibleMetas(n).reverse()){const o=s[i.index];if(e&&o>0||!e&&o<0)return i.index}return null}function Jn(s,t){const{chart:e,_cachedMeta:n}=s,i=e._stacks||(e._stacks={}),{iScale:o,vScale:a,index:r}=n,l=o.axis,c=a.axis,d=$l(o,a,n),h=t.length;let u;for(let g=0;g<h;++g){const p=t[g],{[l]:m,[c]:b}=p,x=p._stacks||(p._stacks={});u=x[c]=Hl(i,d,m),u[r]=b,u._top=qn(u,a,!0,n.type),u._bottom=qn(u,a,!1,n.type);const y=u._visualValues||(u._visualValues={});y[r]=b}}function Ts(s,t){const e=s.scales;return Object.keys(e).filter(n=>e[n].axis===t).shift()}function Wl(s,t){return Bt(s,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Vl(s,t,e){return Bt(s,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function le(s,t){const e=s.controller.index,n=s.vScale&&s.vScale.axis;if(n){t=t||s._parsed;for(const i of t){const o=i._stacks;if(!o||o[n]===void 0||o[n][e]===void 0)return;delete o[n][e],o[n]._visualValues!==void 0&&o[n]._visualValues[e]!==void 0&&delete o[n]._visualValues[e]}}}const Os=s=>s==="reset"||s==="none",Zn=(s,t)=>t?s:Object.assign({},s),Yl=(s,t,e)=>s&&!t.hidden&&t._stacked&&{keys:Eo(e,!0),values:null};class qt{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=js(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&le(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,n=this.getDataset(),i=(h,u,g,p)=>h==="x"?u:h==="r"?p:g,o=e.xAxisID=I(n.xAxisID,Ts(t,"x")),a=e.yAxisID=I(n.yAxisID,Ts(t,"y")),r=e.rAxisID=I(n.rAxisID,Ts(t,"r")),l=e.indexAxis,c=e.iAxisID=i(l,o,a,r),d=e.vAxisID=i(l,a,o,r);e.xScale=this.getScaleForId(o),e.yScale=this.getScaleForId(a),e.rScale=this.getScaleForId(r),e.iScale=this.getScaleForId(c),e.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&In(this._data,this),t._stacked&&le(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),n=this._data;if(F(e)){const i=this._cachedMeta;this._data=Bl(e,i)}else if(n!==e){if(n){In(n,this);const i=this._cachedMeta;le(i),i._parsed=[]}e&&Object.isExtensible(e)&&Pr(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const o=e._stacked;e._stacked=js(e.vScale,e),e.stack!==n.stack&&(i=!0,le(e),e.stack=n.stack),this._resyncElements(t),(i||o!==e._stacked)&&(Jn(this,e._parsed),e._stacked=js(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:n,_data:i}=this,{iScale:o,_stacked:a}=n,r=o.axis;let l=t===0&&e===i.length?!0:n._sorted,c=t>0&&n._parsed[t-1],d,h,u;if(this._parsing===!1)n._parsed=i,n._sorted=!0,u=i;else{U(i[t])?u=this.parseArrayData(n,i,t,e):F(i[t])?u=this.parseObjectData(n,i,t,e):u=this.parsePrimitiveData(n,i,t,e);const g=()=>h[r]===null||c&&h[r]<c[r];for(d=0;d<e;++d)n._parsed[d+t]=h=u[d],l&&(g()&&(l=!1),c=h);n._sorted=l}a&&Jn(this,u)}parsePrimitiveData(t,e,n,i){const{iScale:o,vScale:a}=t,r=o.axis,l=a.axis,c=o.getLabels(),d=o===a,h=new Array(i);let u,g,p;for(u=0,g=i;u<g;++u)p=u+n,h[u]={[r]:d||o.parse(c[p],p),[l]:a.parse(e[p],p)};return h}parseArrayData(t,e,n,i){const{xScale:o,yScale:a}=t,r=new Array(i);let l,c,d,h;for(l=0,c=i;l<c;++l)d=l+n,h=e[d],r[l]={x:o.parse(h[0],d),y:a.parse(h[1],d)};return r}parseObjectData(t,e,n,i){const{xScale:o,yScale:a}=t,{xAxisKey:r="x",yAxisKey:l="y"}=this._parsing,c=new Array(i);let d,h,u,g;for(d=0,h=i;d<h;++d)u=d+n,g=e[u],c[d]={x:o.parse(Lt(g,r),u),y:a.parse(Lt(g,l),u)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,n){const i=this.chart,o=this._cachedMeta,a=e[t.axis],r={keys:Eo(i,!0),values:e._stacks[t.axis]._visualValues};return Gn(r,a,o.index,{mode:n})}updateRangeFromParsed(t,e,n,i){const o=n[e.axis];let a=o===null?NaN:o;const r=i&&n._stacks[e.axis];i&&r&&(i.values=r,a=Gn(i,o,this._cachedMeta.index)),t.min=Math.min(t.min,a),t.max=Math.max(t.max,a)}getMinMax(t,e){const n=this._cachedMeta,i=n._parsed,o=n._sorted&&t===n.iScale,a=i.length,r=this._getOtherScale(t),l=Yl(e,n,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=zl(r);let u,g;function p(){g=i[u];const m=g[r.axis];return!G(g[t.axis])||d>m||h<m}for(u=0;u<a&&!(!p()&&(this.updateRangeFromParsed(c,t,g,l),o));++u);if(o){for(u=a-1;u>=0;--u)if(!p()){this.updateRangeFromParsed(c,t,g,l);break}}return c}getAllParsedValues(t){const e=this._cachedMeta._parsed,n=[];let i,o,a;for(i=0,o=e.length;i<o;++i)a=e[i][t.axis],G(a)&&n.push(a);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,n=e.iScale,i=e.vScale,o=this.getParsed(t);return{label:n?""+n.getLabelForValue(o[n.axis]):"",value:i?""+i.getLabelForValue(o[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=El(I(this.options.clip,Fl(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,n=this._cachedMeta,i=n.data||[],o=e.chartArea,a=[],r=this._drawStart||0,l=this._drawCount||i.length-r,c=this.options.drawActiveElementsOnTop;let d;for(n.dataset&&n.dataset.draw(t,o,r,l),d=r;d<r+l;++d){const h=i[d];h.hidden||(h.active&&c?a.push(h):h.draw(t,o))}for(d=0;d<a.length;++d)a[d].draw(t,o)}getStyle(t,e){const n=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,e,n){const i=this.getDataset();let o;if(t>=0&&t<this._cachedMeta.data.length){const a=this._cachedMeta.data[t];o=a.$context||(a.$context=Vl(this.getContext(),t,a)),o.parsed=this.getParsed(t),o.raw=i.data[t],o.index=o.dataIndex=t}else o=this.$context||(this.$context=Wl(this.chart.getContext(),this.index)),o.dataset=i,o.index=o.datasetIndex=this.index;return o.active=!!e,o.mode=n,o}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",n){const i=e==="active",o=this._cachedDataOpts,a=t+"-"+e,r=o[a],l=this.enableOptionSharing&&Se(n);if(r)return Zn(r,l);const c=this.chart.config,d=c.datasetElementScopeKeys(this._type,t),h=i?[`${t}Hover`,"hover",t,""]:[t,""],u=c.getOptionScopes(this.getDataset(),d),g=Object.keys(X.elements[t]),p=()=>this.getContext(n,i,e),m=c.resolveNamedOptions(u,g,p,h);return m.$shared&&(m.$shared=l,o[a]=Object.freeze(Zn(m,l))),m}_resolveAnimations(t,e,n){const i=this.chart,o=this._cachedDataOpts,a=`animation-${e}`,r=o[a];if(r)return r;let l;if(i.options.animation!==!1){const d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,e),u=d.getOptionScopes(this.getDataset(),h);l=d.createResolver(u,this.getContext(t,n,e))}const c=new Fo(i,l&&l.animations);return l&&l._cacheable&&(o[a]=Object.freeze(c)),c}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||Os(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const n=this.resolveDataElementOptions(t,e),i=this._sharedOptions,o=this.getSharedOptions(n),a=this.includeOptions(e,o)||o!==i;return this.updateSharedOptions(o,e,n),{sharedOptions:o,includeOptions:a}}updateElement(t,e,n,i){Os(i)?Object.assign(t,n):this._resolveAnimations(e,i).update(t,n)}updateSharedOptions(t,e,n){t&&!Os(e)&&this._resolveAnimations(void 0,e).update(t,n)}_setStyle(t,e,n,i){t.active=i;const o=this.getStyle(e,i);this._resolveAnimations(e,n,i).update(t,{options:!i&&this.getSharedOptions(o)||o})}removeHoverStyle(t,e,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,e,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,n=this._cachedMeta.data;for(const[r,l,c]of this._syncList)this[r](l,c);this._syncList=[];const i=n.length,o=e.length,a=Math.min(o,i);a&&this.parse(0,a),o>i?this._insertElements(i,o-i,t):o<i&&this._removeElements(o,i-o)}_insertElements(t,e,n=!0){const i=this._cachedMeta,o=i.data,a=t+e;let r;const l=c=>{for(c.length+=e,r=c.length-1;r>=a;r--)c[r]=c[r-e]};for(l(o),r=t;r<a;++r)o[r]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(t,e),n&&this.updateElements(o,t,e,"reset")}updateElements(t,e,n,i){}_removeElements(t,e){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(t,e);n._stacked&&le(n,i)}n.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,n,i]=t;this[e](n,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}A(qt,"defaults",{}),A(qt,"datasetElementType",null),A(qt,"dataElementType",null);function Ul(s,t){if(!s._cache.$bar){const e=s.getMatchingVisibleMetas(t);let n=[];for(let i=0,o=e.length;i<o;i++)n=n.concat(e[i].controller.getAllParsedValues(s));s._cache.$bar=_o(n.sort((i,o)=>i-o))}return s._cache.$bar}function Kl(s){const t=s.iScale,e=Ul(t,s.type);let n=t._length,i,o,a,r;const l=()=>{a===32767||a===-32768||(Se(r)&&(n=Math.min(n,Math.abs(a-r)||n)),r=a)};for(i=0,o=e.length;i<o;++i)a=t.getPixelForValue(e[i]),l();for(r=void 0,i=0,o=t.ticks.length;i<o;++i)a=t.getPixelForTick(i),l();return n}function Xl(s,t,e,n){const i=e.barThickness;let o,a;return H(i)?(o=t.min*e.categoryPercentage,a=e.barPercentage):(o=i*n,a=1),{chunk:o/n,ratio:a,start:t.pixels[s]-o/2}}function Gl(s,t,e,n){const i=t.pixels,o=i[s];let a=s>0?i[s-1]:null,r=s<i.length-1?i[s+1]:null;const l=e.categoryPercentage;a===null&&(a=o-(r===null?t.end-t.start:r-o)),r===null&&(r=o+o-a);const c=o-(o-Math.min(a,r))/2*l;return{chunk:Math.abs(r-a)/2*l/n,ratio:e.barPercentage,start:c}}function ql(s,t,e,n){const i=e.parse(s[0],n),o=e.parse(s[1],n),a=Math.min(i,o),r=Math.max(i,o);let l=a,c=r;Math.abs(a)>Math.abs(r)&&(l=r,c=a),t[e.axis]=c,t._custom={barStart:l,barEnd:c,start:i,end:o,min:a,max:r}}function Bo(s,t,e,n){return U(s)?ql(s,t,e,n):t[e.axis]=e.parse(s,n),t}function Qn(s,t,e,n){const i=s.iScale,o=s.vScale,a=i.getLabels(),r=i===o,l=[];let c,d,h,u;for(c=e,d=e+n;c<d;++c)u=t[c],h={},h[i.axis]=r||i.parse(a[c],c),l.push(Bo(u,h,o,c));return l}function Is(s){return s&&s.barStart!==void 0&&s.barEnd!==void 0}function Jl(s,t,e){return s!==0?vt(s):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function Zl(s){let t,e,n,i,o;return s.horizontal?(t=s.base>s.x,e="left",n="right"):(t=s.base<s.y,e="bottom",n="top"),t?(i="end",o="start"):(i="start",o="end"),{start:e,end:n,reverse:t,top:i,bottom:o}}function Ql(s,t,e,n){let i=t.borderSkipped;const o={};if(!i){s.borderSkipped=o;return}if(i===!0){s.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:r,reverse:l,top:c,bottom:d}=Zl(s);i==="middle"&&e&&(s.enableBorderRadius=!0,(e._top||0)===n?i=c:(e._bottom||0)===n?i=d:(o[ti(d,a,r,l)]=!0,i=c)),o[ti(i,a,r,l)]=!0,s.borderSkipped=o}function ti(s,t,e,n){return n?(s=tc(s,t,e),s=ei(s,e,t)):s=ei(s,t,e),s}function tc(s,t,e){return s===t?e:s===e?t:s}function ei(s,t,e){return s==="start"?t:s==="end"?e:s}function ec(s,{inflateAmount:t},e){s.inflateAmount=t==="auto"?e===1?.33:0:t}class Qe extends qt{parsePrimitiveData(t,e,n,i){return Qn(t,e,n,i)}parseArrayData(t,e,n,i){return Qn(t,e,n,i)}parseObjectData(t,e,n,i){const{iScale:o,vScale:a}=t,{xAxisKey:r="x",yAxisKey:l="y"}=this._parsing,c=o.axis==="x"?r:l,d=a.axis==="x"?r:l,h=[];let u,g,p,m;for(u=n,g=n+i;u<g;++u)m=e[u],p={},p[o.axis]=o.parse(Lt(m,c),u),h.push(Bo(Lt(m,d),p,a,u));return h}updateRangeFromParsed(t,e,n,i){super.updateRangeFromParsed(t,e,n,i);const o=n._custom;o&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,o.min),t.max=Math.max(t.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:n,vScale:i}=e,o=this.getParsed(t),a=o._custom,r=Is(a)?"["+a.start+", "+a.end+"]":""+i.getLabelForValue(o[i.axis]);return{label:""+n.getLabelForValue(o[n.axis]),value:r}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,n,i){const o=i==="reset",{index:a,_cachedMeta:{vScale:r}}=this,l=r.getBasePixel(),c=r.isHorizontal(),d=this._getRuler(),{sharedOptions:h,includeOptions:u}=this._getSharedOptions(e,i);for(let g=e;g<e+n;g++){const p=this.getParsed(g),m=o||H(p[r.axis])?{base:l,head:l}:this._calculateBarValuePixels(g),b=this._calculateBarIndexPixels(g,d),x=(p._stacks||{})[r.axis],y={horizontal:c,base:m.base,enableBorderRadius:!x||Is(p._custom)||a===x._top||a===x._bottom,x:c?m.head:b.center,y:c?b.center:m.head,height:c?b.size:Math.abs(m.size),width:c?Math.abs(m.size):b.size};u&&(y.options=h||this.resolveDataElementOptions(g,t[g].active?"active":i));const _=y.options||t[g].options;Ql(y,_,x,a),ec(y,_,d.ratio),this.updateElement(t[g],g,y,i)}}_getStacks(t,e){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),o=n.options.stacked,a=[],r=this._cachedMeta.controller.getParsed(e),l=r&&r[n.axis],c=d=>{const h=d._parsed.find(g=>g[n.axis]===l),u=h&&h[d.vScale.axis];if(H(u)||isNaN(u))return!0};for(const d of i)if(!(e!==void 0&&c(d))&&((o===!1||a.indexOf(d.stack)===-1||o===void 0&&d.stack===void 0)&&a.push(d.stack),d.index===t))break;return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,e=this.chart.options.indexAxis;return Object.keys(t).filter(n=>t[n].axis===e).shift()}_getAxis(){const t={},e=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)t[I(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,e)]=!0;return Object.keys(t)}_getStackIndex(t,e,n){const i=this._getStacks(t,n),o=e!==void 0?i.indexOf(e):-1;return o===-1?i.length-1:o}_getRuler(){const t=this.options,e=this._cachedMeta,n=e.iScale,i=[];let o,a;for(o=0,a=e.data.length;o<a;++o)i.push(n.getPixelForValue(this.getParsed(o)[n.axis],o));const r=t.barThickness;return{min:r||Kl(e),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:r?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:n,index:i},options:{base:o,minBarLength:a}}=this,r=o||0,l=this.getParsed(t),c=l._custom,d=Is(c);let h=l[e.axis],u=0,g=n?this.applyStack(e,l,n):h,p,m;g!==h&&(u=g-h,g=h),d&&(h=c.barStart,g=c.barEnd-c.barStart,h!==0&&vt(h)!==vt(c.barEnd)&&(u=0),u+=h);const b=!H(o)&&!d?o:u;let x=e.getPixelForValue(b);if(this.chart.getDataVisibility(t)?p=e.getPixelForValue(u+g):p=x,m=p-x,Math.abs(m)<a){m=Jl(m,e,r)*a,h===r&&(x-=m/2);const y=e.getPixelForDecimal(0),_=e.getPixelForDecimal(1),w=Math.min(y,_),v=Math.max(y,_);x=Math.max(Math.min(x,v),w),p=x+m,n&&!d&&(l._stacks[e.axis]._visualValues[i]=e.getValueForPixel(p)-e.getValueForPixel(x))}if(x===e.getPixelForValue(r)){const y=vt(m)*e.getLineWidthForValue(r)/2;x+=y,m-=y}return{size:m,base:x,head:p,center:p+m/2}}_calculateBarIndexPixels(t,e){const n=e.scale,i=this.options,o=i.skipNull,a=I(i.maxBarThickness,1/0);let r,l;const c=this._getAxisCount();if(e.grouped){const d=o?this._getStackCount(t):e.stackCount,h=i.barThickness==="flex"?Gl(t,e,i,d*c):Xl(t,e,i,d*c),u=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,g=this._getAxis().indexOf(I(u,this.getFirstScaleIdForIndexAxis())),p=this._getStackIndex(this.index,this._cachedMeta.stack,o?t:void 0)+g;r=h.start+h.chunk*p+h.chunk/2,l=Math.min(a,h.chunk*h.ratio)}else r=n.getPixelForValue(this.getParsed(t)[n.axis],t),l=Math.min(a,e.min*e.ratio);return{base:r-l/2,head:r+l/2,center:r,size:l}}draw(){const t=this._cachedMeta,e=t.vScale,n=t.data,i=n.length;let o=0;for(;o<i;++o)this.getParsed(o)[e.axis]!==null&&!n[o].hidden&&n[o].draw(this._ctx)}}A(Qe,"id","bar"),A(Qe,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),A(Qe,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function sc(s,t,e){let n=1,i=1,o=0,a=0;if(t<K){const r=s,l=r+t,c=Math.cos(r),d=Math.sin(r),h=Math.cos(l),u=Math.sin(l),g=(_,w,v)=>Me(_,r,l,!0)?1:Math.max(w,w*e,v,v*e),p=(_,w,v)=>Me(_,r,l,!0)?-1:Math.min(w,w*e,v,v*e),m=g(0,c,h),b=g(q,d,u),x=p($,c,h),y=p($+q,d,u);n=(m-x)/2,i=(b-y)/2,o=-(m+x)/2,a=-(b+y)/2}return{ratioX:n,ratioY:i,offsetX:o,offsetY:a}}class se extends qt{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const n=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=n;else{let o=l=>+n[l];if(F(n[t])){const{key:l="value"}=this._parsing;o=c=>+Lt(n[c],l)}let a,r;for(a=t,r=t+e;a<r;++a)i._parsed[a]=o(a)}}_getRotation(){return mt(this.options.rotation-90)}_getCircumference(){return mt(this.options.circumference)}_getRotationExtents(){let t=K,e=-K;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,o=i._getRotation(),a=i._getCircumference();t=Math.min(t,o),e=Math.max(e,o+a)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:n}=e,i=this._cachedMeta,o=i.data,a=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,r=Math.max((Math.min(n.width,n.height)-a)/2,0),l=Math.min(fr(this.options.cutout,r),1),c=this._getRingWeight(this.index),{circumference:d,rotation:h}=this._getRotationExtents(),{ratioX:u,ratioY:g,offsetX:p,offsetY:m}=sc(h,d,l),b=(n.width-a)/u,x=(n.height-a)/g,y=Math.max(Math.min(b,x)/2,0),_=po(this.options.radius,y),w=Math.max(_*l,0),v=(_-w)/this._getVisibleDatasetWeightTotal();this.offsetX=p*_,this.offsetY=m*_,i.total=this.calculateTotal(),this.outerRadius=_-v*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-v*c,0),this.updateElements(o,0,o.length,t)}_circumference(t,e){const n=this.options,i=this._cachedMeta,o=this._getCircumference();return e&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||i._parsed[t]===null||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*o/K)}updateElements(t,e,n,i){const o=i==="reset",a=this.chart,r=a.chartArea,c=a.options.animation,d=(r.left+r.right)/2,h=(r.top+r.bottom)/2,u=o&&c.animateScale,g=u?0:this.innerRadius,p=u?0:this.outerRadius,{sharedOptions:m,includeOptions:b}=this._getSharedOptions(e,i);let x=this._getRotation(),y;for(y=0;y<e;++y)x+=this._circumference(y,o);for(y=e;y<e+n;++y){const _=this._circumference(y,o),w=t[y],v={x:d+this.offsetX,y:h+this.offsetY,startAngle:x,endAngle:x+_,circumference:_,outerRadius:p,innerRadius:g};b&&(v.options=m||this.resolveDataElementOptions(y,w.active?"active":i)),x+=_,this.updateElement(w,y,v,i)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let n=0,i;for(i=0;i<e.length;i++){const o=t._parsed[i];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(i)&&!e[i].hidden&&(n+=Math.abs(o))}return n}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?K*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,i=n.data.labels||[],o=Re(e._parsed[t],n.options.locale);return{label:i[t]||"",value:o}}getMaxBorderWidth(t){let e=0;const n=this.chart;let i,o,a,r,l;if(!t){for(i=0,o=n.data.datasets.length;i<o;++i)if(n.isDatasetVisible(i)){a=n.getDatasetMeta(i),t=a.data,r=a.controller;break}}if(!t)return 0;for(i=0,o=t.length;i<o;++i)l=r.resolveDataElementOptions(i),l.borderAlign!=="inner"&&(e=Math.max(e,l.borderWidth||0,l.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let n=0,i=t.length;n<i;++n){const o=this.resolveDataElementOptions(n);e=Math.max(e,o.offset||0,o.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(e+=this._getRingWeight(n));return e}_getRingWeight(t){return Math.max(I(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}A(se,"id","doughnut"),A(se,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),A(se,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),A(se,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data,{labels:{pointStyle:n,textAlign:i,color:o,useBorderRadius:a,borderRadius:r}}=t.legend.options;return e.labels.length&&e.datasets.length?e.labels.map((l,c)=>{const h=t.getDatasetMeta(0).controller.getStyle(c);return{text:l,fillStyle:h.backgroundColor,fontColor:o,hidden:!t.getDataVisibility(c),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:i,pointStyle:n,borderRadius:a&&(r||h.borderRadius),index:c}}):[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}}}});class ts extends qt{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,i=n.data.labels||[],o=Re(e._parsed[t].r,n.options.locale);return{label:i[t]||"",value:o}}parseObjectData(t,e,n,i){return al.bind(this)(t,e,n,i)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((n,i)=>{const o=this.getParsed(i).r;!isNaN(o)&&this.chart.getDataVisibility(i)&&(o<e.min&&(e.min=o),o>e.max&&(e.max=o))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,n=t.options,i=Math.min(e.right-e.left,e.bottom-e.top),o=Math.max(i/2,0),a=Math.max(n.cutoutPercentage?o/100*n.cutoutPercentage:1,0),r=(o-a)/t.getVisibleDatasetCount();this.outerRadius=o-r*this.index,this.innerRadius=this.outerRadius-r}updateElements(t,e,n,i){const o=i==="reset",a=this.chart,l=a.options.animation,c=this._cachedMeta.rScale,d=c.xCenter,h=c.yCenter,u=c.getIndexAngle(0)-.5*$;let g=u,p;const m=360/this.countVisibleElements();for(p=0;p<e;++p)g+=this._computeAngle(p,i,m);for(p=e;p<e+n;p++){const b=t[p];let x=g,y=g+this._computeAngle(p,i,m),_=a.getDataVisibility(p)?c.getDistanceFromCenterForValue(this.getParsed(p).r):0;g=y,o&&(l.animateScale&&(_=0),l.animateRotate&&(x=y=u));const w={x:d,y:h,innerRadius:0,outerRadius:_,startAngle:x,endAngle:y,options:this.resolveDataElementOptions(p,b.active?"active":i)};this.updateElement(b,p,w,i)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((n,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&e++}),e}_computeAngle(t,e,n){return this.chart.getDataVisibility(t)?mt(this.resolveDataElementOptions(t,e).angle||n):0}}A(ts,"id","polarArea"),A(ts,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),A(ts,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:i}}=t.legend.options;return e.labels.map((o,a)=>{const l=t.getDatasetMeta(0).controller.getStyle(a);return{text:o,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:i,lineWidth:l.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(a),index:a}})}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class Js extends se{}A(Js,"id","pie"),A(Js,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function Vt(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class wn{constructor(t){A(this,"options");this.options=t||{}}static override(t){Object.assign(wn.prototype,t)}init(){}formats(){return Vt()}parse(){return Vt()}format(){return Vt()}add(){return Vt()}diff(){return Vt()}startOf(){return Vt()}endOf(){return Vt()}}var nc={_date:wn};function ic(s,t,e,n){const{controller:i,data:o,_sorted:a}=s,r=i._cachedMeta.iScale,l=s.dataset&&s.dataset.options?s.dataset.options.spanGaps:null;if(r&&t===r.axis&&t!=="r"&&a&&o.length){const c=r._reversePixels?Cr:Xs;if(n){if(i._sharedOptions){const d=o[0],h=typeof d.getRange=="function"&&d.getRange(t);if(h){const u=c(o,t,e-h),g=c(o,t,e+h);return{lo:u.lo,hi:g.hi}}}}else{const d=c(o,t,e);if(l){const{vScale:h}=i._cachedMeta,{_parsed:u}=s,g=u.slice(0,d.lo+1).reverse().findIndex(m=>!H(m[h.axis]));d.lo-=Math.max(0,g);const p=u.slice(d.hi).findIndex(m=>!H(m[h.axis]));d.hi+=Math.max(0,p)}return d}}return{lo:0,hi:o.length-1}}function Le(s,t,e,n,i){const o=s.getSortedVisibleDatasetMetas(),a=e[t];for(let r=0,l=o.length;r<l;++r){const{index:c,data:d}=o[r],{lo:h,hi:u}=ic(o[r],t,a,i);for(let g=h;g<=u;++g){const p=d[g];p.skip||n(p,c,g)}}}function oc(s){const t=s.indexOf("x")!==-1,e=s.indexOf("y")!==-1;return function(n,i){const o=t?Math.abs(n.x-i.x):0,a=e?Math.abs(n.y-i.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(a,2))}}function Rs(s,t,e,n,i){const o=[];return!i&&!s.isPointInArea(t)||Le(s,e,t,function(r,l,c){!i&&!Pt(r,s.chartArea,0)||r.inRange(t.x,t.y,n)&&o.push({element:r,datasetIndex:l,index:c})},!0),o}function ac(s,t,e,n){let i=[];function o(a,r,l){const{startAngle:c,endAngle:d}=a.getProps(["startAngle","endAngle"],n),{angle:h}=xo(a,{x:t.x,y:t.y});Me(h,c,d)&&i.push({element:a,datasetIndex:r,index:l})}return Le(s,e,t,o),i}function rc(s,t,e,n,i,o){let a=[];const r=oc(e);let l=Number.POSITIVE_INFINITY;function c(d,h,u){const g=d.inRange(t.x,t.y,i);if(n&&!g)return;const p=d.getCenterPoint(i);if(!(!!o||s.isPointInArea(p))&&!g)return;const b=r(t,p);b<l?(a=[{element:d,datasetIndex:h,index:u}],l=b):b===l&&a.push({element:d,datasetIndex:h,index:u})}return Le(s,e,t,c),a}function Ls(s,t,e,n,i,o){return!o&&!s.isPointInArea(t)?[]:e==="r"&&!n?ac(s,t,e,i):rc(s,t,e,n,i,o)}function si(s,t,e,n,i){const o=[],a=e==="x"?"inXRange":"inYRange";let r=!1;return Le(s,e,t,(l,c,d)=>{l[a]&&l[a](t[e],i)&&(o.push({element:l,datasetIndex:c,index:d}),r=r||l.inRange(t.x,t.y,i))}),n&&!r?[]:o}var lc={evaluateInteractionItems:Le,modes:{index(s,t,e,n){const i=Ut(t,s),o=e.axis||"x",a=e.includeInvisible||!1,r=e.intersect?Rs(s,i,o,n,a):Ls(s,i,o,!1,n,a),l=[];return r.length?(s.getSortedVisibleDatasetMetas().forEach(c=>{const d=r[0].index,h=c.data[d];h&&!h.skip&&l.push({element:h,datasetIndex:c.index,index:d})}),l):[]},dataset(s,t,e,n){const i=Ut(t,s),o=e.axis||"xy",a=e.includeInvisible||!1;let r=e.intersect?Rs(s,i,o,n,a):Ls(s,i,o,!1,n,a);if(r.length>0){const l=r[0].datasetIndex,c=s.getDatasetMeta(l).data;r=[];for(let d=0;d<c.length;++d)r.push({element:c[d],datasetIndex:l,index:d})}return r},point(s,t,e,n){const i=Ut(t,s),o=e.axis||"xy",a=e.includeInvisible||!1;return Rs(s,i,o,n,a)},nearest(s,t,e,n){const i=Ut(t,s),o=e.axis||"xy",a=e.includeInvisible||!1;return Ls(s,i,o,e.intersect,n,a)},x(s,t,e,n){const i=Ut(t,s);return si(s,i,"x",e.intersect,n)},y(s,t,e,n){const i=Ut(t,s);return si(s,i,"y",e.intersect,n)}}};const $o=["left","top","right","bottom"];function ce(s,t){return s.filter(e=>e.pos===t)}function ni(s,t){return s.filter(e=>$o.indexOf(e.pos)===-1&&e.box.axis===t)}function de(s,t){return s.sort((e,n)=>{const i=t?n:e,o=t?e:n;return i.weight===o.weight?i.index-o.index:i.weight-o.weight})}function cc(s){const t=[];let e,n,i,o,a,r;for(e=0,n=(s||[]).length;e<n;++e)i=s[e],{position:o,options:{stack:a,stackWeight:r=1}}=i,t.push({index:e,box:i,pos:o,horizontal:i.isHorizontal(),weight:i.weight,stack:a&&o+a,stackWeight:r});return t}function dc(s){const t={};for(const e of s){const{stack:n,pos:i,stackWeight:o}=e;if(!n||!$o.includes(i))continue;const a=t[n]||(t[n]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=o}return t}function hc(s,t){const e=dc(s),{vBoxMaxWidth:n,hBoxMaxHeight:i}=t;let o,a,r;for(o=0,a=s.length;o<a;++o){r=s[o];const{fullSize:l}=r.box,c=e[r.stack],d=c&&r.stackWeight/c.weight;r.horizontal?(r.width=d?d*n:l&&t.availableWidth,r.height=i):(r.width=n,r.height=d?d*i:l&&t.availableHeight)}return e}function uc(s){const t=cc(s),e=de(t.filter(c=>c.box.fullSize),!0),n=de(ce(t,"left"),!0),i=de(ce(t,"right")),o=de(ce(t,"top"),!0),a=de(ce(t,"bottom")),r=ni(t,"x"),l=ni(t,"y");return{fullSize:e,leftAndTop:n.concat(o),rightAndBottom:i.concat(l).concat(a).concat(r),chartArea:ce(t,"chartArea"),vertical:n.concat(i).concat(l),horizontal:o.concat(a).concat(r)}}function ii(s,t,e,n){return Math.max(s[e],t[e])+Math.max(s[n],t[n])}function zo(s,t){s.top=Math.max(s.top,t.top),s.left=Math.max(s.left,t.left),s.bottom=Math.max(s.bottom,t.bottom),s.right=Math.max(s.right,t.right)}function fc(s,t,e,n){const{pos:i,box:o}=e,a=s.maxPadding;if(!F(i)){e.size&&(s[i]-=e.size);const h=n[e.stack]||{size:0,count:1};h.size=Math.max(h.size,e.horizontal?o.height:o.width),e.size=h.size/h.count,s[i]+=e.size}o.getPadding&&zo(a,o.getPadding());const r=Math.max(0,t.outerWidth-ii(a,s,"left","right")),l=Math.max(0,t.outerHeight-ii(a,s,"top","bottom")),c=r!==s.w,d=l!==s.h;return s.w=r,s.h=l,e.horizontal?{same:c,other:d}:{same:d,other:c}}function gc(s){const t=s.maxPadding;function e(n){const i=Math.max(t[n]-s[n],0);return s[n]+=i,i}s.y+=e("top"),s.x+=e("left"),e("right"),e("bottom")}function pc(s,t){const e=t.maxPadding;function n(i){const o={left:0,top:0,right:0,bottom:0};return i.forEach(a=>{o[a]=Math.max(t[a],e[a])}),o}return n(s?["left","right"]:["top","bottom"])}function pe(s,t,e,n){const i=[];let o,a,r,l,c,d;for(o=0,a=s.length,c=0;o<a;++o){r=s[o],l=r.box,l.update(r.width||t.w,r.height||t.h,pc(r.horizontal,t));const{same:h,other:u}=fc(t,e,r,n);c|=h&&i.length,d=d||u,l.fullSize||i.push(r)}return c&&pe(i,t,e,n)||d}function Ye(s,t,e,n,i){s.top=e,s.left=t,s.right=t+n,s.bottom=e+i,s.width=n,s.height=i}function oi(s,t,e,n){const i=e.padding;let{x:o,y:a}=t;for(const r of s){const l=r.box,c=n[r.stack]||{count:1,placed:0,weight:1},d=r.stackWeight/c.weight||1;if(r.horizontal){const h=t.w*d,u=c.size||l.height;Se(c.start)&&(a=c.start),l.fullSize?Ye(l,i.left,a,e.outerWidth-i.right-i.left,u):Ye(l,t.left+c.placed,a,h,u),c.start=a,c.placed+=h,a=l.bottom}else{const h=t.h*d,u=c.size||l.width;Se(c.start)&&(o=c.start),l.fullSize?Ye(l,o,i.top,u,e.outerHeight-i.bottom-i.top):Ye(l,o,t.top+c.placed,u,h),c.start=o,c.placed+=h,o=l.right}}t.x=o,t.y=a}var gt={addBox(s,t){s.boxes||(s.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},s.boxes.push(t)},removeBox(s,t){const e=s.boxes?s.boxes.indexOf(t):-1;e!==-1&&s.boxes.splice(e,1)},configure(s,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(s,t,e,n){if(!s)return;const i=nt(s.options.layout.padding),o=Math.max(t-i.width,0),a=Math.max(e-i.height,0),r=uc(s.boxes),l=r.vertical,c=r.horizontal;W(s.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const d=l.reduce((m,b)=>b.box.options&&b.box.options.display===!1?m:m+1,0)||1,h=Object.freeze({outerWidth:t,outerHeight:e,padding:i,availableWidth:o,availableHeight:a,vBoxMaxWidth:o/2/d,hBoxMaxHeight:a/2}),u=Object.assign({},i);zo(u,nt(n));const g=Object.assign({maxPadding:u,w:o,h:a,x:i.left,y:i.top},i),p=hc(l.concat(c),h);pe(r.fullSize,g,h,p),pe(l,g,h,p),pe(c,g,h,p)&&pe(l,g,h,p),gc(g),oi(r.leftAndTop,g,h,p),g.x+=g.w,g.y+=g.h,oi(r.rightAndBottom,g,h,p),s.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},W(r.chartArea,m=>{const b=m.box;Object.assign(b,s.chartArea),b.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}};class Ho{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,n){}removeEventListener(t,e,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,n,i){return e=Math.max(0,e||t.width),n=n||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):n)}}isAttached(t){return!0}updateConfig(t){}}class mc extends Ho{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const es="$chartjs",bc={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},ai=s=>s===null||s==="";function xc(s,t){const e=s.style,n=s.getAttribute("height"),i=s.getAttribute("width");if(s[es]={initial:{height:n,width:i,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",ai(i)){const o=Wn(s,"width");o!==void 0&&(s.width=o)}if(ai(n))if(s.style.height==="")s.height=s.width/(t||2);else{const o=Wn(s,"height");o!==void 0&&(s.height=o)}return s}const Wo=_l?{passive:!0}:!1;function yc(s,t,e){s&&s.addEventListener(t,e,Wo)}function _c(s,t,e){s&&s.canvas&&s.canvas.removeEventListener(t,e,Wo)}function vc(s,t){const e=bc[s.type]||s.type,{x:n,y:i}=Ut(s,t);return{type:e,chart:t,native:s,x:n!==void 0?n:null,y:i!==void 0?i:null}}function us(s,t){for(const e of s)if(e===t||e.contains(t))return!0}function wc(s,t,e){const n=s.canvas,i=new MutationObserver(o=>{let a=!1;for(const r of o)a=a||us(r.addedNodes,n),a=a&&!us(r.removedNodes,n);a&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}function kc(s,t,e){const n=s.canvas,i=new MutationObserver(o=>{let a=!1;for(const r of o)a=a||us(r.removedNodes,n),a=a&&!us(r.addedNodes,n);a&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}const Ae=new Map;let ri=0;function Vo(){const s=window.devicePixelRatio;s!==ri&&(ri=s,Ae.forEach((t,e)=>{e.currentDevicePixelRatio!==s&&t()}))}function Sc(s,t){Ae.size||window.addEventListener("resize",Vo),Ae.set(s,t)}function Mc(s){Ae.delete(s),Ae.size||window.removeEventListener("resize",Vo)}function Cc(s,t,e){const n=s.canvas,i=n&&vn(n);if(!i)return;const o=wo((r,l)=>{const c=i.clientWidth;e(r,l),c<i.clientWidth&&e()},window),a=new ResizeObserver(r=>{const l=r[0],c=l.contentRect.width,d=l.contentRect.height;c===0&&d===0||o(c,d)});return a.observe(i),Sc(s,o),a}function Fs(s,t,e){e&&e.disconnect(),t==="resize"&&Mc(s)}function Ac(s,t,e){const n=s.canvas,i=wo(o=>{s.ctx!==null&&e(vc(o,s))},s);return yc(n,t,i),i}class Pc extends Ho{acquireContext(t,e){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(xc(t,e),n):null}releaseContext(t){const e=t.canvas;if(!e[es])return!1;const n=e[es].initial;["height","width"].forEach(o=>{const a=n[o];H(a)?e.removeAttribute(o):e.setAttribute(o,a)});const i=n.style||{};return Object.keys(i).forEach(o=>{e.style[o]=i[o]}),e.width=e.width,delete e[es],!0}addEventListener(t,e,n){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),a={attach:wc,detach:kc,resize:Cc}[e]||Ac;i[e]=a(t,e,n)}removeEventListener(t,e){const n=t.$proxies||(t.$proxies={}),i=n[e];if(!i)return;({attach:Fs,detach:Fs,resize:Fs}[e]||_c)(t,e,i),n[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,n,i){return yl(t,e,n,i)}isAttached(t){const e=t&&vn(t);return!!(e&&e.isConnected)}}function Nc(s){return!_n()||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas?mc:Pc}class bt{constructor(){A(this,"x");A(this,"y");A(this,"active",!1);A(this,"options");A(this,"$animations")}tooltipPosition(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}hasValue(){return cs(this.x)&&cs(this.y)}getProps(t,e){const n=this.$animations;if(!e||!n)return this;const i={};return t.forEach(o=>{i[o]=n[o]&&n[o].active()?n[o]._to:this[o]}),i}}A(bt,"defaults",{}),A(bt,"defaultRoutes");function Dc(s,t){const e=s.options.ticks,n=jc(s),i=Math.min(e.maxTicksLimit||n,n),o=e.major.enabled?Oc(t):[],a=o.length,r=o[0],l=o[a-1],c=[];if(a>i)return Ic(t,c,o,a/i),c;const d=Tc(o,t,i);if(a>0){let h,u;const g=a>1?Math.round((l-r)/(a-1)):null;for(Ue(t,c,d,H(g)?0:r-g,r),h=0,u=a-1;h<u;h++)Ue(t,c,d,o[h],o[h+1]);return Ue(t,c,d,l,H(g)?t.length:l+g),c}return Ue(t,c,d),c}function jc(s){const t=s.options.offset,e=s._tickSize(),n=s._length/e+(t?0:1),i=s._maxLength/e;return Math.floor(Math.min(n,i))}function Tc(s,t,e){const n=Rc(s),i=t.length/e;if(!n)return Math.max(i,1);const o=vr(n);for(let a=0,r=o.length-1;a<r;a++){const l=o[a];if(l>i)return l}return Math.max(i,1)}function Oc(s){const t=[];let e,n;for(e=0,n=s.length;e<n;e++)s[e].major&&t.push(e);return t}function Ic(s,t,e,n){let i=0,o=e[0],a;for(n=Math.ceil(n),a=0;a<s.length;a++)a===o&&(t.push(s[a]),i++,o=e[i*n])}function Ue(s,t,e,n,i){const o=I(n,0),a=Math.min(I(i,s.length),s.length);let r=0,l,c,d;for(e=Math.ceil(e),i&&(l=i-n,e=l/Math.floor(l/e)),d=o;d<0;)r++,d=Math.round(o+r*e);for(c=Math.max(o,0);c<a;c++)c===d&&(t.push(s[c]),r++,d=Math.round(o+r*e))}function Rc(s){const t=s.length;let e,n;if(t<2)return!1;for(n=s[0],e=1;e<t;++e)if(s[e]-s[e-1]!==n)return!1;return n}const Lc=s=>s==="left"?"right":s==="right"?"left":s,li=(s,t,e)=>t==="top"||t==="left"?s[t]+e:s[t]-e,ci=(s,t)=>Math.min(t||s,s);function di(s,t){const e=[],n=s.length/t,i=s.length;let o=0;for(;o<i;o+=n)e.push(s[Math.floor(o)]);return e}function Fc(s,t,e){const n=s.ticks.length,i=Math.min(t,n-1),o=s._startPixel,a=s._endPixel,r=1e-6;let l=s.getPixelForTick(i),c;if(!(e&&(n===1?c=Math.max(l-o,a-l):t===0?c=(s.getPixelForTick(1)-l)/2:c=(l-s.getPixelForTick(i-1))/2,l+=i<t?c:-c,l<o-r||l>a+r)))return l}function Ec(s,t){W(s,e=>{const n=e.gc,i=n.length/2;let o;if(i>t){for(o=0;o<i;++o)delete e.data[n[o]];n.splice(0,i)}})}function he(s){return s.drawTicks?s.tickLength:0}function hi(s,t){if(!s.display)return 0;const e=Q(s.font,t),n=nt(s.padding);return(U(s.text)?s.text.length:1)*e.lineHeight+n.height}function Bc(s,t){return Bt(s,{scale:t,type:"scale"})}function $c(s,t,e){return Bt(s,{tick:e,index:t,type:"tick"})}function zc(s,t,e){let n=gn(s);return(e&&t!=="right"||!e&&t==="right")&&(n=Lc(n)),n}function Hc(s,t,e,n){const{top:i,left:o,bottom:a,right:r,chart:l}=s,{chartArea:c,scales:d}=l;let h=0,u,g,p;const m=a-i,b=r-o;if(s.isHorizontal()){if(g=et(n,o,r),F(e)){const x=Object.keys(e)[0],y=e[x];p=d[x].getPixelForValue(y)+m-t}else e==="center"?p=(c.bottom+c.top)/2+m-t:p=li(s,e,t);u=r-o}else{if(F(e)){const x=Object.keys(e)[0],y=e[x];g=d[x].getPixelForValue(y)-b+t}else e==="center"?g=(c.left+c.right)/2-b+t:g=li(s,e,t);p=et(n,a,i),h=e==="left"?-q:q}return{titleX:g,titleY:p,maxWidth:u,rotation:h}}class Qt extends bt{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:n,_suggestedMax:i}=this;return t=dt(t,Number.POSITIVE_INFINITY),e=dt(e,Number.NEGATIVE_INFINITY),n=dt(n,Number.POSITIVE_INFINITY),i=dt(i,Number.NEGATIVE_INFINITY),{min:dt(t,n),max:dt(e,i),minDefined:G(t),maxDefined:G(e)}}getMinMax(t){let{min:e,max:n,minDefined:i,maxDefined:o}=this.getUserBounds(),a;if(i&&o)return{min:e,max:n};const r=this.getMatchingVisibleMetas();for(let l=0,c=r.length;l<c;++l)a=r[l].controller.getMinMax(this,t),i||(e=Math.min(e,a.min)),o||(n=Math.max(n,a.max));return e=o&&e>n?n:e,n=i&&e>n?e:n,{min:dt(e,dt(n,e)),max:dt(n,dt(e,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Y(this.options.beforeUpdate,[this])}update(t,e,n){const{beginAtZero:i,grace:o,ticks:a}=this.options,r=a.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=qr(this,o,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=r<this.ticks.length;this._convertTicksToLabels(l?di(this.ticks,r):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=Dc(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,n;this.isHorizontal()?(e=this.left,n=this.right):(e=this.top,n=this.bottom,t=!t),this._startPixel=e,this._endPixel=n,this._reversePixels=t,this._length=n-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Y(this.options.afterUpdate,[this])}beforeSetDimensions(){Y(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Y(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Y(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Y(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let n,i,o;for(n=0,i=t.length;n<i;n++)o=t[n],o.label=Y(e.callback,[o.value,n,t],this)}afterTickToLabelConversion(){Y(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Y(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,n=ci(this.ticks.length,t.ticks.maxTicksLimit),i=e.minRotation||0,o=e.maxRotation;let a=i,r,l,c;if(!this._isVisible()||!e.display||i>=o||n<=1||!this.isHorizontal()){this.labelRotation=i;return}const d=this._getLabelSizes(),h=d.widest.width,u=d.highest.height,g=lt(this.chart.width-h,0,this.maxWidth);r=t.offset?this.maxWidth/n:g/(n-1),h+6>r&&(r=g/(n-(t.offset?.5:1)),l=this.maxHeight-he(t.grid)-e.padding-hi(t.title,this.chart.options.font),c=Math.sqrt(h*h+u*u),a=un(Math.min(Math.asin(lt((d.highest.height+6)/r,-1,1)),Math.asin(lt(l/c,-1,1))-Math.asin(lt(u/c,-1,1)))),a=Math.max(i,Math.min(o,a))),this.labelRotation=a}afterCalculateLabelRotation(){Y(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Y(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:n,title:i,grid:o}}=this,a=this._isVisible(),r=this.isHorizontal();if(a){const l=hi(i,e.options.font);if(r?(t.width=this.maxWidth,t.height=he(o)+l):(t.height=this.maxHeight,t.width=he(o)+l),n.display&&this.ticks.length){const{first:c,last:d,widest:h,highest:u}=this._getLabelSizes(),g=n.padding*2,p=mt(this.labelRotation),m=Math.cos(p),b=Math.sin(p);if(r){const x=n.mirror?0:b*h.width+m*u.height;t.height=Math.min(this.maxHeight,t.height+x+g)}else{const x=n.mirror?0:m*h.width+b*u.height;t.width=Math.min(this.maxWidth,t.width+x+g)}this._calculatePadding(c,d,b,m)}}this._handleMargins(),r?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,n,i){const{ticks:{align:o,padding:a},position:r}=this.options,l=this.labelRotation!==0,c=r!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let u=0,g=0;l?c?(u=i*t.width,g=n*e.height):(u=n*t.height,g=i*e.width):o==="start"?g=e.width:o==="end"?u=t.width:o!=="inner"&&(u=t.width/2,g=e.width/2),this.paddingLeft=Math.max((u-d+a)*this.width/(this.width-d),0),this.paddingRight=Math.max((g-h+a)*this.width/(this.width-h),0)}else{let d=e.height/2,h=t.height/2;o==="start"?(d=0,h=t.height):o==="end"&&(d=e.height,h=0),this.paddingTop=d+a,this.paddingBottom=h+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Y(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,n;for(e=0,n=t.length;e<n;e++)H(t[e].label)&&(t.splice(e,1),n--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let n=this.ticks;e<n.length&&(n=di(n,e)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,n){const{ctx:i,_longestTextCache:o}=this,a=[],r=[],l=Math.floor(e/ci(e,n));let c=0,d=0,h,u,g,p,m,b,x,y,_,w,v;for(h=0;h<e;h+=l){if(p=t[h].label,m=this._resolveTickFontOptions(h),i.font=b=m.string,x=o[b]=o[b]||{data:{},gc:[]},y=m.lineHeight,_=w=0,!H(p)&&!U(p))_=ds(i,x.data,x.gc,_,p),w=y;else if(U(p))for(u=0,g=p.length;u<g;++u)v=p[u],!H(v)&&!U(v)&&(_=ds(i,x.data,x.gc,_,v),w+=y);a.push(_),r.push(w),c=Math.max(_,c),d=Math.max(w,d)}Ec(o,e);const S=a.indexOf(c),C=r.indexOf(d),M=P=>({width:a[P]||0,height:r[P]||0});return{first:M(0),last:M(e-1),widest:M(S),highest:M(C),widths:a,heights:r}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return Mr(this._alignToPixels?Wt(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const n=e[t];return n.$context||(n.$context=$c(this.getContext(),t,n))}return this.$context||(this.$context=Bc(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=mt(this.labelRotation),n=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),o=this._getLabelSizes(),a=t.autoSkipPadding||0,r=o?o.widest.width+a:0,l=o?o.highest.height+a:0;return this.isHorizontal()?l*n>r*i?r/n:l/i:l*i<r*n?l/n:r/i}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,n=this.chart,i=this.options,{grid:o,position:a,border:r}=i,l=o.offset,c=this.isHorizontal(),h=this.ticks.length+(l?1:0),u=he(o),g=[],p=r.setContext(this.getContext()),m=p.display?p.width:0,b=m/2,x=function(R){return Wt(n,R,m)};let y,_,w,v,S,C,M,P,O,T,k,N;if(a==="top")y=x(this.bottom),C=this.bottom-u,P=y-b,T=x(t.top)+b,N=t.bottom;else if(a==="bottom")y=x(this.top),T=t.top,N=x(t.bottom)-b,C=y+b,P=this.top+u;else if(a==="left")y=x(this.right),S=this.right-u,M=y-b,O=x(t.left)+b,k=t.right;else if(a==="right")y=x(this.left),O=t.left,k=x(t.right)-b,S=y+b,M=this.left+u;else if(e==="x"){if(a==="center")y=x((t.top+t.bottom)/2+.5);else if(F(a)){const R=Object.keys(a)[0],B=a[R];y=x(this.chart.scales[R].getPixelForValue(B))}T=t.top,N=t.bottom,C=y+b,P=C+u}else if(e==="y"){if(a==="center")y=x((t.left+t.right)/2);else if(F(a)){const R=Object.keys(a)[0],B=a[R];y=x(this.chart.scales[R].getPixelForValue(B))}S=y-b,M=S-u,O=t.left,k=t.right}const E=I(i.ticks.maxTicksLimit,h),D=Math.max(1,Math.ceil(h/E));for(_=0;_<h;_+=D){const R=this.getContext(_),B=o.setContext(R),j=r.setContext(R),L=B.lineWidth,tt=B.color,V=j.dash||[],it=j.dashOffset,ct=B.tickWidth,ot=B.tickColor,re=B.tickBorderDash||[],$t=B.tickBorderDashOffset;w=Fc(this,_,l),w!==void 0&&(v=Wt(n,w,L),c?S=M=O=k=v:C=P=T=N=v,g.push({tx1:S,ty1:C,tx2:M,ty2:P,x1:O,y1:T,x2:k,y2:N,width:L,color:tt,borderDash:V,borderDashOffset:it,tickWidth:ct,tickColor:ot,tickBorderDash:re,tickBorderDashOffset:$t}))}return this._ticksLength=h,this._borderValue=y,g}_computeLabelItems(t){const e=this.axis,n=this.options,{position:i,ticks:o}=n,a=this.isHorizontal(),r=this.ticks,{align:l,crossAlign:c,padding:d,mirror:h}=o,u=he(n.grid),g=u+d,p=h?-d:g,m=-mt(this.labelRotation),b=[];let x,y,_,w,v,S,C,M,P,O,T,k,N="middle";if(i==="top")S=this.bottom-p,C=this._getXAxisLabelAlignment();else if(i==="bottom")S=this.top+p,C=this._getXAxisLabelAlignment();else if(i==="left"){const D=this._getYAxisLabelAlignment(u);C=D.textAlign,v=D.x}else if(i==="right"){const D=this._getYAxisLabelAlignment(u);C=D.textAlign,v=D.x}else if(e==="x"){if(i==="center")S=(t.top+t.bottom)/2+g;else if(F(i)){const D=Object.keys(i)[0],R=i[D];S=this.chart.scales[D].getPixelForValue(R)+g}C=this._getXAxisLabelAlignment()}else if(e==="y"){if(i==="center")v=(t.left+t.right)/2-g;else if(F(i)){const D=Object.keys(i)[0],R=i[D];v=this.chart.scales[D].getPixelForValue(R)}C=this._getYAxisLabelAlignment(u).textAlign}e==="y"&&(l==="start"?N="top":l==="end"&&(N="bottom"));const E=this._getLabelSizes();for(x=0,y=r.length;x<y;++x){_=r[x],w=_.label;const D=o.setContext(this.getContext(x));M=this.getPixelForTick(x)+o.labelOffset,P=this._resolveTickFontOptions(x),O=P.lineHeight,T=U(w)?w.length:1;const R=T/2,B=D.color,j=D.textStrokeColor,L=D.textStrokeWidth;let tt=C;a?(v=M,C==="inner"&&(x===y-1?tt=this.options.reverse?"left":"right":x===0?tt=this.options.reverse?"right":"left":tt="center"),i==="top"?c==="near"||m!==0?k=-T*O+O/2:c==="center"?k=-E.highest.height/2-R*O+O:k=-E.highest.height+O/2:c==="near"||m!==0?k=O/2:c==="center"?k=E.highest.height/2-R*O:k=E.highest.height-T*O,h&&(k*=-1),m!==0&&!D.showLabelBackdrop&&(v+=O/2*Math.sin(m))):(S=M,k=(1-T)*O/2);let V;if(D.showLabelBackdrop){const it=nt(D.backdropPadding),ct=E.heights[x],ot=E.widths[x];let re=k-it.top,$t=0-it.left;switch(N){case"middle":re-=ct/2;break;case"bottom":re-=ct;break}switch(C){case"center":$t-=ot/2;break;case"right":$t-=ot;break;case"inner":x===y-1?$t-=ot:x>0&&($t-=ot/2);break}V={left:$t,top:re,width:ot+it.width,height:ct+it.height,color:D.backdropColor}}b.push({label:w,font:P,textOffset:k,options:{rotation:m,color:B,strokeColor:j,strokeWidth:L,textAlign:tt,textBaseline:N,translation:[v,S],backdrop:V}})}return b}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-mt(this.labelRotation))return t==="top"?"left":"right";let i="center";return e.align==="start"?i="left":e.align==="end"?i="right":e.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:n,mirror:i,padding:o}}=this.options,a=this._getLabelSizes(),r=t+o,l=a.widest.width;let c,d;return e==="left"?i?(d=this.right+o,n==="near"?c="left":n==="center"?(c="center",d+=l/2):(c="right",d+=l)):(d=this.right-r,n==="near"?c="right":n==="center"?(c="center",d-=l/2):(c="left",d=this.left)):e==="right"?i?(d=this.left+o,n==="near"?c="right":n==="center"?(c="center",d-=l/2):(c="left",d-=l)):(d=this.left+r,n==="near"?c="left":n==="center"?(c="center",d+=l/2):(c="right",d=this.right)):c="right",{textAlign:c,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:n,top:i,width:o,height:a}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(n,i,o,a),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex(o=>o.value===t);return i>=0?e.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const e=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let o,a;const r=(l,c,d)=>{!d.width||!d.color||(n.save(),n.lineWidth=d.width,n.strokeStyle=d.color,n.setLineDash(d.borderDash||[]),n.lineDashOffset=d.borderDashOffset,n.beginPath(),n.moveTo(l.x,l.y),n.lineTo(c.x,c.y),n.stroke(),n.restore())};if(e.display)for(o=0,a=i.length;o<a;++o){const l=i[o];e.drawOnChartArea&&r({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),e.drawTicks&&r({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:n,grid:i}}=this,o=n.setContext(this.getContext()),a=n.display?o.width:0;if(!a)return;const r=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,d,h,u;this.isHorizontal()?(c=Wt(t,this.left,a)-a/2,d=Wt(t,this.right,r)+r/2,h=u=l):(h=Wt(t,this.top,a)-a/2,u=Wt(t,this.bottom,r)+r/2,c=d=l),e.save(),e.lineWidth=o.width,e.strokeStyle=o.color,e.beginPath(),e.moveTo(c,h),e.lineTo(d,u),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const n=this.ctx,i=this._computeLabelArea();i&&ys(n,i);const o=this.getLabelItems(t);for(const a of o){const r=a.options,l=a.font,c=a.label,d=a.textOffset;Zt(n,c,0,d,l,r)}i&&_s(n)}drawTitle(){const{ctx:t,options:{position:e,title:n,reverse:i}}=this;if(!n.display)return;const o=Q(n.font),a=nt(n.padding),r=n.align;let l=o.lineHeight/2;e==="bottom"||e==="center"||F(e)?(l+=a.bottom,U(n.text)&&(l+=o.lineHeight*(n.text.length-1))):l+=a.top;const{titleX:c,titleY:d,maxWidth:h,rotation:u}=Hc(this,l,e,r);Zt(t,n.text,0,0,o,{color:n.color,maxWidth:h,rotation:u,textAlign:zc(r,e,i),textBaseline:"middle",translation:[c,d]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,n=I(t.grid&&t.grid.z,-1),i=I(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Qt.prototype.draw?[{z:e,draw:o=>{this.draw(o)}}]:[{z:n,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:e,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let o,a;for(o=0,a=e.length;o<a;++o){const r=e[o];r[n]===this.id&&(!t||r.type===t)&&i.push(r)}return i}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return Q(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Ke{constructor(t,e,n){this.type=t,this.scope=e,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let n;Yc(e)&&(n=this.register(e));const i=this.items,o=t.id,a=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+t);return o in i||(i[o]=t,Wc(t,a,n),this.override&&X.override(t.id,t.overrides)),a}get(t){return this.items[t]}unregister(t){const e=this.items,n=t.id,i=this.scope;n in e&&delete e[n],i&&n in X[i]&&(delete X[i][n],this.override&&delete Jt[n])}}function Wc(s,t,e){const n=ke(Object.create(null),[e?X.get(e):{},X.get(t),s.defaults]);X.set(t,n),s.defaultRoutes&&Vc(t,s.defaultRoutes),s.descriptors&&X.describe(t,s.descriptors)}function Vc(s,t){Object.keys(t).forEach(e=>{const n=e.split("."),i=n.pop(),o=[s].concat(n).join("."),a=t[e].split("."),r=a.pop(),l=a.join(".");X.route(o,i,l,r)})}function Yc(s){return"id"in s&&"defaults"in s}class Uc{constructor(){this.controllers=new Ke(qt,"datasets",!0),this.elements=new Ke(bt,"elements"),this.plugins=new Ke(Object,"plugins"),this.scales=new Ke(Qt,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,n){[...e].forEach(i=>{const o=n||this._getRegistryForType(i);n||o.isForType(i)||o===this.plugins&&i.id?this._exec(t,o,i):W(i,a=>{const r=n||this._getRegistryForType(a);this._exec(t,r,a)})})}_exec(t,e,n){const i=hn(t);Y(n["before"+i],[],n),e[t](n),Y(n["after"+i],[],n)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const n=this._typedRegistries[e];if(n.isForType(t))return n}return this.plugins}_get(t,e,n){const i=e.get(t);if(i===void 0)throw new Error('"'+t+'" is not a registered '+n+".");return i}}var yt=new Uc;class Kc{constructor(){this._init=void 0}notify(t,e,n,i){if(e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const o=i?this._descriptors(t).filter(i):this._descriptors(t),a=this._notify(o,t,e,n);return e==="afterDestroy"&&(this._notify(o,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),a}_notify(t,e,n,i){i=i||{};for(const o of t){const a=o.plugin,r=a[n],l=[e,i,o.options];if(Y(r,l,a)===!1&&i.cancelable)return!1}return!0}invalidate(){H(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const n=t&&t.config,i=I(n.options&&n.options.plugins,{}),o=Xc(n);return i===!1&&!e?[]:qc(t,o,i,e)}_notifyStateChanges(t){const e=this._oldCache||[],n=this._cache,i=(o,a)=>o.filter(r=>!a.some(l=>r.plugin.id===l.plugin.id));this._notify(i(e,n),t,"stop"),this._notify(i(n,e),t,"start")}}function Xc(s){const t={},e=[],n=Object.keys(yt.plugins.items);for(let o=0;o<n.length;o++)e.push(yt.getPlugin(n[o]));const i=s.plugins||[];for(let o=0;o<i.length;o++){const a=i[o];e.indexOf(a)===-1&&(e.push(a),t[a.id]=!0)}return{plugins:e,localIds:t}}function Gc(s,t){return!t&&s===!1?null:s===!0?{}:s}function qc(s,{plugins:t,localIds:e},n,i){const o=[],a=s.getContext();for(const r of t){const l=r.id,c=Gc(n[l],i);c!==null&&o.push({plugin:r,options:Jc(s.config,{plugin:r,local:e[l]},c,a)})}return o}function Jc(s,{plugin:t,local:e},n,i){const o=s.pluginScopeKeys(t),a=s.getOptionScopes(n,o);return e&&t.defaults&&a.push(t.defaults),s.createResolver(a,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Zs(s,t){const e=X.datasets[s]||{};return((t.datasets||{})[s]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function Zc(s,t){let e=s;return s==="_index_"?e=t:s==="_value_"&&(e=t==="x"?"y":"x"),e}function Qc(s,t){return s===t?"_index_":"_value_"}function ui(s){if(s==="x"||s==="y"||s==="r")return s}function td(s){if(s==="top"||s==="bottom")return"x";if(s==="left"||s==="right")return"y"}function Qs(s,...t){if(ui(s))return s;for(const e of t){const n=e.axis||td(e.position)||s.length>1&&ui(s[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${s}' axis. Please provide 'axis' or 'position' option.`)}function fi(s,t,e){if(e[t+"AxisID"]===s)return{axis:t}}function ed(s,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(n=>n.xAxisID===s||n.yAxisID===s);if(e.length)return fi(s,"x",e[0])||fi(s,"y",e[0])}return{}}function sd(s,t){const e=Jt[s.type]||{scales:{}},n=t.scales||{},i=Zs(s.type,t),o=Object.create(null);return Object.keys(n).forEach(a=>{const r=n[a];if(!F(r))return console.error(`Invalid scale configuration for scale: ${a}`);if(r._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const l=Qs(a,r,ed(a,s),X.scales[r.type]),c=Qc(l,i),d=e.scales||{};o[a]=xe(Object.create(null),[{axis:l},r,d[l],d[c]])}),s.data.datasets.forEach(a=>{const r=a.type||s.type,l=a.indexAxis||Zs(r,t),d=(Jt[r]||{}).scales||{};Object.keys(d).forEach(h=>{const u=Zc(h,l),g=a[u+"AxisID"]||u;o[g]=o[g]||Object.create(null),xe(o[g],[{axis:u},n[g],d[h]])})}),Object.keys(o).forEach(a=>{const r=o[a];xe(r,[X.scales[r.type],X.scale])}),o}function Yo(s){const t=s.options||(s.options={});t.plugins=I(t.plugins,{}),t.scales=sd(s,t)}function Uo(s){return s=s||{},s.datasets=s.datasets||[],s.labels=s.labels||[],s}function nd(s){return s=s||{},s.data=Uo(s.data),Yo(s),s}const gi=new Map,Ko=new Set;function Xe(s,t){let e=gi.get(s);return e||(e=t(),gi.set(s,e),Ko.add(e)),e}const ue=(s,t,e)=>{const n=Lt(t,e);n!==void 0&&s.add(n)};class id{constructor(t){this._config=nd(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Uo(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Yo(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Xe(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return Xe(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return Xe(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,n=this.type;return Xe(`${n}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const n=this._scopeCache;let i=n.get(t);return(!i||e)&&(i=new Map,n.set(t,i)),i}getOptionScopes(t,e,n){const{options:i,type:o}=this,a=this._cachedScopes(t,n),r=a.get(e);if(r)return r;const l=new Set;e.forEach(d=>{t&&(l.add(t),d.forEach(h=>ue(l,t,h))),d.forEach(h=>ue(l,i,h)),d.forEach(h=>ue(l,Jt[o]||{},h)),d.forEach(h=>ue(l,X,h)),d.forEach(h=>ue(l,Gs,h))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),Ko.has(e)&&a.set(e,c),c}chartOptionScopes(){const{options:t,type:e}=this;return[t,Jt[e]||{},X.datasets[e]||{},{type:e},X,Gs]}resolveNamedOptions(t,e,n,i=[""]){const o={$shared:!0},{resolver:a,subPrefixes:r}=pi(this._resolverCache,t,i);let l=a;if(ad(a,e)){o.$shared=!1,n=Ft(n)?n():n;const c=this.createResolver(t,n,r);l=ie(a,n,c)}for(const c of e)o[c]=l[c];return o}createResolver(t,e,n=[""],i){const{resolver:o}=pi(this._resolverCache,t,n);return F(e)?ie(o,e,void 0,i):o}}function pi(s,t,e){let n=s.get(t);n||(n=new Map,s.set(t,n));const i=e.join();let o=n.get(i);return o||(o={resolver:bn(t,e),subPrefixes:e.filter(r=>!r.toLowerCase().includes("hover"))},n.set(i,o)),o}const od=s=>F(s)&&Object.getOwnPropertyNames(s).some(t=>Ft(s[t]));function ad(s,t){const{isScriptable:e,isIndexable:n}=Co(s);for(const i of t){const o=e(i),a=n(i),r=(a||o)&&s[i];if(o&&(Ft(r)||od(r))||a&&U(r))return!0}return!1}var rd="4.5.1";const ld=["top","bottom","left","right","chartArea"];function mi(s,t){return s==="top"||s==="bottom"||ld.indexOf(s)===-1&&t==="x"}function bi(s,t){return function(e,n){return e[s]===n[s]?e[t]-n[t]:e[s]-n[s]}}function xi(s){const t=s.chart,e=t.options.animation;t.notifyPlugins("afterRender"),Y(e&&e.onComplete,[s],t)}function cd(s){const t=s.chart,e=t.options.animation;Y(e&&e.onProgress,[s],t)}function Xo(s){return _n()&&typeof s=="string"?s=document.getElementById(s):s&&s.length&&(s=s[0]),s&&s.canvas&&(s=s.canvas),s}const ss={},yi=s=>{const t=Xo(s);return Object.values(ss).filter(e=>e.canvas===t).pop()};function dd(s,t,e){const n=Object.keys(s);for(const i of n){const o=+i;if(o>=t){const a=s[i];delete s[i],(e>0||o>t)&&(s[o+e]=a)}}}function hd(s,t,e,n){return!e||s.type==="mouseout"?null:n?t:s}var Nt;let Fe=(Nt=class{static register(...t){yt.add(...t),_i()}static unregister(...t){yt.remove(...t),_i()}constructor(t,e){const n=this.config=new id(e),i=Xo(t),o=yi(i);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const a=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||Nc(i)),this.platform.updateConfig(n);const r=this.platform.acquireContext(i,a.aspectRatio),l=r&&r.canvas,c=l&&l.height,d=l&&l.width;if(this.id=ur(),this.ctx=r,this.canvas=l,this.width=d,this.height=c,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Kc,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Nr(h=>this.update(h),a.resizeDelay||0),this._dataChanges=[],ss[this.id]=this,!r||!l){console.error("Failed to create chart: can't acquire context from the given item");return}St.listen(this,"complete",xi),St.listen(this,"progress",cd),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:n,height:i,_aspectRatio:o}=this;return H(t)?e&&o?o:i?n/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return yt}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Hn(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Bn(this.canvas,this.ctx),this}stop(){return St.stop(this),this}resize(t,e){St.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const n=this.options,i=this.canvas,o=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(i,t,e,o),r=n.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,Hn(this,r,!0)&&(this.notifyPlugins("resize",{size:a}),Y(n.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};W(e,(n,i)=>{n.id=i})}buildOrUpdateScales(){const t=this.options,e=t.scales,n=this.scales,i=Object.keys(n).reduce((a,r)=>(a[r]=!1,a),{});let o=[];e&&(o=o.concat(Object.keys(e).map(a=>{const r=e[a],l=Qs(a,r),c=l==="r",d=l==="x";return{options:r,dposition:c?"chartArea":d?"bottom":"left",dtype:c?"radialLinear":d?"category":"linear"}}))),W(o,a=>{const r=a.options,l=r.id,c=Qs(l,r),d=I(r.type,a.dtype);(r.position===void 0||mi(r.position,c)!==mi(a.dposition))&&(r.position=a.dposition),i[l]=!0;let h=null;if(l in n&&n[l].type===d)h=n[l];else{const u=yt.getScale(d);h=new u({id:l,type:d,ctx:this.ctx,chart:this}),n[h.id]=h}h.init(r,t)}),W(i,(a,r)=>{a||delete n[r]}),W(n,a=>{gt.configure(this,a,a.options),gt.addBox(this,a)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,n=t.length;if(t.sort((i,o)=>i.index-o.index),n>e){for(let i=e;i<n;++i)this._destroyDatasetMeta(i);t.splice(e,n-e)}this._sortedMetasets=t.slice(0).sort(bi("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((n,i)=>{e.filter(o=>o===n._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=e.length;n<i;n++){const o=e[n];let a=this.getDatasetMeta(n);const r=o.type||this.config.type;if(a.type&&a.type!==r&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=r,a.indexAxis=o.indexAxis||Zs(r,this.options),a.order=o.order||0,a.index=n,a.label=""+o.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{const l=yt.getController(r),{datasetElementType:c,dataElementType:d}=X.datasets[r];Object.assign(l,{dataElementType:yt.getElement(d),datasetElementType:c&&yt.getElement(c)}),a.controller=new l(this,n),t.push(a.controller)}}return this._updateMetasets(),t}_resetElements(){W(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const n=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let c=0,d=this.data.datasets.length;c<d;c++){const{controller:h}=this.getDatasetMeta(c),u=!i&&o.indexOf(h)===-1;h.buildOrUpdateElements(u),a=Math.max(+h.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),i||W(o,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(bi("z","_idx"));const{_active:r,_lastEvent:l}=this;l?this._eventHandler(l,!0):r.length&&this._updateHoverStyles(r,r,!0),this.render()}_updateScales(){W(this.scales,t=>{gt.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),n=new Set(t.events);(!Dn(e,n)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:o}of e){const a=n==="_removeElements"?-o:o;dd(t,i,a)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,n=o=>new Set(t.filter(a=>a[0]===o).map((a,r)=>r+","+a.splice(1).join(","))),i=n(0);for(let o=1;o<e;o++)if(!Dn(i,n(o)))return;return Array.from(i).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;gt.update(this,this.width,this.height,t);const e=this.chartArea,n=e.width<=0||e.height<=0;this._layers=[],W(this.boxes,i=>{n&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,o)=>{i._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,n=this.data.datasets.length;e<n;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,n=this.data.datasets.length;e<n;++e)this._updateDataset(e,Ft(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const n=this.getDatasetMeta(t),i={meta:n,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(n.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(St.has(this)?this.attached&&!St.running(this)&&St.start(this):(this.draw(),xi({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:n,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,n=[];let i,o;for(i=0,o=e.length;i<o;++i){const a=e[i];(!t||a.visible)&&n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,n={meta:t,index:t.index,cancelable:!0},i=Lo(this,t);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(i&&ys(e,i),t.controller.draw(),i&&_s(e),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(t){return Pt(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,n,i){const o=lc.modes[e];return typeof o=="function"?o(this,t,n,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],n=this._metasets;let i=n.filter(o=>o&&o._dataset===e).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=Bt(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const n=this.getDatasetMeta(t);return typeof n.hidden=="boolean"?!n.hidden:!e.hidden}setDatasetVisibility(t,e){const n=this.getDatasetMeta(t);n.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,n){const i=n?"show":"hide",o=this.getDatasetMeta(t),a=o.controller._resolveAnimations(void 0,i);Se(e)?(o.data[e].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),a.update(o,{visible:n}),this.update(r=>r.datasetIndex===t?i:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),St.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Bn(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete ss[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,n=(o,a)=>{e.addEventListener(this,o,a),t[o]=a},i=(o,a,r)=>{o.offsetX=a,o.offsetY=r,this._eventHandler(o)};W(this.options.events,o=>n(o,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,n=(l,c)=>{e.addEventListener(this,l,c),t[l]=c},i=(l,c)=>{t[l]&&(e.removeEventListener(this,l,c),delete t[l])},o=(l,c)=>{this.canvas&&this.resize(l,c)};let a;const r=()=>{i("attach",r),this.attached=!0,this.resize(),n("resize",o),n("detach",a)};a=()=>{this.attached=!1,i("resize",o),this._stop(),this._resize(0,0),n("attach",r)},e.isAttached(this.canvas)?r():a()}unbindEvents(){W(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},W(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,n){const i=n?"set":"remove";let o,a,r,l;for(e==="dataset"&&(o=this.getDatasetMeta(t[0].datasetIndex),o.controller["_"+i+"DatasetHoverStyle"]()),r=0,l=t.length;r<l;++r){a=t[r];const c=a&&this.getDatasetMeta(a.datasetIndex).controller;c&&c[i+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],n=t.map(({datasetIndex:o,index:a})=>{const r=this.getDatasetMeta(o);if(!r)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:r.data[a],index:a}});!as(n,e)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,e))}notifyPlugins(t,e,n){return this._plugins.notify(this,t,e,n)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,n){const i=this.options.hover,o=(l,c)=>l.filter(d=>!c.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),a=o(e,t),r=n?t:o(t,e);a.length&&this.updateHoverStyle(a,i.mode,!1),r.length&&i.mode&&this.updateHoverStyle(r,i.mode,!0)}_eventHandler(t,e){const n={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=a=>(a.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",n,i)===!1)return;const o=this._handleEvent(t,e,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(o||n.changed)&&this.render(),this}_handleEvent(t,e,n){const{_active:i=[],options:o}=this,a=e,r=this._getActiveElements(t,i,n,a),l=xr(t),c=hd(t,this._lastEvent,n,l);n&&(this._lastEvent=null,Y(o.onHover,[t,r,this],this),l&&Y(o.onClick,[t,r,this],this));const d=!as(r,i);return(d||e)&&(this._active=r,this._updateHoverStyles(r,i,e)),this._lastEvent=c,d}_getActiveElements(t,e,n,i){if(t.type==="mouseout")return[];if(!n)return e;const o=this.options.hover;return this.getElementsAtEventForMode(t,o.mode,o,i)}},A(Nt,"defaults",X),A(Nt,"instances",ss),A(Nt,"overrides",Jt),A(Nt,"registry",yt),A(Nt,"version",rd),A(Nt,"getChart",yi),Nt);function _i(){return W(Fe.instances,s=>s._plugins.invalidate())}function ud(s,t,e){const{startAngle:n,x:i,y:o,outerRadius:a,innerRadius:r,options:l}=t,{borderWidth:c,borderJoinStyle:d}=l,h=Math.min(c/a,st(n-e));if(s.beginPath(),s.arc(i,o,a-c/2,n+h/2,e-h/2),r>0){const u=Math.min(c/r,st(n-e));s.arc(i,o,r+c/2,e-u/2,n+u/2,!0)}else{const u=Math.min(c/2,a*st(n-e));if(d==="round")s.arc(i,o,u,e-$/2,n+$/2,!0);else if(d==="bevel"){const g=2*u*u,p=-g*Math.cos(e+$/2)+i,m=-g*Math.sin(e+$/2)+o,b=g*Math.cos(n+$/2)+i,x=g*Math.sin(n+$/2)+o;s.lineTo(p,m),s.lineTo(b,x)}}s.closePath(),s.moveTo(0,0),s.rect(0,0,s.canvas.width,s.canvas.height),s.clip("evenodd")}function fd(s,t,e){const{startAngle:n,pixelMargin:i,x:o,y:a,outerRadius:r,innerRadius:l}=t;let c=i/r;s.beginPath(),s.arc(o,a,r,n-c,e+c),l>i?(c=i/l,s.arc(o,a,l,e+c,n-c,!0)):s.arc(o,a,i,e+q,n-q),s.closePath(),s.clip()}function gd(s){return mn(s,["outerStart","outerEnd","innerStart","innerEnd"])}function pd(s,t,e,n){const i=gd(s.options.borderRadius),o=(e-t)/2,a=Math.min(o,n*t/2),r=l=>{const c=(e-Math.min(o,l))*n/2;return lt(l,0,Math.min(o,c))};return{outerStart:r(i.outerStart),outerEnd:r(i.outerEnd),innerStart:lt(i.innerStart,0,a),innerEnd:lt(i.innerEnd,0,a)}}function ee(s,t,e,n){return{x:e+s*Math.cos(t),y:n+s*Math.sin(t)}}function fs(s,t,e,n,i,o){const{x:a,y:r,startAngle:l,pixelMargin:c,innerRadius:d}=t,h=Math.max(t.outerRadius+n+e-c,0),u=d>0?d+n+e+c:0;let g=0;const p=i-l;if(n){const D=d>0?d-n:0,R=h>0?h-n:0,B=(D+R)/2,j=B!==0?p*B/(B+n):p;g=(p-j)/2}const m=Math.max(.001,p*h-e/$)/h,b=(p-m)/2,x=l+b+g,y=i-b-g,{outerStart:_,outerEnd:w,innerStart:v,innerEnd:S}=pd(t,u,h,y-x),C=h-_,M=h-w,P=x+_/C,O=y-w/M,T=u+v,k=u+S,N=x+v/T,E=y-S/k;if(s.beginPath(),o){const D=(P+O)/2;if(s.arc(a,r,h,P,D),s.arc(a,r,h,D,O),w>0){const L=ee(M,O,a,r);s.arc(L.x,L.y,w,O,y+q)}const R=ee(k,y,a,r);if(s.lineTo(R.x,R.y),S>0){const L=ee(k,E,a,r);s.arc(L.x,L.y,S,y+q,E+Math.PI)}const B=(y-S/u+(x+v/u))/2;if(s.arc(a,r,u,y-S/u,B,!0),s.arc(a,r,u,B,x+v/u,!0),v>0){const L=ee(T,N,a,r);s.arc(L.x,L.y,v,N+Math.PI,x-q)}const j=ee(C,x,a,r);if(s.lineTo(j.x,j.y),_>0){const L=ee(C,P,a,r);s.arc(L.x,L.y,_,x-q,P)}}else{s.moveTo(a,r);const D=Math.cos(P)*h+a,R=Math.sin(P)*h+r;s.lineTo(D,R);const B=Math.cos(O)*h+a,j=Math.sin(O)*h+r;s.lineTo(B,j)}s.closePath()}function md(s,t,e,n,i){const{fullCircles:o,startAngle:a,circumference:r}=t;let l=t.endAngle;if(o){fs(s,t,e,n,l,i);for(let c=0;c<o;++c)s.fill();isNaN(r)||(l=a+(r%K||K))}return fs(s,t,e,n,l,i),s.fill(),l}function bd(s,t,e,n,i){const{fullCircles:o,startAngle:a,circumference:r,options:l}=t,{borderWidth:c,borderJoinStyle:d,borderDash:h,borderDashOffset:u,borderRadius:g}=l,p=l.borderAlign==="inner";if(!c)return;s.setLineDash(h||[]),s.lineDashOffset=u,p?(s.lineWidth=c*2,s.lineJoin=d||"round"):(s.lineWidth=c,s.lineJoin=d||"bevel");let m=t.endAngle;if(o){fs(s,t,e,n,m,i);for(let b=0;b<o;++b)s.stroke();isNaN(r)||(m=a+(r%K||K))}p&&fd(s,t,m),l.selfJoin&&m-a>=$&&g===0&&d!=="miter"&&ud(s,t,m),o||(fs(s,t,e,n,m,i),s.stroke())}class me extends bt{constructor(e){super();A(this,"circumference");A(this,"endAngle");A(this,"fullCircles");A(this,"innerRadius");A(this,"outerRadius");A(this,"pixelMargin");A(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,n,i){const o=this.getProps(["x","y"],i),{angle:a,distance:r}=xo(o,{x:e,y:n}),{startAngle:l,endAngle:c,innerRadius:d,outerRadius:h,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),g=(this.options.spacing+this.options.borderWidth)/2,p=I(u,c-l),m=Me(a,l,c)&&l!==c,b=p>=K||m,x=At(r,d+g,h+g);return b&&x}getCenterPoint(e){const{x:n,y:i,startAngle:o,endAngle:a,innerRadius:r,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:d}=this.options,h=(o+a)/2,u=(r+l+d+c)/2;return{x:n+Math.cos(h)*u,y:i+Math.sin(h)*u}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:n,circumference:i}=this,o=(n.offset||0)/4,a=(n.spacing||0)/2,r=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>K?Math.floor(i/K):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const l=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(l)*o,Math.sin(l)*o);const c=1-Math.sin(Math.min($,i||0)),d=o*c;e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,md(e,this,d,a,r),bd(e,this,d,a,r),e.restore()}}A(me,"id","arc"),A(me,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),A(me,"defaultRoutes",{backgroundColor:"backgroundColor"}),A(me,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"});function Go(s,t,e=t){s.lineCap=I(e.borderCapStyle,t.borderCapStyle),s.setLineDash(I(e.borderDash,t.borderDash)),s.lineDashOffset=I(e.borderDashOffset,t.borderDashOffset),s.lineJoin=I(e.borderJoinStyle,t.borderJoinStyle),s.lineWidth=I(e.borderWidth,t.borderWidth),s.strokeStyle=I(e.borderColor,t.borderColor)}function xd(s,t,e){s.lineTo(e.x,e.y)}function yd(s){return s.stepped?zr:s.tension||s.cubicInterpolationMode==="monotone"?Hr:xd}function qo(s,t,e={}){const n=s.length,{start:i=0,end:o=n-1}=e,{start:a,end:r}=t,l=Math.max(i,a),c=Math.min(o,r),d=i<a&&o<a||i>r&&o>r;return{count:n,start:l,loop:t.loop,ilen:c<l&&!d?n+c-l:c-l}}function _d(s,t,e,n){const{points:i,options:o}=t,{count:a,start:r,loop:l,ilen:c}=qo(i,e,n),d=yd(o);let{move:h=!0,reverse:u}=n||{},g,p,m;for(g=0;g<=c;++g)p=i[(r+(u?c-g:g))%a],!p.skip&&(h?(s.moveTo(p.x,p.y),h=!1):d(s,m,p,u,o.stepped),m=p);return l&&(p=i[(r+(u?c:0))%a],d(s,m,p,u,o.stepped)),!!l}function vd(s,t,e,n){const i=t.points,{count:o,start:a,ilen:r}=qo(i,e,n),{move:l=!0,reverse:c}=n||{};let d=0,h=0,u,g,p,m,b,x;const y=w=>(a+(c?r-w:w))%o,_=()=>{m!==b&&(s.lineTo(d,b),s.lineTo(d,m),s.lineTo(d,x))};for(l&&(g=i[y(0)],s.moveTo(g.x,g.y)),u=0;u<=r;++u){if(g=i[y(u)],g.skip)continue;const w=g.x,v=g.y,S=w|0;S===p?(v<m?m=v:v>b&&(b=v),d=(h*d+w)/++h):(_(),s.lineTo(w,v),p=S,h=0,m=b=v),x=v}_()}function tn(s){const t=s.options,e=t.borderDash&&t.borderDash.length;return!s._decimated&&!s._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?vd:_d}function wd(s){return s.stepped?vl:s.tension||s.cubicInterpolationMode==="monotone"?wl:Kt}function kd(s,t,e,n){let i=t._path;i||(i=t._path=new Path2D,t.path(i,e,n)&&i.closePath()),Go(s,t.options),s.stroke(i)}function Sd(s,t,e,n){const{segments:i,options:o}=t,a=tn(t);for(const r of i)Go(s,o,r.style),s.beginPath(),a(s,t,r,{start:e,end:e+n-1})&&s.closePath(),s.stroke()}const Md=typeof Path2D=="function";function Cd(s,t,e,n){Md&&!t.options.segment?kd(s,t,e,n):Sd(s,t,e,n)}class Ot extends bt{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;fl(this._points,n,t,i,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Pl(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,n=t.length;return n&&e[t[n-1].end]}interpolate(t,e){const n=this.options,i=t[e],o=this.points,a=Ro(this,{property:e,start:i,end:i});if(!a.length)return;const r=[],l=wd(n);let c,d;for(c=0,d=a.length;c<d;++c){const{start:h,end:u}=a[c],g=o[h],p=o[u];if(g===p){r.push(g);continue}const m=Math.abs((i-g[e])/(p[e]-g[e])),b=l(g,p,m,n.stepped);b[e]=t[e],r.push(b)}return r.length===1?r[0]:r}pathSegment(t,e,n){return tn(this)(t,this,e,n)}path(t,e,n){const i=this.segments,o=tn(this);let a=this._loop;e=e||0,n=n||this.points.length-e;for(const r of i)a&=o(t,this,r,{start:e,end:e+n-1});return!!a}draw(t,e,n,i){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(t.save(),Cd(t,this,n,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}A(Ot,"id","line"),A(Ot,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),A(Ot,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),A(Ot,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function vi(s,t,e,n){const i=s.options,{[e]:o}=s.getProps([e],n);return Math.abs(t-o)<i.radius+i.hitRadius}class ns extends bt{constructor(e){super();A(this,"parsed");A(this,"skip");A(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,n,i){const o=this.options,{x:a,y:r}=this.getProps(["x","y"],i);return Math.pow(e-a,2)+Math.pow(n-r,2)<Math.pow(o.hitRadius+o.radius,2)}inXRange(e,n){return vi(this,e,"x",n)}inYRange(e,n){return vi(this,e,"y",n)}getCenterPoint(e){const{x:n,y:i}=this.getProps(["x","y"],e);return{x:n,y:i}}size(e){e=e||this.options||{};let n=e.radius||0;n=Math.max(n,n&&e.hoverRadius||0);const i=n&&e.borderWidth||0;return(n+i)*2}draw(e,n){const i=this.options;this.skip||i.radius<.1||!Pt(this,n,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,qs(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}A(ns,"id","point"),A(ns,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),A(ns,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function Jo(s,t){const{x:e,y:n,base:i,width:o,height:a}=s.getProps(["x","y","base","width","height"],t);let r,l,c,d,h;return s.horizontal?(h=a/2,r=Math.min(e,i),l=Math.max(e,i),c=n-h,d=n+h):(h=o/2,r=e-h,l=e+h,c=Math.min(n,i),d=Math.max(n,i)),{left:r,top:c,right:l,bottom:d}}function It(s,t,e,n){return s?0:lt(t,e,n)}function Ad(s,t,e){const n=s.options.borderWidth,i=s.borderSkipped,o=Mo(n);return{t:It(i.top,o.top,0,e),r:It(i.right,o.right,0,t),b:It(i.bottom,o.bottom,0,e),l:It(i.left,o.left,0,t)}}function Pd(s,t,e){const{enableBorderRadius:n}=s.getProps(["enableBorderRadius"]),i=s.options.borderRadius,o=Xt(i),a=Math.min(t,e),r=s.borderSkipped,l=n||F(i);return{topLeft:It(!l||r.top||r.left,o.topLeft,0,a),topRight:It(!l||r.top||r.right,o.topRight,0,a),bottomLeft:It(!l||r.bottom||r.left,o.bottomLeft,0,a),bottomRight:It(!l||r.bottom||r.right,o.bottomRight,0,a)}}function Nd(s){const t=Jo(s),e=t.right-t.left,n=t.bottom-t.top,i=Ad(s,e/2,n/2),o=Pd(s,e/2,n/2);return{outer:{x:t.left,y:t.top,w:e,h:n,radius:o},inner:{x:t.left+i.l,y:t.top+i.t,w:e-i.l-i.r,h:n-i.t-i.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,o.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(i.b,i.r))}}}}function Es(s,t,e,n){const i=t===null,o=e===null,r=s&&!(i&&o)&&Jo(s,n);return r&&(i||At(t,r.left,r.right))&&(o||At(e,r.top,r.bottom))}function Dd(s){return s.topLeft||s.topRight||s.bottomLeft||s.bottomRight}function jd(s,t){s.rect(t.x,t.y,t.w,t.h)}function Bs(s,t,e={}){const n=s.x!==e.x?-t:0,i=s.y!==e.y?-t:0,o=(s.x+s.w!==e.x+e.w?t:0)-n,a=(s.y+s.h!==e.y+e.h?t:0)-i;return{x:s.x+n,y:s.y+i,w:s.w+o,h:s.h+a,radius:s.radius}}class is extends bt{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:n,backgroundColor:i}}=this,{inner:o,outer:a}=Nd(this),r=Dd(a.radius)?Ce:jd;t.save(),(a.w!==o.w||a.h!==o.h)&&(t.beginPath(),r(t,Bs(a,e,o)),t.clip(),r(t,Bs(o,-e,a)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),r(t,Bs(o,e)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,e,n){return Es(this,t,e,n)}inXRange(t,e){return Es(this,t,null,e)}inYRange(t,e){return Es(this,null,t,e)}getCenterPoint(t){const{x:e,y:n,base:i,horizontal:o}=this.getProps(["x","y","base","horizontal"],t);return{x:o?(e+i)/2:e,y:o?n:(n+i)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}A(is,"id","bar"),A(is,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),A(is,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const en=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],wi=en.map(s=>s.replace("rgb(","rgba(").replace(")",", 0.5)"));function Zo(s){return en[s%en.length]}function Qo(s){return wi[s%wi.length]}function Td(s,t){return s.borderColor=Zo(t),s.backgroundColor=Qo(t),++t}function Od(s,t){return s.backgroundColor=s.data.map(()=>Zo(t++)),t}function Id(s,t){return s.backgroundColor=s.data.map(()=>Qo(t++)),t}function Rd(s){let t=0;return(e,n)=>{const i=s.getDatasetMeta(n).controller;i instanceof se?t=Od(e,t):i instanceof ts?t=Id(e,t):i&&(t=Td(e,t))}}function ki(s){let t;for(t in s)if(s[t].borderColor||s[t].backgroundColor)return!0;return!1}function Ld(s){return s&&(s.borderColor||s.backgroundColor)}function Fd(){return X.borderColor!=="rgba(0,0,0,0.1)"||X.backgroundColor!=="rgba(0,0,0,0.1)"}var ta={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(s,t,e){if(!e.enabled)return;const{data:{datasets:n},options:i}=s.config,{elements:o}=i,a=ki(n)||Ld(i)||o&&ki(o)||Fd();if(!e.forceOverride&&a)return;const r=Rd(s);n.forEach(r)}};function Ed(s,t,e){const n=s.segments,i=s.points,o=t.points,a=[];for(const r of n){let{start:l,end:c}=r;c=ws(l,c,i);const d=sn(e,i[l],i[c],r.loop);if(!t.segments){a.push({source:r,target:d,start:i[l],end:i[c]});continue}const h=Ro(t,d);for(const u of h){const g=sn(e,o[u.start],o[u.end],u.loop),p=Io(r,i,g);for(const m of p)a.push({source:m,target:u,start:{[e]:Si(d,g,"start",Math.max)},end:{[e]:Si(d,g,"end",Math.min)}})}}return a}function sn(s,t,e,n){if(n)return;let i=t[s],o=e[s];return s==="angle"&&(i=st(i),o=st(o)),{property:s,start:i,end:o}}function Bd(s,t){const{x:e=null,y:n=null}=s||{},i=t.points,o=[];return t.segments.forEach(({start:a,end:r})=>{r=ws(a,r,i);const l=i[a],c=i[r];n!==null?(o.push({x:l.x,y:n}),o.push({x:c.x,y:n})):e!==null&&(o.push({x:e,y:l.y}),o.push({x:e,y:c.y}))}),o}function ws(s,t,e){for(;t>s;t--){const n=e[t];if(!isNaN(n.x)&&!isNaN(n.y))break}return t}function Si(s,t,e,n){return s&&t?n(s[e],t[e]):s?s[e]:t?t[e]:0}function ea(s,t){let e=[],n=!1;return U(s)?(n=!0,e=s):e=Bd(s,t),e.length?new Ot({points:e,options:{tension:0},_loop:n,_fullLoop:n}):null}function Mi(s){return s&&s.fill!==!1}function $d(s,t,e){let i=s[t].fill;const o=[t];let a;if(!e)return i;for(;i!==!1&&o.indexOf(i)===-1;){if(!G(i))return i;if(a=s[i],!a)return!1;if(a.visible)return i;o.push(i),i=a.fill}return!1}function zd(s,t,e){const n=Yd(s);if(F(n))return isNaN(n.value)?!1:n;let i=parseFloat(n);return G(i)&&Math.floor(i)===i?Hd(n[0],t,i,e):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function Hd(s,t,e,n){return(s==="-"||s==="+")&&(e=t+e),e===t||e<0||e>=n?!1:e}function Wd(s,t){let e=null;return s==="start"?e=t.bottom:s==="end"?e=t.top:F(s)?e=t.getPixelForValue(s.value):t.getBasePixel&&(e=t.getBasePixel()),e}function Vd(s,t,e){let n;return s==="start"?n=e:s==="end"?n=t.options.reverse?t.min:t.max:F(s)?n=s.value:n=t.getBaseValue(),n}function Yd(s){const t=s.options,e=t.fill;let n=I(e&&e.target,e);return n===void 0&&(n=!!t.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function Ud(s){const{scale:t,index:e,line:n}=s,i=[],o=n.segments,a=n.points,r=Kd(t,e);r.push(ea({x:null,y:t.bottom},n));for(let l=0;l<o.length;l++){const c=o[l];for(let d=c.start;d<=c.end;d++)Xd(i,a[d],r)}return new Ot({points:i,options:{}})}function Kd(s,t){const e=[],n=s.getMatchingVisibleMetas("line");for(let i=0;i<n.length;i++){const o=n[i];if(o.index===t)break;o.hidden||e.unshift(o.dataset)}return e}function Xd(s,t,e){const n=[];for(let i=0;i<e.length;i++){const o=e[i],{first:a,last:r,point:l}=Gd(o,t,"x");if(!(!l||a&&r)){if(a)n.unshift(l);else if(s.push(l),!r)break}}s.push(...n)}function Gd(s,t,e){const n=s.interpolate(t,e);if(!n)return{};const i=n[e],o=s.segments,a=s.points;let r=!1,l=!1;for(let c=0;c<o.length;c++){const d=o[c],h=a[d.start][e],u=a[d.end][e];if(At(i,h,u)){r=i===h,l=i===u;break}}return{first:r,last:l,point:n}}class sa{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,n){const{x:i,y:o,radius:a}=this;return e=e||{start:0,end:K},t.arc(i,o,a,e.end,e.start,!0),!n.bounds}interpolate(t){const{x:e,y:n,radius:i}=this,o=t.angle;return{x:e+Math.cos(o)*i,y:n+Math.sin(o)*i,angle:o}}}function qd(s){const{chart:t,fill:e,line:n}=s;if(G(e))return Jd(t,e);if(e==="stack")return Ud(s);if(e==="shape")return!0;const i=Zd(s);return i instanceof sa?i:ea(i,n)}function Jd(s,t){const e=s.getDatasetMeta(t);return e&&s.isDatasetVisible(t)?e.dataset:null}function Zd(s){return(s.scale||{}).getPointPositionForValue?th(s):Qd(s)}function Qd(s){const{scale:t={},fill:e}=s,n=Wd(e,t);if(G(n)){const i=t.isHorizontal();return{x:i?n:null,y:i?null:n}}return null}function th(s){const{scale:t,fill:e}=s,n=t.options,i=t.getLabels().length,o=n.reverse?t.max:t.min,a=Vd(e,t,o),r=[];if(n.grid.circular){const l=t.getPointPositionForValue(0,o);return new sa({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(a)})}for(let l=0;l<i;++l)r.push(t.getPointPositionForValue(l,a));return r}function $s(s,t,e){const n=qd(t),{chart:i,index:o,line:a,scale:r,axis:l}=t,c=a.options,d=c.fill,h=c.backgroundColor,{above:u=h,below:g=h}=d||{},p=i.getDatasetMeta(o),m=Lo(i,p);n&&a.points.length&&(ys(s,e),eh(s,{line:a,target:n,above:u,below:g,area:e,scale:r,axis:l,clip:m}),_s(s))}function eh(s,t){const{line:e,target:n,above:i,below:o,area:a,scale:r,clip:l}=t,c=e._loop?"angle":t.axis;s.save();let d=o;o!==i&&(c==="x"?(Ci(s,n,a.top),zs(s,{line:e,target:n,color:i,scale:r,property:c,clip:l}),s.restore(),s.save(),Ci(s,n,a.bottom)):c==="y"&&(Ai(s,n,a.left),zs(s,{line:e,target:n,color:o,scale:r,property:c,clip:l}),s.restore(),s.save(),Ai(s,n,a.right),d=i)),zs(s,{line:e,target:n,color:d,scale:r,property:c,clip:l}),s.restore()}function Ci(s,t,e){const{segments:n,points:i}=t;let o=!0,a=!1;s.beginPath();for(const r of n){const{start:l,end:c}=r,d=i[l],h=i[ws(l,c,i)];o?(s.moveTo(d.x,d.y),o=!1):(s.lineTo(d.x,e),s.lineTo(d.x,d.y)),a=!!t.pathSegment(s,r,{move:a}),a?s.closePath():s.lineTo(h.x,e)}s.lineTo(t.first().x,e),s.closePath(),s.clip()}function Ai(s,t,e){const{segments:n,points:i}=t;let o=!0,a=!1;s.beginPath();for(const r of n){const{start:l,end:c}=r,d=i[l],h=i[ws(l,c,i)];o?(s.moveTo(d.x,d.y),o=!1):(s.lineTo(e,d.y),s.lineTo(d.x,d.y)),a=!!t.pathSegment(s,r,{move:a}),a?s.closePath():s.lineTo(e,h.y)}s.lineTo(e,t.first().y),s.closePath(),s.clip()}function zs(s,t){const{line:e,target:n,property:i,color:o,scale:a,clip:r}=t,l=Ed(e,n,i);for(const{source:c,target:d,start:h,end:u}of l){const{style:{backgroundColor:g=o}={}}=c,p=n!==!0;s.save(),s.fillStyle=g,sh(s,a,r,p&&sn(i,h,u)),s.beginPath();const m=!!e.pathSegment(s,c);let b;if(p){m?s.closePath():Pi(s,n,u,i);const x=!!n.pathSegment(s,d,{move:m,reverse:!0});b=m&&x,b||Pi(s,n,h,i)}s.closePath(),s.fill(b?"evenodd":"nonzero"),s.restore()}}function sh(s,t,e,n){const i=t.chart.chartArea,{property:o,start:a,end:r}=n||{};if(o==="x"||o==="y"){let l,c,d,h;o==="x"?(l=a,c=i.top,d=r,h=i.bottom):(l=i.left,c=a,d=i.right,h=r),s.beginPath(),e&&(l=Math.max(l,e.left),d=Math.min(d,e.right),c=Math.max(c,e.top),h=Math.min(h,e.bottom)),s.rect(l,c,d-l,h-c),s.clip()}}function Pi(s,t,e,n){const i=t.interpolate(e,n);i&&s.lineTo(i.x,i.y)}var nh={id:"filler",afterDatasetsUpdate(s,t,e){const n=(s.data.datasets||[]).length,i=[];let o,a,r,l;for(a=0;a<n;++a)o=s.getDatasetMeta(a),r=o.dataset,l=null,r&&r.options&&r instanceof Ot&&(l={visible:s.isDatasetVisible(a),index:a,fill:zd(r,a,n),chart:s,axis:o.controller.options.indexAxis,scale:o.vScale,line:r}),o.$filler=l,i.push(l);for(a=0;a<n;++a)l=i[a],!(!l||l.fill===!1)&&(l.fill=$d(i,a,e.propagate))},beforeDraw(s,t,e){const n=e.drawTime==="beforeDraw",i=s.getSortedVisibleDatasetMetas(),o=s.chartArea;for(let a=i.length-1;a>=0;--a){const r=i[a].$filler;r&&(r.line.updateControlPoints(o,r.axis),n&&r.fill&&$s(s.ctx,r,o))}},beforeDatasetsDraw(s,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const n=s.getSortedVisibleDatasetMetas();for(let i=n.length-1;i>=0;--i){const o=n[i].$filler;Mi(o)&&$s(s.ctx,o,s.chartArea)}},beforeDatasetDraw(s,t,e){const n=t.meta.$filler;!Mi(n)||e.drawTime!=="beforeDatasetDraw"||$s(s.ctx,n,s.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Ni=(s,t)=>{let{boxHeight:e=t,boxWidth:n=t}=s;return s.usePointStyle&&(e=Math.min(e,t),n=s.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:e,itemHeight:Math.max(t,e)}},ih=(s,t)=>s!==null&&t!==null&&s.datasetIndex===t.datasetIndex&&s.index===t.index;class Di extends bt{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,n){this.maxWidth=t,this.maxHeight=e,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=Y(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(n=>t.filter(n,this.chart.data))),t.sort&&(e=e.sort((n,i)=>t.sort(n,i,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const n=t.labels,i=Q(n.font),o=i.size,a=this._computeTitleHeight(),{boxWidth:r,itemHeight:l}=Ni(n,o);let c,d;e.font=i.string,this.isHorizontal()?(c=this.maxWidth,d=this._fitRows(a,o,r,l)+10):(d=this.maxHeight,c=this._fitCols(a,i,r,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(d,t.maxHeight||this.maxHeight)}_fitRows(t,e,n,i){const{ctx:o,maxWidth:a,options:{labels:{padding:r}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],d=i+r;let h=t;o.textAlign="left",o.textBaseline="middle";let u=-1,g=-d;return this.legendItems.forEach((p,m)=>{const b=n+e/2+o.measureText(p.text).width;(m===0||c[c.length-1]+b+2*r>a)&&(h+=d,c[c.length-(m>0?0:1)]=0,g+=d,u++),l[m]={left:0,top:g,row:u,width:b,height:i},c[c.length-1]+=b+r}),h}_fitCols(t,e,n,i){const{ctx:o,maxHeight:a,options:{labels:{padding:r}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],d=a-t;let h=r,u=0,g=0,p=0,m=0;return this.legendItems.forEach((b,x)=>{const{itemWidth:y,itemHeight:_}=oh(n,e,o,b,i);x>0&&g+_+2*r>d&&(h+=u+r,c.push({width:u,height:g}),p+=u+r,m++,u=g=0),l[x]={left:p,top:g,col:m,width:y,height:_},u=Math.max(u,y),g+=_+r}),h+=u,c.push({width:u,height:g}),h}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:n,labels:{padding:i},rtl:o}}=this,a=ne(o,this.left,this.width);if(this.isHorizontal()){let r=0,l=et(n,this.left+i,this.right-this.lineWidths[r]);for(const c of e)r!==c.row&&(r=c.row,l=et(n,this.left+i,this.right-this.lineWidths[r])),c.top+=this.top+t+i,c.left=a.leftForLtr(a.x(l),c.width),l+=c.width+i}else{let r=0,l=et(n,this.top+t+i,this.bottom-this.columnSizes[r].height);for(const c of e)c.col!==r&&(r=c.col,l=et(n,this.top+t+i,this.bottom-this.columnSizes[r].height)),c.top=l,c.left+=this.left+i,c.left=a.leftForLtr(a.x(c.left),c.width),l+=c.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;ys(t,this),this._draw(),_s(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:n,ctx:i}=this,{align:o,labels:a}=t,r=X.color,l=ne(t.rtl,this.left,this.width),c=Q(a.font),{padding:d}=a,h=c.size,u=h/2;let g;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:p,boxHeight:m,itemHeight:b}=Ni(a,h),x=function(S,C,M){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;i.save();const P=I(M.lineWidth,1);if(i.fillStyle=I(M.fillStyle,r),i.lineCap=I(M.lineCap,"butt"),i.lineDashOffset=I(M.lineDashOffset,0),i.lineJoin=I(M.lineJoin,"miter"),i.lineWidth=P,i.strokeStyle=I(M.strokeStyle,r),i.setLineDash(I(M.lineDash,[])),a.usePointStyle){const O={radius:m*Math.SQRT2/2,pointStyle:M.pointStyle,rotation:M.rotation,borderWidth:P},T=l.xPlus(S,p/2),k=C+u;So(i,O,T,k,a.pointStyleWidth&&p)}else{const O=C+Math.max((h-m)/2,0),T=l.leftForLtr(S,p),k=Xt(M.borderRadius);i.beginPath(),Object.values(k).some(N=>N!==0)?Ce(i,{x:T,y:O,w:p,h:m,radius:k}):i.rect(T,O,p,m),i.fill(),P!==0&&i.stroke()}i.restore()},y=function(S,C,M){Zt(i,M.text,S,C+b/2,c,{strikethrough:M.hidden,textAlign:l.textAlign(M.textAlign)})},_=this.isHorizontal(),w=this._computeTitleHeight();_?g={x:et(o,this.left+d,this.right-n[0]),y:this.top+d+w,line:0}:g={x:this.left+d,y:et(o,this.top+w+d,this.bottom-e[0].height),line:0},jo(this.ctx,t.textDirection);const v=b+d;this.legendItems.forEach((S,C)=>{i.strokeStyle=S.fontColor,i.fillStyle=S.fontColor;const M=i.measureText(S.text).width,P=l.textAlign(S.textAlign||(S.textAlign=a.textAlign)),O=p+u+M;let T=g.x,k=g.y;l.setWidth(this.width),_?C>0&&T+O+d>this.right&&(k=g.y+=v,g.line++,T=g.x=et(o,this.left+d,this.right-n[g.line])):C>0&&k+v>this.bottom&&(T=g.x=T+e[g.line].width+d,g.line++,k=g.y=et(o,this.top+w+d,this.bottom-e[g.line].height));const N=l.x(T);if(x(N,k,S),T=Dr(P,T+p+u,_?T+O:this.right,t.rtl),y(l.x(T),k,S),_)g.x+=O+d;else if(typeof S.text!="string"){const E=c.lineHeight;g.y+=na(S,E)+d}else g.y+=v}),To(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,n=Q(e.font),i=nt(e.padding);if(!e.display)return;const o=ne(t.rtl,this.left,this.width),a=this.ctx,r=e.position,l=n.size/2,c=i.top+l;let d,h=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),d=this.top+c,h=et(t.align,h,this.right-u);else{const p=this.columnSizes.reduce((m,b)=>Math.max(m,b.height),0);d=c+et(t.align,this.top,this.bottom-p-t.labels.padding-this._computeTitleHeight())}const g=et(r,h,h+u);a.textAlign=o.textAlign(gn(r)),a.textBaseline="middle",a.strokeStyle=e.color,a.fillStyle=e.color,a.font=n.string,Zt(a,e.text,g,d,n)}_computeTitleHeight(){const t=this.options.title,e=Q(t.font),n=nt(t.padding);return t.display?e.lineHeight+n.height:0}_getLegendItemAt(t,e){let n,i,o;if(At(t,this.left,this.right)&&At(e,this.top,this.bottom)){for(o=this.legendHitBoxes,n=0;n<o.length;++n)if(i=o[n],At(t,i.left,i.left+i.width)&&At(e,i.top,i.top+i.height))return this.legendItems[n]}return null}handleEvent(t){const e=this.options;if(!lh(t.type,e))return;const n=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const i=this._hoveredItem,o=ih(i,n);i&&!o&&Y(e.onLeave,[t,i,this],this),this._hoveredItem=n,n&&!o&&Y(e.onHover,[t,n,this],this)}else n&&Y(e.onClick,[t,n,this],this)}}function oh(s,t,e,n,i){const o=ah(n,s,t,e),a=rh(i,n,t.lineHeight);return{itemWidth:o,itemHeight:a}}function ah(s,t,e,n){let i=s.text;return i&&typeof i!="string"&&(i=i.reduce((o,a)=>o.length>a.length?o:a)),t+e.size/2+n.measureText(i).width}function rh(s,t,e){let n=s;return typeof t.text!="string"&&(n=na(t,e)),n}function na(s,t){const e=s.text?s.text.length:0;return t*e}function lh(s,t){return!!((s==="mousemove"||s==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(s==="click"||s==="mouseup"))}var ia={id:"legend",_element:Di,start(s,t,e){const n=s.legend=new Di({ctx:s.ctx,options:e,chart:s});gt.configure(s,n,e),gt.addBox(s,n)},stop(s){gt.removeBox(s,s.legend),delete s.legend},beforeUpdate(s,t,e){const n=s.legend;gt.configure(s,n,e),n.options=e},afterUpdate(s){const t=s.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(s,t){t.replay||s.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(s,t,e){const n=t.datasetIndex,i=e.chart;i.isDatasetVisible(n)?(i.hide(n),t.hidden=!0):(i.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:s=>s.chart.options.color,boxWidth:40,padding:10,generateLabels(s){const t=s.data.datasets,{labels:{usePointStyle:e,pointStyle:n,textAlign:i,color:o,useBorderRadius:a,borderRadius:r}}=s.legend.options;return s._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(e?0:void 0),d=nt(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:o,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:c.borderColor,pointStyle:n||c.pointStyle,rotation:c.rotation,textAlign:i||c.textAlign,borderRadius:a&&(r||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:s=>s.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:s=>!s.startsWith("on"),labels:{_scriptable:s=>!["generateLabels","filter","sort"].includes(s)}}};class oa extends bt{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const i=U(n.text)?n.text.length:1;this._padding=nt(n.padding);const o=i*Q(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:n,bottom:i,right:o,options:a}=this,r=a.align;let l=0,c,d,h;return this.isHorizontal()?(d=et(r,n,o),h=e+t,c=o-n):(a.position==="left"?(d=n+t,h=et(r,i,e),l=$*-.5):(d=o-t,h=et(r,e,i),l=$*.5),c=i-e),{titleX:d,titleY:h,maxWidth:c,rotation:l}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const n=Q(e.font),o=n.lineHeight/2+this._padding.top,{titleX:a,titleY:r,maxWidth:l,rotation:c}=this._drawArgs(o);Zt(t,e.text,0,0,n,{color:e.color,maxWidth:l,rotation:c,textAlign:gn(e.align),textBaseline:"middle",translation:[a,r]})}}function ch(s,t){const e=new oa({ctx:s.ctx,options:t,chart:s});gt.configure(s,e,t),gt.addBox(s,e),s.titleBlock=e}var dh={id:"title",_element:oa,start(s,t,e){ch(s,e)},stop(s){const t=s.titleBlock;gt.removeBox(s,t),delete s.titleBlock},beforeUpdate(s,t,e){const n=s.titleBlock;gt.configure(s,n,e),n.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const be={average(s){if(!s.length)return!1;let t,e,n=new Set,i=0,o=0;for(t=0,e=s.length;t<e;++t){const r=s[t].element;if(r&&r.hasValue()){const l=r.tooltipPosition();n.add(l.x),i+=l.y,++o}}return o===0||n.size===0?!1:{x:[...n].reduce((r,l)=>r+l)/n.size,y:i/o}},nearest(s,t){if(!s.length)return!1;let e=t.x,n=t.y,i=Number.POSITIVE_INFINITY,o,a,r;for(o=0,a=s.length;o<a;++o){const l=s[o].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),d=Ks(t,c);d<i&&(i=d,r=l)}}if(r){const l=r.tooltipPosition();e=l.x,n=l.y}return{x:e,y:n}}};function xt(s,t){return t&&(U(t)?Array.prototype.push.apply(s,t):s.push(t)),s}function Mt(s){return(typeof s=="string"||s instanceof String)&&s.indexOf(`
`)>-1?s.split(`
`):s}function hh(s,t){const{element:e,datasetIndex:n,index:i}=t,o=s.getDatasetMeta(n).controller,{label:a,value:r}=o.getLabelAndValue(i);return{chart:s,label:a,parsed:o.getParsed(i),raw:s.data.datasets[n].data[i],formattedValue:r,dataset:o.getDataset(),dataIndex:i,datasetIndex:n,element:e}}function ji(s,t){const e=s.chart.ctx,{body:n,footer:i,title:o}=s,{boxWidth:a,boxHeight:r}=t,l=Q(t.bodyFont),c=Q(t.titleFont),d=Q(t.footerFont),h=o.length,u=i.length,g=n.length,p=nt(t.padding);let m=p.height,b=0,x=n.reduce((w,v)=>w+v.before.length+v.lines.length+v.after.length,0);if(x+=s.beforeBody.length+s.afterBody.length,h&&(m+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),x){const w=t.displayColors?Math.max(r,l.lineHeight):l.lineHeight;m+=g*w+(x-g)*l.lineHeight+(x-1)*t.bodySpacing}u&&(m+=t.footerMarginTop+u*d.lineHeight+(u-1)*t.footerSpacing);let y=0;const _=function(w){b=Math.max(b,e.measureText(w).width+y)};return e.save(),e.font=c.string,W(s.title,_),e.font=l.string,W(s.beforeBody.concat(s.afterBody),_),y=t.displayColors?a+2+t.boxPadding:0,W(n,w=>{W(w.before,_),W(w.lines,_),W(w.after,_)}),y=0,e.font=d.string,W(s.footer,_),e.restore(),b+=p.width,{width:b,height:m}}function uh(s,t){const{y:e,height:n}=t;return e<n/2?"top":e>s.height-n/2?"bottom":"center"}function fh(s,t,e,n){const{x:i,width:o}=n,a=e.caretSize+e.caretPadding;if(s==="left"&&i+o+a>t.width||s==="right"&&i-o-a<0)return!0}function gh(s,t,e,n){const{x:i,width:o}=e,{width:a,chartArea:{left:r,right:l}}=s;let c="center";return n==="center"?c=i<=(r+l)/2?"left":"right":i<=o/2?c="left":i>=a-o/2&&(c="right"),fh(c,s,t,e)&&(c="center"),c}function Ti(s,t,e){const n=e.yAlign||t.yAlign||uh(s,e);return{xAlign:e.xAlign||t.xAlign||gh(s,t,e,n),yAlign:n}}function ph(s,t){let{x:e,width:n}=s;return t==="right"?e-=n:t==="center"&&(e-=n/2),e}function mh(s,t,e){let{y:n,height:i}=s;return t==="top"?n+=e:t==="bottom"?n-=i+e:n-=i/2,n}function Oi(s,t,e,n){const{caretSize:i,caretPadding:o,cornerRadius:a}=s,{xAlign:r,yAlign:l}=e,c=i+o,{topLeft:d,topRight:h,bottomLeft:u,bottomRight:g}=Xt(a);let p=ph(t,r);const m=mh(t,l,c);return l==="center"?r==="left"?p+=c:r==="right"&&(p-=c):r==="left"?p-=Math.max(d,u)+i:r==="right"&&(p+=Math.max(h,g)+i),{x:lt(p,0,n.width-t.width),y:lt(m,0,n.height-t.height)}}function Ge(s,t,e){const n=nt(e.padding);return t==="center"?s.x+s.width/2:t==="right"?s.x+s.width-n.right:s.x+n.left}function Ii(s){return xt([],Mt(s))}function bh(s,t,e){return Bt(s,{tooltip:t,tooltipItems:e,type:"tooltip"})}function Ri(s,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?s.override(e):s}const aa={beforeTitle:wt,title(s){if(s.length>0){const t=s[0],e=t.chart.data.labels,n=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(n>0&&t.dataIndex<n)return e[t.dataIndex]}return""},afterTitle:wt,beforeBody:wt,beforeLabel:wt,label(s){if(this&&this.options&&this.options.mode==="dataset")return s.label+": "+s.formattedValue||s.formattedValue;let t=s.dataset.label||"";t&&(t+=": ");const e=s.formattedValue;return H(e)||(t+=e),t},labelColor(s){const e=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(s){const e=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:wt,afterBody:wt,beforeFooter:wt,footer:wt,afterFooter:wt};function at(s,t,e,n){const i=s[t].call(e,n);return typeof i>"u"?aa[t].call(e,n):i}class nn extends bt{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&e.options.animation&&n.animations,o=new Fo(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=bh(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:n}=e,i=at(n,"beforeTitle",this,t),o=at(n,"title",this,t),a=at(n,"afterTitle",this,t);let r=[];return r=xt(r,Mt(i)),r=xt(r,Mt(o)),r=xt(r,Mt(a)),r}getBeforeBody(t,e){return Ii(at(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:n}=e,i=[];return W(t,o=>{const a={before:[],lines:[],after:[]},r=Ri(n,o);xt(a.before,Mt(at(r,"beforeLabel",this,o))),xt(a.lines,at(r,"label",this,o)),xt(a.after,Mt(at(r,"afterLabel",this,o))),i.push(a)}),i}getAfterBody(t,e){return Ii(at(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:n}=e,i=at(n,"beforeFooter",this,t),o=at(n,"footer",this,t),a=at(n,"afterFooter",this,t);let r=[];return r=xt(r,Mt(i)),r=xt(r,Mt(o)),r=xt(r,Mt(a)),r}_createItems(t){const e=this._active,n=this.chart.data,i=[],o=[],a=[];let r=[],l,c;for(l=0,c=e.length;l<c;++l)r.push(hh(this.chart,e[l]));return t.filter&&(r=r.filter((d,h,u)=>t.filter(d,h,u,n))),t.itemSort&&(r=r.sort((d,h)=>t.itemSort(d,h,n))),W(r,d=>{const h=Ri(t.callbacks,d);i.push(at(h,"labelColor",this,d)),o.push(at(h,"labelPointStyle",this,d)),a.push(at(h,"labelTextColor",this,d))}),this.labelColors=i,this.labelPointStyles=o,this.labelTextColors=a,this.dataPoints=r,r}update(t,e){const n=this.options.setContext(this.getContext()),i=this._active;let o,a=[];if(!i.length)this.opacity!==0&&(o={opacity:0});else{const r=be[n.position].call(this,i,this._eventPosition);a=this._createItems(n),this.title=this.getTitle(a,n),this.beforeBody=this.getBeforeBody(a,n),this.body=this.getBody(a,n),this.afterBody=this.getAfterBody(a,n),this.footer=this.getFooter(a,n);const l=this._size=ji(this,n),c=Object.assign({},r,l),d=Ti(this.chart,n,c),h=Oi(n,c,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,o={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:r.x,caretY:r.y}}this._tooltipItems=a,this.$context=void 0,o&&this._resolveAnimations().update(this,o),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,n,i){const o=this.getCaretPosition(t,n,i);e.lineTo(o.x1,o.y1),e.lineTo(o.x2,o.y2),e.lineTo(o.x3,o.y3)}getCaretPosition(t,e,n){const{xAlign:i,yAlign:o}=this,{caretSize:a,cornerRadius:r}=n,{topLeft:l,topRight:c,bottomLeft:d,bottomRight:h}=Xt(r),{x:u,y:g}=t,{width:p,height:m}=e;let b,x,y,_,w,v;return o==="center"?(w=g+m/2,i==="left"?(b=u,x=b-a,_=w+a,v=w-a):(b=u+p,x=b+a,_=w-a,v=w+a),y=b):(i==="left"?x=u+Math.max(l,d)+a:i==="right"?x=u+p-Math.max(c,h)-a:x=this.caretX,o==="top"?(_=g,w=_-a,b=x-a,y=x+a):(_=g+m,w=_+a,b=x+a,y=x-a),v=_),{x1:b,x2:x,x3:y,y1:_,y2:w,y3:v}}drawTitle(t,e,n){const i=this.title,o=i.length;let a,r,l;if(o){const c=ne(n.rtl,this.x,this.width);for(t.x=Ge(this,n.titleAlign,n),e.textAlign=c.textAlign(n.titleAlign),e.textBaseline="middle",a=Q(n.titleFont),r=n.titleSpacing,e.fillStyle=n.titleColor,e.font=a.string,l=0;l<o;++l)e.fillText(i[l],c.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+r,l+1===o&&(t.y+=n.titleMarginBottom-r)}}_drawColorBox(t,e,n,i,o){const a=this.labelColors[n],r=this.labelPointStyles[n],{boxHeight:l,boxWidth:c}=o,d=Q(o.bodyFont),h=Ge(this,"left",o),u=i.x(h),g=l<d.lineHeight?(d.lineHeight-l)/2:0,p=e.y+g;if(o.usePointStyle){const m={radius:Math.min(c,l)/2,pointStyle:r.pointStyle,rotation:r.rotation,borderWidth:1},b=i.leftForLtr(u,c)+c/2,x=p+l/2;t.strokeStyle=o.multiKeyBackground,t.fillStyle=o.multiKeyBackground,qs(t,m,b,x),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,qs(t,m,b,x)}else{t.lineWidth=F(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;const m=i.leftForLtr(u,c),b=i.leftForLtr(i.xPlus(u,1),c-2),x=Xt(a.borderRadius);Object.values(x).some(y=>y!==0)?(t.beginPath(),t.fillStyle=o.multiKeyBackground,Ce(t,{x:m,y:p,w:c,h:l,radius:x}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),Ce(t,{x:b,y:p+1,w:c-2,h:l-2,radius:x}),t.fill()):(t.fillStyle=o.multiKeyBackground,t.fillRect(m,p,c,l),t.strokeRect(m,p,c,l),t.fillStyle=a.backgroundColor,t.fillRect(b,p+1,c-2,l-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,e,n){const{body:i}=this,{bodySpacing:o,bodyAlign:a,displayColors:r,boxHeight:l,boxWidth:c,boxPadding:d}=n,h=Q(n.bodyFont);let u=h.lineHeight,g=0;const p=ne(n.rtl,this.x,this.width),m=function(M){e.fillText(M,p.x(t.x+g),t.y+u/2),t.y+=u+o},b=p.textAlign(a);let x,y,_,w,v,S,C;for(e.textAlign=a,e.textBaseline="middle",e.font=h.string,t.x=Ge(this,b,n),e.fillStyle=n.bodyColor,W(this.beforeBody,m),g=r&&b!=="right"?a==="center"?c/2+d:c+2+d:0,w=0,S=i.length;w<S;++w){for(x=i[w],y=this.labelTextColors[w],e.fillStyle=y,W(x.before,m),_=x.lines,r&&_.length&&(this._drawColorBox(e,t,w,p,n),u=Math.max(h.lineHeight,l)),v=0,C=_.length;v<C;++v)m(_[v]),u=h.lineHeight;W(x.after,m)}g=0,u=h.lineHeight,W(this.afterBody,m),t.y-=o}drawFooter(t,e,n){const i=this.footer,o=i.length;let a,r;if(o){const l=ne(n.rtl,this.x,this.width);for(t.x=Ge(this,n.footerAlign,n),t.y+=n.footerMarginTop,e.textAlign=l.textAlign(n.footerAlign),e.textBaseline="middle",a=Q(n.footerFont),e.fillStyle=n.footerColor,e.font=a.string,r=0;r<o;++r)e.fillText(i[r],l.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+n.footerSpacing}}drawBackground(t,e,n,i){const{xAlign:o,yAlign:a}=this,{x:r,y:l}=t,{width:c,height:d}=n,{topLeft:h,topRight:u,bottomLeft:g,bottomRight:p}=Xt(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(r+h,l),a==="top"&&this.drawCaret(t,e,n,i),e.lineTo(r+c-u,l),e.quadraticCurveTo(r+c,l,r+c,l+u),a==="center"&&o==="right"&&this.drawCaret(t,e,n,i),e.lineTo(r+c,l+d-p),e.quadraticCurveTo(r+c,l+d,r+c-p,l+d),a==="bottom"&&this.drawCaret(t,e,n,i),e.lineTo(r+g,l+d),e.quadraticCurveTo(r,l+d,r,l+d-g),a==="center"&&o==="left"&&this.drawCaret(t,e,n,i),e.lineTo(r,l+h),e.quadraticCurveTo(r,l,r+h,l),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,n=this.$animations,i=n&&n.x,o=n&&n.y;if(i||o){const a=be[t.position].call(this,this._active,this._eventPosition);if(!a)return;const r=this._size=ji(this,t),l=Object.assign({},a,this._size),c=Ti(e,t,l),d=Oi(t,l,c,e);(i._to!==d.x||o._to!==d.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=r.width,this.height=r.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},o={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const a=nt(e.padding),r=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&r&&(t.save(),t.globalAlpha=n,this.drawBackground(o,t,i,e),jo(t,e.textDirection),o.y+=a.top,this.drawTitle(o,t,e),this.drawBody(o,t,e),this.drawFooter(o,t,e),To(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const n=this._active,i=t.map(({datasetIndex:r,index:l})=>{const c=this.chart.getDatasetMeta(r);if(!c)throw new Error("Cannot find a dataset at index "+r);return{datasetIndex:r,element:c.data[l],index:l}}),o=!as(n,i),a=this._positionChanged(i,e);(o||a)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,n=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,o=this._active||[],a=this._getActiveElements(t,o,e,n),r=this._positionChanged(a,t),l=e||!as(a,o)||r;return l&&(this._active=a,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),l}_getActiveElements(t,e,n,i){const o=this.options;if(t.type==="mouseout")return[];if(!i)return e.filter(r=>this.chart.data.datasets[r.datasetIndex]&&this.chart.getDatasetMeta(r.datasetIndex).controller.getParsed(r.index)!==void 0);const a=this.chart.getElementsAtEventForMode(t,o.mode,o,n);return o.reverse&&a.reverse(),a}_positionChanged(t,e){const{caretX:n,caretY:i,options:o}=this,a=be[o.position].call(this,t,e);return a!==!1&&(n!==a.x||i!==a.y)}}A(nn,"positioners",be);var ra={id:"tooltip",_element:nn,positioners:be,afterInit(s,t,e){e&&(s.tooltip=new nn({chart:s,options:e}))},beforeUpdate(s,t,e){s.tooltip&&s.tooltip.initialize(e)},reset(s,t,e){s.tooltip&&s.tooltip.initialize(e)},afterDraw(s){const t=s.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(s.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(s.ctx),s.notifyPlugins("afterTooltipDraw",e)}},afterEvent(s,t){if(s.tooltip){const e=t.replay;s.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(s,t)=>t.bodyFont.size,boxWidth:(s,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:aa},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:s=>s!=="filter"&&s!=="itemSort"&&s!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const xh=(s,t,e,n)=>(typeof t=="string"?(e=s.push(t)-1,n.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function yh(s,t,e,n){const i=s.indexOf(t);if(i===-1)return xh(s,t,e,n);const o=s.lastIndexOf(t);return i!==o?e:i}const _h=(s,t)=>s===null?null:lt(Math.round(s),0,t);function Li(s){const t=this.getLabels();return s>=0&&s<t.length?t[s]:s}class on extends Qt{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const n=this.getLabels();for(const{index:i,label:o}of e)n[i]===o&&n.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(H(t))return null;const n=this.getLabels();return e=isFinite(e)&&n[e]===t?e:yh(n,t,I(e,t),this._addedLabels),_h(e,n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(n=0),e||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const t=this.min,e=this.max,n=this.options.offset,i=[];let o=this.getLabels();o=t===0&&e===o.length-1?o:o.slice(t,e+1),this._valueRange=Math.max(o.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let a=t;a<=e;a++)i.push({value:a});return i}getLabelForValue(t){return Li.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}A(on,"id","category"),A(on,"defaults",{ticks:{callback:Li}});function vh(s,t){const e=[],{bounds:i,step:o,min:a,max:r,precision:l,count:c,maxTicks:d,maxDigits:h,includeBounds:u}=s,g=o||1,p=d-1,{min:m,max:b}=t,x=!H(a),y=!H(r),_=!H(c),w=(b-m)/(h+1);let v=Tn((b-m)/p/g)*g,S,C,M,P;if(v<1e-14&&!x&&!y)return[{value:m},{value:b}];P=Math.ceil(b/v)-Math.floor(m/v),P>p&&(v=Tn(P*v/p/g)*g),H(l)||(S=Math.pow(10,l),v=Math.ceil(v*S)/S),i==="ticks"?(C=Math.floor(m/v)*v,M=Math.ceil(b/v)*v):(C=m,M=b),x&&y&&o&&kr((r-a)/o,v/1e3)?(P=Math.round(Math.min((r-a)/v,d)),v=(r-a)/P,C=a,M=r):_?(C=x?a:C,M=y?r:M,P=c-1,v=(M-C)/P):(P=(M-C)/v,ye(P,Math.round(P),v/1e3)?P=Math.round(P):P=Math.ceil(P));const O=Math.max(On(v),On(C));S=Math.pow(10,H(l)?O:l),C=Math.round(C*S)/S,M=Math.round(M*S)/S;let T=0;for(x&&(u&&C!==a?(e.push({value:a}),C<a&&T++,ye(Math.round((C+T*v)*S)/S,a,Fi(a,w,s))&&T++):C<a&&T++);T<P;++T){const k=Math.round((C+T*v)*S)/S;if(y&&k>r)break;e.push({value:k})}return y&&u&&M!==r?e.length&&ye(e[e.length-1].value,r,Fi(r,w,s))?e[e.length-1].value=r:e.push({value:r}):(!y||M===r)&&e.push({value:M}),e}function Fi(s,t,{horizontal:e,minRotation:n}){const i=mt(n),o=(e?Math.sin(i):Math.cos(i))||.001,a=.75*t*(""+s).length;return Math.min(t/o,a)}class gs extends Qt{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return H(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:i,max:o}=this;const a=l=>i=e?i:l,r=l=>o=n?o:l;if(t){const l=vt(i),c=vt(o);l<0&&c<0?r(0):l>0&&c>0&&a(0)}if(i===o){let l=o===0?1:Math.abs(o*.05);r(o+l),t||a(i-l)}this.min=i,this.max=o}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:n}=t,i;return n?(i=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),e=e||11),e&&(i=Math.min(e,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i={maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},o=this._range||this,a=vh(i,o);return t.bounds==="ticks"&&bo(a,this,"value"),t.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const t=this.ticks;let e=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const i=(n-e)/Math.max(t.length-1,1)/2;e-=i,n+=i}this._startValue=e,this._endValue=n,this._valueRange=n-e}getLabelForValue(t){return Re(t,this.chart.options.locale,this.options.ticks.format)}}class an extends gs{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=G(t)?t:0,this.max=G(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,n=mt(this.options.ticks.minRotation),i=(t?Math.sin(n):Math.cos(n))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,o.lineHeight/i))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}A(an,"id","linear"),A(an,"defaults",{ticks:{callback:xs.formatters.numeric}});const Pe=s=>Math.floor(jt(s)),Yt=(s,t)=>Math.pow(10,Pe(s)+t);function Ei(s){return s/Math.pow(10,Pe(s))===1}function Bi(s,t,e){const n=Math.pow(10,e),i=Math.floor(s/n);return Math.ceil(t/n)-i}function wh(s,t){const e=t-s;let n=Pe(e);for(;Bi(s,t,n)>10;)n++;for(;Bi(s,t,n)<10;)n--;return Math.min(n,Pe(s))}function kh(s,{min:t,max:e}){t=dt(s.min,t);const n=[],i=Pe(t);let o=wh(t,e),a=o<0?Math.pow(10,Math.abs(o)):1;const r=Math.pow(10,o),l=i>o?Math.pow(10,i):0,c=Math.round((t-l)*a)/a,d=Math.floor((t-l)/r/10)*r*10;let h=Math.floor((c-d)/Math.pow(10,o)),u=dt(s.min,Math.round((l+d+h*Math.pow(10,o))*a)/a);for(;u<e;)n.push({value:u,major:Ei(u),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(o++,h=2,a=o>=0?1:a),u=Math.round((l+d+h*Math.pow(10,o))*a)/a;const g=dt(s.max,u);return n.push({value:g,major:Ei(g),significand:h}),n}class $i extends Qt{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const n=gs.prototype.parse.apply(this,[t,e]);if(n===0){this._zero=!0;return}return G(n)&&n>0?n:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=G(t)?Math.max(0,t):null,this.max=G(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!G(this._userMin)&&(this.min=t===Yt(this.min,0)?Yt(this.min,-1):Yt(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let n=this.min,i=this.max;const o=r=>n=t?n:r,a=r=>i=e?i:r;n===i&&(n<=0?(o(1),a(10)):(o(Yt(n,-1)),a(Yt(i,1)))),n<=0&&o(Yt(i,-1)),i<=0&&a(Yt(n,1)),this.min=n,this.max=i}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},n=kh(e,this);return t.bounds==="ticks"&&bo(n,this,"value"),t.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}getLabelForValue(t){return t===void 0?"0":Re(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=jt(t),this._valueRange=jt(this.max)-jt(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(jt(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}A($i,"id","logarithmic"),A($i,"defaults",{ticks:{callback:xs.formatters.logarithmic,major:{enabled:!0}}});function rn(s){const t=s.ticks;if(t.display&&s.display){const e=nt(t.backdropPadding);return I(t.font&&t.font.size,X.font.size)+e.height}return 0}function Sh(s,t,e){return e=U(e)?e:[e],{w:$r(s,t.string,e),h:e.length*t.lineHeight}}function zi(s,t,e,n,i){return s===n||s===i?{start:t-e/2,end:t+e/2}:s<n||s>i?{start:t-e,end:t}:{start:t,end:t+e}}function Mh(s){const t={l:s.left+s._padding.left,r:s.right-s._padding.right,t:s.top+s._padding.top,b:s.bottom-s._padding.bottom},e=Object.assign({},t),n=[],i=[],o=s._pointLabels.length,a=s.options.pointLabels,r=a.centerPointLabels?$/o:0;for(let l=0;l<o;l++){const c=a.setContext(s.getPointLabelContext(l));i[l]=c.padding;const d=s.getPointPosition(l,s.drawingArea+i[l],r),h=Q(c.font),u=Sh(s.ctx,h,s._pointLabels[l]);n[l]=u;const g=st(s.getIndexAngle(l)+r),p=Math.round(un(g)),m=zi(p,d.x,u.w,0,180),b=zi(p,d.y,u.h,90,270);Ch(e,t,g,m,b)}s.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),s._pointLabelItems=Nh(s,n,i)}function Ch(s,t,e,n,i){const o=Math.abs(Math.sin(e)),a=Math.abs(Math.cos(e));let r=0,l=0;n.start<t.l?(r=(t.l-n.start)/o,s.l=Math.min(s.l,t.l-r)):n.end>t.r&&(r=(n.end-t.r)/o,s.r=Math.max(s.r,t.r+r)),i.start<t.t?(l=(t.t-i.start)/a,s.t=Math.min(s.t,t.t-l)):i.end>t.b&&(l=(i.end-t.b)/a,s.b=Math.max(s.b,t.b+l))}function Ah(s,t,e){const n=s.drawingArea,{extra:i,additionalAngle:o,padding:a,size:r}=e,l=s.getPointPosition(t,n+i+a,o),c=Math.round(un(st(l.angle+q))),d=Th(l.y,r.h,c),h=Dh(c),u=jh(l.x,r.w,h);return{visible:!0,x:l.x,y:d,textAlign:h,left:u,top:d,right:u+r.w,bottom:d+r.h}}function Ph(s,t){if(!t)return!0;const{left:e,top:n,right:i,bottom:o}=s;return!(Pt({x:e,y:n},t)||Pt({x:e,y:o},t)||Pt({x:i,y:n},t)||Pt({x:i,y:o},t))}function Nh(s,t,e){const n=[],i=s._pointLabels.length,o=s.options,{centerPointLabels:a,display:r}=o.pointLabels,l={extra:rn(o)/2,additionalAngle:a?$/i:0};let c;for(let d=0;d<i;d++){l.padding=e[d],l.size=t[d];const h=Ah(s,d,l);n.push(h),r==="auto"&&(h.visible=Ph(h,c),h.visible&&(c=h))}return n}function Dh(s){return s===0||s===180?"center":s<180?"left":"right"}function jh(s,t,e){return e==="right"?s-=t:e==="center"&&(s-=t/2),s}function Th(s,t,e){return e===90||e===270?s-=t/2:(e>270||e<90)&&(s-=t),s}function Oh(s,t,e){const{left:n,top:i,right:o,bottom:a}=e,{backdropColor:r}=t;if(!H(r)){const l=Xt(t.borderRadius),c=nt(t.backdropPadding);s.fillStyle=r;const d=n-c.left,h=i-c.top,u=o-n+c.width,g=a-i+c.height;Object.values(l).some(p=>p!==0)?(s.beginPath(),Ce(s,{x:d,y:h,w:u,h:g,radius:l}),s.fill()):s.fillRect(d,h,u,g)}}function Ih(s,t){const{ctx:e,options:{pointLabels:n}}=s;for(let i=t-1;i>=0;i--){const o=s._pointLabelItems[i];if(!o.visible)continue;const a=n.setContext(s.getPointLabelContext(i));Oh(e,a,o);const r=Q(a.font),{x:l,y:c,textAlign:d}=o;Zt(e,s._pointLabels[i],l,c+r.lineHeight/2,r,{color:a.color,textAlign:d,textBaseline:"middle"})}}function la(s,t,e,n){const{ctx:i}=s;if(e)i.arc(s.xCenter,s.yCenter,t,0,K);else{let o=s.getPointPosition(0,t);i.moveTo(o.x,o.y);for(let a=1;a<n;a++)o=s.getPointPosition(a,t),i.lineTo(o.x,o.y)}}function Rh(s,t,e,n,i){const o=s.ctx,a=t.circular,{color:r,lineWidth:l}=t;!a&&!n||!r||!l||e<0||(o.save(),o.strokeStyle=r,o.lineWidth=l,o.setLineDash(i.dash||[]),o.lineDashOffset=i.dashOffset,o.beginPath(),la(s,e,a,n),o.closePath(),o.stroke(),o.restore())}function Lh(s,t,e){return Bt(s,{label:e,index:t,type:"pointLabel"})}class qe extends gs{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=nt(rn(this.options)/2),e=this.width=this.maxWidth-t.width,n=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+n/2+t.top),this.drawingArea=Math.floor(Math.min(e,n)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=G(t)&&!isNaN(t)?t:0,this.max=G(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/rn(this.options))}generateTickLabels(t){gs.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,n)=>{const i=Y(this.options.pointLabels.callback,[e,n],this);return i||i===0?i:""}).filter((e,n)=>this.chart.getDataVisibility(n))}fit(){const t=this.options;t.display&&t.pointLabels.display?Mh(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,n,i){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((n-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,n,i))}getIndexAngle(t){const e=K/(this._pointLabels.length||1),n=this.options.startAngle||0;return st(t*e+mt(n))}getDistanceFromCenterForValue(t){if(H(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(H(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const n=e[t];return Lh(this.getContext(),t,n)}}getPointPosition(t,e,n=0){const i=this.getIndexAngle(t)-q+n;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter,angle:i}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:n,right:i,bottom:o}=this._pointLabelItems[t];return{left:e,top:n,right:i,bottom:o}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const n=this.ctx;n.save(),n.beginPath(),la(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),n.closePath(),n.fillStyle=t,n.fill(),n.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:n,grid:i,border:o}=e,a=this._pointLabels.length;let r,l,c;if(e.pointLabels.display&&Ih(this,a),i.display&&this.ticks.forEach((d,h)=>{if(h!==0||h===0&&this.min<0){l=this.getDistanceFromCenterForValue(d.value);const u=this.getContext(h),g=i.setContext(u),p=o.setContext(u);Rh(this,g,l,a,p)}}),n.display){for(t.save(),r=a-1;r>=0;r--){const d=n.setContext(this.getPointLabelContext(r)),{color:h,lineWidth:u}=d;!u||!h||(t.lineWidth=u,t.strokeStyle=h,t.setLineDash(d.borderDash),t.lineDashOffset=d.borderDashOffset,l=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),c=this.getPointPosition(r,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,n=e.ticks;if(!n.display)return;const i=this.getIndexAngle(0);let o,a;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(i),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((r,l)=>{if(l===0&&this.min>=0&&!e.reverse)return;const c=n.setContext(this.getContext(l)),d=Q(c.font);if(o=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=d.string,a=t.measureText(r.label).width,t.fillStyle=c.backdropColor;const h=nt(c.backdropPadding);t.fillRect(-a/2-h.left,-o-d.size/2-h.top,a+h.width,d.size+h.height)}Zt(t,r.label,0,-o,d,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),t.restore()}drawTitle(){}}A(qe,"id","radialLinear"),A(qe,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:xs.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),A(qe,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),A(qe,"descriptors",{angleLines:{_fallback:"grid"}});const ks={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},rt=Object.keys(ks);function Hi(s,t){return s-t}function Wi(s,t){if(H(t))return null;const e=s._adapter,{parser:n,round:i,isoWeekday:o}=s._parseOpts;let a=t;return typeof n=="function"&&(a=n(a)),G(a)||(a=typeof n=="string"?e.parse(a,n):e.parse(a)),a===null?null:(i&&(a=i==="week"&&(cs(o)||o===!0)?e.startOf(a,"isoWeek",o):e.startOf(a,i)),+a)}function Vi(s,t,e,n){const i=rt.length;for(let o=rt.indexOf(s);o<i-1;++o){const a=ks[rt[o]],r=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((e-t)/(r*a.size))<=n)return rt[o]}return rt[i-1]}function Fh(s,t,e,n,i){for(let o=rt.length-1;o>=rt.indexOf(e);o--){const a=rt[o];if(ks[a].common&&s._adapter.diff(i,n,a)>=t-1)return a}return rt[e?rt.indexOf(e):0]}function Eh(s){for(let t=rt.indexOf(s)+1,e=rt.length;t<e;++t)if(ks[rt[t]].common)return rt[t]}function Yi(s,t,e){if(!e)s[t]=!0;else if(e.length){const{lo:n,hi:i}=fn(e,t),o=e[n]>=t?e[n]:e[i];s[o]=!0}}function Bh(s,t,e,n){const i=s._adapter,o=+i.startOf(t[0].value,n),a=t[t.length-1].value;let r,l;for(r=o;r<=a;r=+i.add(r,1,n))l=e[r],l>=0&&(t[l].major=!0);return t}function Ui(s,t,e){const n=[],i={},o=t.length;let a,r;for(a=0;a<o;++a)r=t[a],i[r]=a,n.push({value:r,major:!1});return o===0||!e?n:Bh(s,n,i,e)}class ps extends Qt{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const n=t.time||(t.time={}),i=this._adapter=new nc._date(t.adapters.date);i.init(e),xe(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:Wi(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,n=t.time.unit||"day";let{min:i,max:o,minDefined:a,maxDefined:r}=this.getUserBounds();function l(c){!a&&!isNaN(c.min)&&(i=Math.min(i,c.min)),!r&&!isNaN(c.max)&&(o=Math.max(o,c.max))}(!a||!r)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=G(i)&&!isNaN(i)?i:+e.startOf(Date.now(),n),o=G(o)&&!isNaN(o)?o:+e.endOf(Date.now(),n)+1,this.min=Math.min(i,o-1),this.max=Math.max(i+1,o)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],n=t[t.length-1]),{min:e,max:n}}buildTicks(){const t=this.options,e=t.time,n=t.ticks,i=n.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const o=this.min,a=this.max,r=Ar(i,o,a);return this._unit=e.unit||(n.autoSkip?Vi(e.minUnit,this.min,this.max,this._getLabelCapacity(o)):Fh(this,r.length,e.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:Eh(this._unit),this.initOffsets(i),t.reverse&&r.reverse(),Ui(this,r,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,n=0,i,o;this.options.offset&&t.length&&(i=this.getDecimalForValue(t[0]),t.length===1?e=1-i:e=(this.getDecimalForValue(t[1])-i)/2,o=this.getDecimalForValue(t[t.length-1]),t.length===1?n=o:n=(o-this.getDecimalForValue(t[t.length-2]))/2);const a=t.length<3?.5:.25;e=lt(e,0,a),n=lt(n,0,a),this._offsets={start:e,end:n,factor:1/(e+1+n)}}_generate(){const t=this._adapter,e=this.min,n=this.max,i=this.options,o=i.time,a=o.unit||Vi(o.minUnit,e,n,this._getLabelCapacity(e)),r=I(i.ticks.stepSize,1),l=a==="week"?o.isoWeekday:!1,c=cs(l)||l===!0,d={};let h=e,u,g;if(c&&(h=+t.startOf(h,"isoWeek",l)),h=+t.startOf(h,c?"day":a),t.diff(n,e,a)>1e5*r)throw new Error(e+" and "+n+" are too far apart with stepSize of "+r+" "+a);const p=i.ticks.source==="data"&&this.getDataTimestamps();for(u=h,g=0;u<n;u=+t.add(u,r,a),g++)Yi(d,u,p);return(u===n||i.bounds==="ticks"||g===1)&&Yi(d,u,p),Object.keys(d).sort(Hi).map(m=>+m)}getLabelForValue(t){const e=this._adapter,n=this.options.time;return n.tooltipFormat?e.format(t,n.tooltipFormat):e.format(t,n.displayFormats.datetime)}format(t,e){const i=this.options.time.displayFormats,o=this._unit,a=e||i[o];return this._adapter.format(t,a)}_tickFormatFunction(t,e,n,i){const o=this.options,a=o.ticks.callback;if(a)return Y(a,[t,e,n],this);const r=o.time.displayFormats,l=this._unit,c=this._majorUnit,d=l&&r[l],h=c&&r[c],u=n[e],g=c&&h&&u&&u.major;return this._adapter.format(t,i||(g?h:d))}generateTickLabels(t){let e,n,i;for(e=0,n=t.length;e<n;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+n)*e.factor)}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,n=this.ctx.measureText(t).width,i=mt(this.isHorizontal()?e.maxRotation:e.minRotation),o=Math.cos(i),a=Math.sin(i),r=this._resolveTickFontOptions(0).size;return{w:n*o+r*a,h:n*a+r*o}}_getLabelCapacity(t){const e=this.options.time,n=e.displayFormats,i=n[e.unit]||n.millisecond,o=this._tickFormatFunction(t,0,Ui(this,[t],this._majorUnit),i),a=this._getLabelSize(o),r=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return r>0?r:1}getDataTimestamps(){let t=this._cache.data||[],e,n;if(t.length)return t;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(e=0,n=i.length;e<n;++e)t=t.concat(i[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,n;if(t.length)return t;const i=this.getLabels();for(e=0,n=i.length;e<n;++e)t.push(Wi(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return _o(t.sort(Hi))}}A(ps,"id","time"),A(ps,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Je(s,t,e){let n=0,i=s.length-1,o,a,r,l;e?(t>=s[n].pos&&t<=s[i].pos&&({lo:n,hi:i}=Xs(s,"pos",t)),{pos:o,time:r}=s[n],{pos:a,time:l}=s[i]):(t>=s[n].time&&t<=s[i].time&&({lo:n,hi:i}=Xs(s,"time",t)),{time:o,pos:r}=s[n],{time:a,pos:l}=s[i]);const c=a-o;return c?r+(l-r)*(t-o)/c:r}class Ki extends ps{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=Je(e,this.min),this._tableRange=Je(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:n}=this,i=[],o=[];let a,r,l,c,d;for(a=0,r=t.length;a<r;++a)c=t[a],c>=e&&c<=n&&i.push(c);if(i.length<2)return[{time:e,pos:0},{time:n,pos:1}];for(a=0,r=i.length;a<r;++a)d=i[a+1],l=i[a-1],c=i[a],Math.round((d+l)/2)!==c&&o.push({time:c,pos:a/(r-1)});return o}_generate(){const t=this.min,e=this.max;let n=super.getDataTimestamps();return(!n.includes(t)||!n.length)&&n.splice(0,0,t),(!n.includes(e)||n.length===1)&&n.push(e),n.sort((i,o)=>i-o)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),n=this.getLabelTimestamps();return e.length&&n.length?t=this.normalize(e.concat(n)):t=e.length?e:n,t=this._cache.all=t,t}getDecimalForValue(t){return(Je(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return Je(this._table,n*this._tableRange+this._minPos,!0)}}A(Ki,"id","timeseries"),A(Ki,"defaults",ps.defaults);const ca="label";function Xi(s,t){typeof s=="function"?s(t):s&&(s.current=t)}function $h(s,t){const e=s.options;e&&t&&Object.assign(e,t)}function da(s,t){s.labels=t}function ha(s,t,e=ca){const n=[];s.datasets=t.map(i=>{const o=s.datasets.find(a=>a[e]===i[e]);return!o||!i.data||n.includes(o)?{...i}:(n.push(o),Object.assign(o,i),o)})}function zh(s,t=ca){const e={labels:[],datasets:[]};return da(e,s.labels),ha(e,s.datasets,t),e}function Hh(s,t){const{height:e=150,width:n=300,redraw:i=!1,datasetIdKey:o,type:a,data:r,options:l,plugins:c=[],fallbackContent:d,updateMode:h,...u}=s,g=z.useRef(null),p=z.useRef(null),m=()=>{g.current&&(p.current=new Fe(g.current,{type:a,data:zh(r,o),options:l&&{...l},plugins:c}),Xi(t,p.current))},b=()=>{Xi(t,null),p.current&&(p.current.destroy(),p.current=null)};return z.useEffect(()=>{!i&&p.current&&l&&$h(p.current,l)},[i,l]),z.useEffect(()=>{!i&&p.current&&da(p.current.config.data,r.labels)},[i,r.labels]),z.useEffect(()=>{!i&&p.current&&r.datasets&&ha(p.current.config.data,r.datasets,o)},[i,r.datasets]),z.useEffect(()=>{p.current&&(i?(b(),setTimeout(m)):p.current.update(h))},[i,l,r.labels,r.datasets,h]),z.useEffect(()=>{p.current&&(b(),setTimeout(m))},[a]),z.useEffect(()=>(m(),()=>b()),[]),f.jsx("canvas",{ref:g,role:"img",height:e,width:n,...u,children:d})}const Wh=z.forwardRef(Hh);function ua(s,t){return Fe.register(t),z.forwardRef((e,n)=>f.jsx(Wh,{...e,ref:n,type:s}))}const Vh=ua("bar",Qe),fa=ua("pie",Js);Fe.register(me,ra,ia,ta);const ae=(s=0)=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s),Yh=(s=[])=>{const t={amounts:{},categories:{}},e={amounts:{},categories:{}};s.forEach(i=>{const o=Number(i.amount??0),a=o<0,r=Math.abs(o),l=i.category||"uncategorized";a?(t.amounts[l]=(t.amounts[l]||0)+r,t.categories[l]=(t.categories[l]||0)+1):(e.amounts[l]=(e.amounts[l]||0)+r,e.categories[l]=(e.categories[l]||0)+1)});const n=(i,o)=>{const a=Object.values(i).reduce((d,h)=>d+h,0),r=Object.values(o).reduce((d,h)=>d+h,0),l={},c={};return Object.entries(i).forEach(([d,h])=>{l[d]={total:h,percentage:a>0?Math.round(h/a*1e4)/100:0}}),Object.entries(o).forEach(([d,h])=>{c[d]={total:h,percentage:r>0?Math.round(h/r*1e4)/100:0}}),{byAmount:l,byCategory:c,totalAmount:a,totalTransactions:r}};return{expenses:n(t.amounts,t.categories),incomes:n(e.amounts,e.categories)}},Uh=({summary:s,title:t})=>{const e=Object.keys(s||{});if(!e.length)return f.jsxs("div",{className:"text-sm text-gray-500",children:["No ",t.toLowerCase()," data available."]});const n=e.map(l=>s[l].total),i=e.map(l=>`${l} (${s[l].percentage}%)`),o=["#4F46E5","#EF4444","#10B981","#F59E0B","#6366F1","#EC4899","#8B5CF6","#F97316","#14B8A6"],a={labels:i,datasets:[{data:n,backgroundColor:o.slice(0,e.length),borderWidth:1}]},r={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:l=>`${ae(l.raw)} • ${s[e[l.dataIndex]].percentage}%`}}},layout:{padding:8}};return f.jsxs("div",{className:"w-full",children:[f.jsx("h4",{className:"text-md font-semibold mb-2",children:t}),f.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[f.jsx("div",{className:"w-full md:w-1/2 max-w-xs",style:{minHeight:220},children:f.jsx(fa,{data:a,options:r})}),f.jsx("div",{className:"w-full md:w-1/2",children:f.jsx("div",{className:"flex flex-wrap gap-2 items-start",children:e.map((l,c)=>f.jsxs("div",{className:"flex items-center gap-2 min-w-[140px]",children:[f.jsx("span",{className:"inline-block rounded-sm",style:{width:12,height:12,backgroundColor:o[c%o.length]}}),f.jsxs("div",{className:"text-sm",children:[f.jsx("div",{className:"font-medium capitalize truncate",style:{maxWidth:160},children:l}),f.jsxs("div",{className:"text-xs text-gray-500",children:[ae(s[l].total)," •"," ",s[l].percentage,"%"]})]})]},l))})})]})]})},Gi=({summary:s,title:t})=>{const e=Object.keys(s||{});if(!e.length)return f.jsxs("div",{className:"text-sm text-gray-500",children:["No ",t.toLowerCase()," data available."]});const n=e.map(l=>s[l].percentage),i=e.map(l=>`${l} (${s[l].percentage}%)`),o=["#4F46E5","#EF4444","#10B981","#F59E0B","#6366F1","#EC4899","#8B5CF6","#F97316","#14B8A6"],a={labels:i,datasets:[{data:n,backgroundColor:o.slice(0,e.length),borderWidth:1}]},r={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:l=>`${l.raw}%`}}},layout:{padding:8}};return f.jsxs("div",{className:"w-full",children:[f.jsxs("h4",{className:"text-md font-semibold mb-2",children:[t," Distribution"]}),f.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[f.jsx("div",{className:"w-full md:w-1/2 max-w-xs",style:{minHeight:220},children:f.jsx(fa,{data:a,options:r})}),f.jsx("div",{className:"w-full md:w-1/2",children:f.jsx("div",{className:"flex flex-wrap gap-2 items-start",children:e.map((l,c)=>f.jsxs("div",{className:"flex items-center gap-2 min-w-[140px]",children:[f.jsx("span",{className:"inline-block rounded-sm",style:{width:12,height:12,backgroundColor:o[c%o.length]}}),f.jsxs("div",{className:"text-sm",children:[f.jsx("div",{className:"font-medium capitalize truncate",style:{maxWidth:160},children:l}),f.jsxs("div",{className:"text-xs text-gray-500",children:[s[l].percentage,"%"]})]})]},l))})})]})]})},Kh=({summary:s={},top_category:t,insight_text:e})=>{const n=Object.entries(s||{});return n.length===0?f.jsx("div",{className:"text-sm text-gray-500",children:"No expense summary available."}):f.jsxs("div",{className:"rounded-lg border bg-white p-4",children:[f.jsx("h4",{className:"text-md font-semibold",children:"Summary"}),f.jsx("ul",{className:"mt-2 space-y-2",children:n.map(([i,o])=>f.jsxs("li",{className:"flex justify-between",children:[f.jsx("span",{className:"capitalize",children:i}),f.jsxs("span",{children:[ae(o.total)," • ",o.percentage,"%"]})]},i))}),e&&f.jsx("p",{className:"mt-3 text-sm text-gray-600",children:e})]})},Xh=({transactions:s=[]})=>!s||s.length===0?f.jsx("div",{className:"text-sm text-gray-500",children:"No transactions available."}):f.jsxs("div",{className:"rounded-lg border bg-white shadow mb-6 w-full overflow-x-auto",children:[f.jsx("div",{className:"p-4 border-b",children:f.jsx("h4",{className:"text-md font-semibold text-gray-900",children:"Transactions"})}),f.jsx("div",{className:"p-4 overflow-x-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-2 text-left text-gray-700",children:"Date"}),f.jsx("th",{className:"px-4 py-2 text-left text-gray-700",children:"Description"}),f.jsx("th",{className:"px-4 py-2 text-right text-gray-700",children:"Amount"}),f.jsx("th",{className:"px-4 py-2 text-left text-gray-700",children:"Category"}),f.jsx("th",{className:"px-4 py-2 text-left text-gray-700",children:"Currency"})]})}),f.jsx("tbody",{className:"divide-y bg-white",children:s.map((t,e)=>{const n=Number(t.amount??0),i=n<0?"text-red-600":"text-green-600",o=t.category||"uncategorized";return f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-2 text-gray-800",children:t.date||"N/A"}),f.jsx("td",{className:"px-4 py-2 text-gray-800",children:t.description||t.merchant||"-"}),f.jsx("td",{className:`px-4 py-2 text-right font-medium ${i}`,children:ae(Math.abs(n))}),f.jsx("td",{className:"px-4 py-2 font-medium text-gray-700 capitalize",children:o}),f.jsx("td",{className:"px-4 py-2 text-gray-800",children:t.currency||"PHP"})]},e)})})]})})]}),Ss=({result:s={}})=>{if(!s)return null;s.summary||s.data&&s.data.summary;const t=s.transactions||s.data&&s.data.transactions||[],{expenses:e,incomes:n}=Yh(t),i={"Total Deposits":{total:n.totalAmount,percentage:Math.round(n.totalAmount/(n.totalAmount+e.totalAmount)*100)},"Total Withdrawals":{total:e.totalAmount,percentage:Math.round(e.totalAmount/(n.totalAmount+e.totalAmount)*100)}};return f.jsxs("div",{className:"space-y-6 w-full max-w-full",role:"region","aria-label":"Expense analysis canvas",children:[f.jsx("div",{className:"w-full",children:f.jsx(Xh,{transactions:t})}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 w-full",children:[f.jsx("div",{className:"col-span-2 bg-white rounded-lg shadow p-4",children:f.jsx("div",{className:"grid grid-cols-1 gap-6",children:f.jsx(Uh,{summary:i,title:"Overall Cash Flow"})})}),f.jsx("div",{children:f.jsx(Kh,{summary:i,insight_text:`Total deposits: ${ae(n.totalAmount)}, Total withdrawals: ${ae(e.totalAmount)}`})})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:f.jsx(Gi,{summary:e.byCategory,title:"Expense Categories"})}),f.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:f.jsx(Gi,{summary:n.byCategory,title:"Income Categories"})})]})]})};Fe.register(on,an,is,Ot,ns,dh,ra,ia,ta,nh);const kt=(s=0)=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(s),qi=s=>new Date(s).toLocaleDateString("en-PH",{month:"short",day:"numeric"}),Hs=s=>{if(!s&&s!==0)return null;const t=String(s).trim(),e=d=>{const h=new Date(d);return isNaN(h.getTime())?null:h};let n=e(t);if(n)return n;const i=t.match(/^(\d{4})-(\d{1,2})-(\d{1,2})$/);if(i){const[d,h,u,g]=i,p=e(`${h}-${String(g).padStart(2,"0")}-${String(u).padStart(2,"0")}`);if(p)return p;const m=parseInt(g,10)-1,b=parseInt(u,10),x=new Date(Number(h),m,b);if(!isNaN(x.getTime()))return x}const o=t.match(/^(\d{1,2})\/(\d{1,2})$/);if(o){const d=new Date().getFullYear(),h=parseInt(o[1],10)-1,u=parseInt(o[2],10),g=new Date(d,h,u);if(!isNaN(g.getTime()))return g}const a=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(a){const d=parseInt(a[1],10)-1,h=parseInt(a[2],10),u=parseInt(a[3],10),g=new Date(u,d,h);if(!isNaN(g.getTime()))return g}const r=t.match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if(r){const d=parseInt(r[1],10),h=parseInt(r[2],10)-1,u=parseInt(r[3],10),g=new Date(u,h,d);if(!isNaN(g.getTime()))return g}const l=t.split(/[-\/\.]/).map(d=>d.replace(/^0+/,"")||"0");if(l.length===3&&/^\d+$/.test(l.join(""))&&l[0].length===4){const d=parseInt(l[0],10);let h=parseInt(l[1],10),u=parseInt(l[2],10);if(h>12&&u>=1&&u<=12){const p=new Date(d,u-1,h);if(!isNaN(p.getTime()))return p}if(u>12&&h>=1&&h<=12){const p=new Date(d,h-1,u);if(!isNaN(p.getTime()))return p}const g=new Date(d,(parseInt(l[1],10)||1)-1,parseInt(l[2],10)||1);if(!isNaN(g.getTime()))return g}const c=t.replace(/(\d)\.(\d)/g,"$1/$2");return n=e(c),n||(console.warn(`Could not parse date: ${t}`),null)},Gh=s=>{if(!s)return[];const t=Array.isArray(s)?s:s.transactions||s.data||[];if(!Array.isArray(t))return[];const e=[...t].sort((i,o)=>{const a=Hs(i==null?void 0:i.date),r=Hs(o==null?void 0:o.date);return!a&&!r?0:a?r?a-r:-1:1}),n={};return e.forEach(i=>{const o=Hs(i==null?void 0:i.date);if(!o){console.warn("Skipping transaction with invalid date:",i);return}const a=new Date(o);a.setDate(o.getDate()-o.getDay()),a.setHours(0,0,0,0);const r=a.toISOString().split("T")[0];n[r]||(n[r]={week_start:r,income:0,expense:0,net:0,transactions:[]});const l=Number(i.amount)||0;l>=0?n[r].income+=l:n[r].expense+=Math.abs(l),n[r].net+=l,n[r].transactions.push(i)}),Object.values(n)},Ms=({data:s})=>{if(!s)return console.log("No data provided to CashFlowForecast"),null;const t=s.weekly_series||Gh(s);if(console.log("Input data:",s),console.log("Processed weekly series:",t),!(t!=null&&t.length))return console.log("No weekly series data available"),f.jsxs("div",{className:"rounded-lg border bg-white shadow p-6",children:[f.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Weekly Cash Flow"}),f.jsx("p",{className:"text-gray-500",children:"No transactions available for forecast."})]});const e=t.reduce((o,a)=>({total_income:o.total_income+a.income,total_expenses:o.total_expenses+a.expense,total_net:o.total_net+a.net}),{total_income:0,total_expenses:0,total_net:0}),n={labels:t.map(o=>qi(o.week_start)),datasets:[{type:"bar",label:"Income",data:t.map(o=>o.income),backgroundColor:"rgba(16, 185, 129, 0.7)",borderColor:"rgb(16, 185, 129)",borderWidth:1,borderRadius:4,order:2},{type:"bar",label:"Expenses",data:t.map(o=>-o.expense),backgroundColor:"rgba(239, 68, 68, 0.7)",borderColor:"rgb(239, 68, 68)",borderWidth:1,borderRadius:4,order:1},{type:"line",label:"Net Flow",data:t.map(o=>o.net),borderColor:"rgb(79, 70, 229)",backgroundColor:"rgba(79, 70, 229, 0.1)",borderWidth:2,fill:!0,tension:.4,order:0,yAxisID:"net"}]},i={responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top"},tooltip:{callbacks:{label:o=>{const a=o.raw;return`${o.dataset.label}: ${kt(Math.abs(a))}`}}}},scales:{x:{grid:{display:!1},stacked:!0},y:{grid:{color:"rgba(0, 0, 0, 0.1)"},stacked:!0,ticks:{callback:o=>kt(o)}},net:{position:"right",grid:{drawOnChartArea:!1},ticks:{callback:o=>kt(o)}}}};return f.jsxs("div",{className:"space-y-6 w-full max-w-full",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 w-full",children:[f.jsxs("div",{className:"rounded-lg border bg-white shadow p-4",children:[f.jsx("h5",{className:"text-sm font-medium text-gray-500 mb-2",children:"Total Income"}),f.jsx("p",{className:"text-2xl font-bold text-green-600",children:kt(e.total_income)})]}),f.jsxs("div",{className:"rounded-lg border bg-white shadow p-4",children:[f.jsx("h5",{className:"text-sm font-medium text-gray-500 mb-2",children:"Total Expenses"}),f.jsx("p",{className:"text-2xl font-bold text-red-600",children:kt(e.total_expenses)})]}),f.jsxs("div",{className:"rounded-lg border bg-white shadow p-4",children:[f.jsx("h5",{className:"text-sm font-medium text-gray-500 mb-2",children:"Net Balance"}),f.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:kt(e.total_net)})]})]}),f.jsxs("div",{className:"rounded-lg border bg-white shadow p-6",children:[f.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Weekly Cash Flow"}),f.jsx("div",{className:"h-[400px]",children:f.jsx(Vh,{data:n,options:i})})]}),f.jsx("div",{className:"rounded-lg border bg-white shadow overflow-hidden",children:f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Week"}),f.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Income"}),f.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Expenses"}),f.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Net"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(o=>f.jsxs("tr",{children:[f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:qi(o.week_start)}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-green-600",children:kt(o.income)}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-red-600",children:kt(o.expense)}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-indigo-600",children:kt(o.net)})]},o.week_start))})]})})]})},qh=({type:s})=>{const t={success:f.jsx(ja,{className:"w-5 h-5 text-green-600"}),warning:f.jsx(os,{className:"w-5 h-5 text-yellow-600"}),alert:f.jsx(ho,{className:"w-5 h-5 text-red-600"}),info:f.jsx(Ta,{className:"w-5 h-5 text-blue-600"}),tip:f.jsx(Ea,{className:"w-5 h-5 text-purple-600"}),analysis:f.jsx(Ys,{className:"w-5 h-5 text-indigo-600"}),overview:f.jsx(Ys,{className:"w-5 h-5 text-gray-700"})};return t[s]||t.info},Jh=({insight:s})=>{const t={success:"bg-green-50 border-green-200",warning:"bg-yellow-50 border-yellow-200",alert:"bg-red-50 border-red-200",info:"bg-blue-50 border-blue-200",tip:"bg-purple-50 border-purple-200",analysis:"bg-indigo-50 border-indigo-200",overview:"bg-gray-50 border-gray-200"};return f.jsx("div",{className:`p-4 rounded-lg border-2 ${t[s.type]||t.info}`,children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"flex-shrink-0 mt-0.5",children:f.jsx(qh,{type:s.type})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("h4",{className:"font-semibold text-gray-900 mb-1",children:[s.icon," ",s.title]}),f.jsx("p",{className:"text-sm text-gray-700 mb-2",children:s.message}),s.details&&f.jsx("pre",{className:"text-xs text-gray-600 bg-white bg-opacity-50 p-2 rounded whitespace-pre-wrap font-mono mb-2",children:s.details}),s.suggestion&&f.jsx("div",{className:"mt-2 p-2 bg-white bg-opacity-70 rounded",children:f.jsxs("p",{className:"text-xs font-medium text-gray-800",children:["💡 ",f.jsx("span",{className:"font-semibold",children:"Suggestion:"})," ",s.suggestion]})})]})]})})},_t=({insights:s})=>!s||s.length===0?null:f.jsx("div",{className:"mb-6",children:f.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 border-2 border-purple-200 rounded-lg p-6",children:[f.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[f.jsx("span",{className:"text-2xl",children:"🤖"}),"AI-Powered Insights"]}),f.jsx("div",{className:"space-y-3",children:s.map((t,e)=>f.jsx(Jh,{insight:t},e))})]})});class Zh{constructor(){this.insightTemplates={expense_summary:[{threshold:.3,message:(t,e)=>`⚠️ You're spending ${e}% on ${t}. Consider reducing this category to improve savings.`},{threshold:.2,message:(t,e)=>`💡 ${t} accounts for ${e}% of your expenses. This is a significant portion of your budget.`},{threshold:.1,message:(t,e)=>`📊 ${t} represents ${e}% of your spending - within normal range.`}]}}generateExpenseSummaryInsights(t){const e=[];if(!(t!=null&&t.summary))return e;const n=Object.entries(t.summary).sort((r,l)=>l[1].percentage-r[1].percentage),i=n.reduce((r,[l,c])=>r+c.total,0);if(n.length>0){const[r,l]=n[0],c=l.percentage;c>40?e.push({type:"warning",icon:"⚠️",title:"High Concentration Risk",message:`${r} dominates your spending at ${c}%. Diversifying expenses could improve financial flexibility.`,actionable:!0,suggestion:`Try to reduce ${r} spending by 10% next month. This could save you ₱${(l.total*.1).toLocaleString("en-PH")}.`}):c>25&&e.push({type:"info",icon:"💡",title:"Major Expense Category",message:`${r} is your largest expense at ${c}% (₱${l.total.toLocaleString("en-PH")}).`,suggestion:"This is reasonable, but monitoring this category could help optimize your budget."})}const o=n.filter(([r,l])=>l.percentage<5&&l.percentage>0);if(o.length>=3){const r=o.reduce((l,[c,d])=>l+d.total,0);e.push({type:"tip",icon:"💰",title:"Small Expenses Add Up",message:`You have ${o.length} minor expense categories totaling ₱${r.toLocaleString("en-PH")}.`,suggestion:`These "small" expenses represent ${(r/i*100).toFixed(1)}% of your spending. Cutting back here could yield significant savings.`})}const a=n.length;return a>8?e.push({type:"info",icon:"📊",title:"Diverse Spending Pattern",message:`Your expenses are spread across ${a} categories, showing good financial diversity.`,suggestion:"Continue monitoring all categories to maintain balanced spending habits."}):a<4&&e.push({type:"tip",icon:"🎯",title:"Concentrated Spending",message:`Most of your expenses fall into just ${a} categories.`,suggestion:"Consider if this reflects your actual spending or if some transactions need better categorization."}),e.push({type:"analysis",icon:"📈",title:"Spending Breakdown",message:`Total expenses: ₱${i.toLocaleString("en-PH")} across ${a} categories.`,details:n.slice(0,3).map(([r,l])=>`• ${r}: ₱${l.total.toLocaleString("en-PH")} (${l.percentage}%)`).join(`
`)}),e}generateCashFlowInsights(t){const e=[];if(!(t!=null&&t.weekly_series)||t.weekly_series.length===0)return e;const n=t.weekly_series,i=n.reduce((h,u)=>h+(u.income||0),0),o=n.reduce((h,u)=>h+(u.expense||0),0),a=i-o,r=i>0?a/i*100:0;r>20?e.push({type:"success",icon:"🎉",title:"Excellent Savings Rate",message:`You're saving ${r.toFixed(1)}% of your income - well above the recommended 20% benchmark!`,suggestion:`Consider investing ₱${(a*.5).toLocaleString("en-PH")} of your surplus into long-term savings or investments.`}):r>10?e.push({type:"success",icon:"✅",title:"Good Savings Habit",message:`Your ${r.toFixed(1)}% savings rate is on track. Keep it up!`,suggestion:"Try to increase your savings rate to 20% for optimal financial health."}):r>0?e.push({type:"warning",icon:"⚠️",title:"Low Savings Rate",message:`You're only saving ${r.toFixed(1)}% of your income. The recommended rate is 20%.`,suggestion:`Identify areas to cut expenses by ${(20-r).toFixed(1)}% to reach the 20% savings goal.`}):e.push({type:"alert",icon:"🚨",title:"Negative Cash Flow",message:`You're spending ₱${Math.abs(a).toLocaleString("en-PH")} more than you earn.`,suggestion:"Urgent action needed: Review expenses immediately and create a budget to avoid debt accumulation."});const l=n.map(h=>h.net),c=l.reduce((h,u)=>h+u,0)/l.length,d=Math.sqrt(l.reduce((h,u)=>h+Math.pow(u-c,2),0)/l.length);return d>c*.5&&e.push({type:"tip",icon:"📉",title:"Irregular Cash Flow",message:`Your weekly cash flow varies significantly (σ = ₱${d.toFixed(2)}).`,suggestion:"Build an emergency fund of 3-6 months expenses to handle income fluctuations."}),e.push({type:"analysis",icon:"💰",title:"Cash Flow Summary",message:`Income: ₱${i.toLocaleString("en-PH")} | Expenses: ₱${o.toLocaleString("en-PH")} | Net: ₱${a.toLocaleString("en-PH")}`,details:`Average weekly surplus: ₱${(a/n.length).toLocaleString("en-PH")}`}),e}generateFlaggedTransactionsInsights(t){const e=[];if(!(t!=null&&t.flagged)||t.flagged.length===0)return e.push({type:"success",icon:"✅",title:"No Unusual Activity",message:"All transactions appear normal. Great financial consistency!",suggestion:"Continue monitoring your spending patterns to maintain this stability."}),e;const n=t.flagged,i=n.filter(c=>c.severity==="high").length,o=n.filter(c=>c.severity==="medium").length;i>0&&e.push({type:"alert",icon:"🚨",title:"High-Risk Transactions Detected",message:`${i} transaction(s) flagged as high risk.`,suggestion:"Review these immediately to ensure they are legitimate and not fraudulent activity."}),o>0&&e.push({type:"warning",icon:"⚠️",title:"Unusual Spending Patterns",message:`${o} transaction(s) deviate from your normal spending habits.`,suggestion:"Verify these transactions and consider if they represent one-time events or new spending patterns."});const a={};n.forEach(c=>{(c.reasons||[c.reason]).forEach(d=>{a[d]=(a[d]||0)+1})});const r=Object.entries(a).sort((c,d)=>d[1]-c[1])[0];r&&e.push({type:"info",icon:"💡",title:"Primary Flag Reason",message:`Most flags are due to: "${r[0]}" (${r[1]} occurrences)`,suggestion:"Understanding why transactions are flagged helps you adjust spending patterns or budgets accordingly."});const l=n.reduce((c,d)=>c+Math.abs(d.amount||0),0);return e.push({type:"analysis",icon:"📊",title:"Flagged Transactions Impact",message:`Total flagged amount: ₱${l.toLocaleString("en-PH")}`,details:`This represents ${n.length} transaction(s) requiring your attention.`}),e}generateWeeklyReportInsights(t){const e=[];if(!(t!=null&&t.summary))return e;const{total_income:n,total_expenses:i,net:o,avg_daily_spend:a}=t.summary,r=n/7;if(a>r){const c=a-r;e.push({type:"warning",icon:"⚠️",title:"Overspending Alert",message:`Your daily spending (₱${a.toLocaleString("en-PH")}) exceeds your daily budget (₱${r.toLocaleString("en-PH")}) by ₱${c.toLocaleString("en-PH")}.`,suggestion:`Reduce daily expenses by ₱${c.toLocaleString("en-PH")} to stay within budget.`})}else{const c=r-a;e.push({type:"success",icon:"✅",title:"Within Budget",message:`You're spending ₱${c.toLocaleString("en-PH")} less than your daily budget. Well done!`,suggestion:`Consider saving or investing this ₱${(c*7).toLocaleString("en-PH")} weekly surplus.`})}o>0?e.push({type:"success",icon:"💰",title:"Positive Weekly Balance",message:`You ended the week with a surplus of ₱${o.toLocaleString("en-PH")}.`,suggestion:`Great job! This weekly surplus compounds to ₱${(o*52).toLocaleString("en-PH")} annually if maintained.`}):e.push({type:"alert",icon:"🚨",title:"Weekly Deficit",message:`You spent ₱${Math.abs(o).toLocaleString("en-PH")} more than you earned this week.`,suggestion:`Review your expenses to identify areas for cost reduction. This deficit rate could lead to ₱${(Math.abs(o)*52).toLocaleString("en-PH")} annual shortfall.`});const l=n>0?i/n*100:0;return e.push({type:"analysis",icon:"📊",title:"Weekly Expense Ratio",message:`You spent ${l.toFixed(1)}% of your weekly income.`,details:`Income: ₱${n.toLocaleString("en-PH")} | Expenses: ₱${i.toLocaleString("en-PH")}`,suggestion:l>80?"Try to keep expenses below 80% of income for healthy savings.":"Your expense ratio is healthy!"}),e}generateCombinedInsights(t){const e=[];if(!(t!=null&&t.detailed_analyses))return e;const{expense_summary:n,cash_flow_forecast:i,flagged_transactions:o,weekly_report:a}=t.detailed_analyses,r=this.generateExpenseSummaryInsights(n),l=this.generateCashFlowInsights(i),c=this.generateFlaggedTransactionsInsights(o),d=this.generateWeeklyReportInsights(a);return e.push({type:"overview",icon:"🎯",title:"Financial Health Overview",message:"Comprehensive analysis of your financial activities",details:[`✅ ${r.length} expense insights`,`📈 ${l.length} cash flow insights`,`⚠️ ${c.length} transaction alerts`,`📊 ${d.length} weekly patterns`].join(`
`)}),{overview:e,expenses:r,cashFlow:l,flagged:c,weekly:d}}generateInsights(t,e){switch(t){case"expense_summary":return this.generateExpenseSummaryInsights(e);case"cash_flow_forecast":return this.generateCashFlowInsights(e);case"flag_unusual_transactions":return this.generateFlaggedTransactionsInsights(e);case"weekly_report":return this.generateWeeklyReportInsights(e);case"combined_insights":return this.generateCombinedInsights(e);default:return[]}}}const ga=new Zh,J=(s=0)=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s),Qh=(s,t)=>{if(t<=0)return"#eee";const e=Math.min(1,Math.abs(s)/t),n=Math.round(255*e),i=220-Math.round(120*e);return`rgb(${n},${i},150)`};function tu(s){try{if(typeof s!="string")return"#111";const t=s.match(/^#?([0-9a-f]{6})$/i);if(t){const n=t[1],i=parseInt(n.substring(0,2),16),o=parseInt(n.substring(2,4),16),a=parseInt(n.substring(4,6),16);return(.299*i+.587*o+.114*a)/255>.6?"#111":"#fff"}const e=s.match(/rgb\s*\(\s*(\d+),\s*(\d+),\s*(\d+)\s*\)/i);if(e){const n=Number(e[1]),i=Number(e[2]),o=Number(e[3]);return(.299*n+.587*i+.114*o)/255>.6?"#111":"#fff"}}catch{}return"#111"}const eu=(s,t,e)=>{const n=[],{income:i,expense:o,net:a}=s.summary;if(a>0){const d=i>0?(a/i*100).toFixed(1):0;n.push({type:"success",icon:"💰",title:`Week ${t}: Positive Balance`,message:`You saved ₱${J(a)} this week (${d}% savings rate).`,suggestion:d>20?"Excellent! You're exceeding the 20% savings benchmark.":"Good progress. Try to reach 20% savings rate for optimal financial health."})}else n.push({type:"alert",icon:"🚨",title:`Week ${t}: Deficit Alert`,message:`You overspent by ₱${J(Math.abs(a))} this week.`,suggestion:"Review your expenses below to identify areas for cost reduction."});const r=o/7,l=i/7;r>l*1.2?n.push({type:"warning",icon:"⚠️",title:"High Daily Spending",message:`Your average daily spend (₱${J(r)}) is 20% above your daily income (₱${J(l)}).`,suggestion:`Reduce daily expenses by ₱${J(r-l)} to break even.`}):r<l*.8&&n.push({type:"success",icon:"✅",title:"Efficient Spending",message:"You're spending 20% less than your daily income. Great discipline!",suggestion:`Consider allocating the surplus (₱${J((l-r)*7)} weekly) to savings or investments.`});const c=s.daily_series;if(c&&c.length>0){const d=c.reduce((u,g)=>Math.abs(g.net)>Math.abs(u.net)?g:u,c[0]),h=new Date(d.date).toLocaleDateString("en-US",{weekday:"long"});n.push({type:"info",icon:"📊",title:"Peak Spending Day",message:`${h} (${d.date}) had the highest net flow at ₱${J(d.net)}.`,suggestion:"Review transactions on high-spending days to identify patterns."})}return n.push({type:"analysis",icon:"📈",title:`Week ${t} of ${e}`,message:`This is ${(t/e*100).toFixed(0)}% through your statement period.`,details:`Income: ${J(i)} | Expenses: ${J(o)} | Net: ${J(a)}`}),n};function Cs({report:s,hiddenTxIndices:t}){var O,T;console.log("DEBUG WeeklyReport received:",s);const[e,n]=z.useState(0);if(!s)return null;const i=s.data&&(s.data.data||s.data)||s,{summary:o={},daily_series:a=[],weekly_waterfall:r=[],category_tree:l=[],category_sparklines:c=[],distribution:d={},flagged:h=[],transactions_by_day:u={}}=i;if(!a||!a.length)return f.jsx("div",{className:"p-4 text-center text-gray-700",children:"No transaction data available for the selected period"});const g=7,p=a.length,m=Math.ceil(p/g),b=Math.max(0,Math.min(e,m-1)),x=b*g,y=Math.min(x+g,p),_=a.slice(x,y),w={total_income:_.reduce((k,N)=>k+(N.income||0),0),total_expenses:_.reduce((k,N)=>k+(N.expense||0),0),net:_.reduce((k,N)=>k+(N.net||0),0),avg_daily_spend:_.reduce((k,N)=>k+Math.abs(N.net||0),0)/_.length,transaction_count:_.reduce((k,N)=>k+(N.transactions_count||0),0)},v=Math.max(..._.map(k=>Math.abs(k.net||0)),1),S=eu({summary:w,daily_series:_},b+1,m),C={},M={};_.forEach(k=>{(u[k.date]||[]).forEach(E=>{const D=E.category||"uncategorized",R=Math.abs(E.amount||0);E.amount>=0||E.type==="income"?M[D]=(M[D]||0)+R:C[D]=(C[D]||0)+R})});const P=Object.entries(C).sort((k,N)=>N[1]-k[1]).slice(0,5);return f.jsxs("div",{className:"w-full p-4 space-y-6 text-gray-800",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg shadow",children:[f.jsx("button",{onClick:()=>n(Math.max(0,e-1)),disabled:e===0,className:"px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:"← Previous Week"}),f.jsxs("div",{className:"text-center",children:[f.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["Week ",b+1," of ",m]}),f.jsxs("div",{className:"text-sm text-gray-600",children:[(O=_[0])==null?void 0:O.date," -"," ",(T=_[_.length-1])==null?void 0:T.date]})]}),f.jsx("button",{onClick:()=>n(Math.min(m-1,e+1)),disabled:e>=m-1,className:"px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:"Next Week →"})]}),f.jsx(_t,{insights:S}),f.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[f.jsxs("div",{className:"p-3 bg-white rounded shadow text-gray-800",children:[f.jsx("div",{className:"text-sm text-gray-500",children:"Total Income"}),f.jsx("div",{className:"text-xl font-bold text-green-600",children:J(w.total_income||0)})]}),f.jsxs("div",{className:"p-3 bg-white rounded shadow text-gray-800",children:[f.jsx("div",{className:"text-sm text-gray-500",children:"Total Expenses"}),f.jsx("div",{className:"text-xl font-bold text-red-600",children:J(w.total_expenses||0)})]}),f.jsxs("div",{className:"p-3 bg-white rounded shadow text-gray-800",children:[f.jsx("div",{className:"text-sm text-gray-500",children:"Net"}),f.jsx("div",{className:`text-xl font-bold ${w.net>=0?"text-blue-600":"text-red-600"}`,children:J(w.net||0)})]}),f.jsxs("div",{className:"p-3 bg-white rounded shadow text-gray-800",children:[f.jsx("div",{className:"text-sm text-gray-500",children:"Avg daily spend"}),f.jsx("div",{className:"text-xl font-bold",children:J(w.avg_daily_spend||0)})]})]}),f.jsxs("div",{className:"p-4 bg-white rounded shadow text-gray-800",children:[f.jsx("h4",{className:"font-semibold mb-2",children:"Daily spend heatmap"}),f.jsx("div",{className:"flex space-x-2",children:_.map(k=>{const N=Qh(k.net,v),E=tu(N);return f.jsx("div",{title:`${k.date}: ${J(k.net)}`,style:{width:48,height:48,background:N,color:E},className:"flex items-center justify-center rounded text-xs font-semibold",children:new Date(k.date).toLocaleDateString(void 0,{weekday:"short"})},k.date)})})]}),P.length>0&&f.jsxs("div",{className:"p-4 bg-white rounded shadow text-gray-800",children:[f.jsx("h4",{className:"font-semibold mb-3",children:"Top expense categories this week"}),f.jsx("div",{className:"space-y-3",children:P.map(([k,N])=>{const E=w.total_expenses>0?(N/w.total_expenses*100).toFixed(1):0;return f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm font-medium capitalize",children:k}),f.jsx("span",{className:"text-sm font-bold text-red-600",children:J(N)})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2.5",children:f.jsx("div",{className:"bg-red-500 h-2.5 rounded-full transition-all duration-300",style:{width:`${Math.min(E,100)}%`}})}),f.jsxs("span",{className:"text-xs text-gray-600 font-medium min-w-[45px] text-right",children:[E,"%"]})]})]},k)})})]}),Object.keys(M).length>0&&f.jsxs("div",{className:"p-4 bg-white rounded shadow text-gray-800",children:[f.jsx("h4",{className:"font-semibold mb-3",children:"Income sources this week"}),f.jsx("div",{className:"space-y-3",children:Object.entries(M).sort((k,N)=>N[1]-k[1]).map(([k,N])=>{const E=w.total_income>0?(N/w.total_income*100).toFixed(1):0;return f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm font-medium capitalize",children:k}),f.jsx("span",{className:"text-sm font-bold text-green-600",children:J(N)})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2.5",children:f.jsx("div",{className:"bg-green-500 h-2.5 rounded-full transition-all duration-300",style:{width:`${Math.min(E,100)}%`}})}),f.jsxs("span",{className:"text-xs text-gray-600 font-medium min-w-[45px] text-right",children:[E,"%"]})]})]},k)})})]}),f.jsxs("div",{className:"p-4 bg-white rounded shadow text-gray-800",children:[f.jsx("h4",{className:"font-semibold mb-3",children:"Daily breakdown"}),f.jsx("div",{className:"space-y-3",children:_.map(k=>f.jsx("div",{className:"border-l-4 border-blue-500 pl-3 py-2 bg-gray-50 rounded",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("div",{className:"font-medium",children:k.date}),f.jsxs("div",{className:"text-xs text-gray-500",children:[k.transactions_count||0," transactions"]})]}),f.jsxs("div",{className:"text-right",children:[f.jsxs("div",{className:"text-sm text-gray-600",children:["Income: ",J(k.income||0)]}),f.jsxs("div",{className:"text-sm text-gray-600",children:["Expenses: ",J(k.expense||0)]}),f.jsxs("div",{className:`font-bold ${k.net>=0?"text-green-600":"text-red-600"}`,children:["Net: ",J(k.net||0)]})]})]})},k.date))})]})]})}function su({result:s}){var n,i;if(!s||!s.data)return f.jsx("div",{className:"p-4 text-gray-700",children:"No combined analysis data available."});const{summary:t,detailed_analyses:e}=s.data;return f.jsxs("div",{className:"space-y-8 p-4",children:[f.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg shadow-lg",children:[f.jsx("h2",{className:"text-3xl font-bold mb-4 text-gray-800",children:"📊 Combined Financial Analysis"}),f.jsxs("div",{className:"grid grid-cols-3 gap-4 text-gray-700",children:[f.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[f.jsx("div",{className:"text-sm text-gray-500",children:"Total Transactions"}),f.jsx("div",{className:"text-2xl font-bold",children:(t==null?void 0:t.total_transactions)||0})]}),f.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[f.jsx("div",{className:"text-sm text-gray-500",children:"Date Range"}),f.jsxs("div",{className:"text-sm font-semibold",children:[(n=t==null?void 0:t.date_range)==null?void 0:n.start," to ",(i=t==null?void 0:t.date_range)==null?void 0:i.end]})]}),f.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[f.jsx("div",{className:"text-sm text-gray-500",children:"Generated"}),f.jsx("div",{className:"text-sm",children:new Date(s.data.generated_at).toLocaleString()})]})]})]}),(e==null?void 0:e.expense_summary)&&f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[f.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-800",children:"💰 Expense Summary"}),f.jsx(Ss,{result:{feature:"expense_summary",...e.expense_summary}})]}),(e==null?void 0:e.cash_flow_forecast)&&f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[f.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-800",children:"📈 Cash Flow Forecast"}),f.jsx(Ms,{data:e.cash_flow_forecast})]}),e.flagged_transactions&&f.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-6",children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"⚠️ Flagged Transactions"}),combinedInsights.flagged&&combinedInsights.flagged.length>0&&f.jsx(AIInsightsPanel,{insights:combinedInsights.flagged}),f.jsx(bs,{insights:e.flagged_transactions,transactions:transactions||[],hiddenTxIndices:new Set})]}),(e==null?void 0:e.weekly_report)&&f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[f.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-800",children:"📅 Weekly Report"}),f.jsx(Cs,{report:e.weekly_report})]})]})}const Z=(...s)=>s.flat().filter(Boolean).join(" "),nu=s=>{const t=((s==null?void 0:s.description)||(s==null?void 0:s.merchant)||"").toLowerCase();return t?t.includes("atm")||t.includes("withdrawal")?"withdrawal":t.includes("transfer")||t.includes("deposit")?"transfer":t.includes("payroll")||t.includes("salary")?"payroll":t.includes("rent")?"rent":t.includes("water")||t.includes("electric")||t.includes("bill")?"utilities":t.includes("coffee")||t.includes("restaurant")||t.includes("food")||t.includes("grocery")||t.includes("supermarket")?"food":t.includes("shop")||t.includes("lazada")||t.includes("mr diy")||t.includes("wilcon")||t.includes("allhome")?"shopping":"other":"uncategorized"},iu=({onAnalyze:s,isLoading:t,loadingMessage:e,analysisResult:n,portfolioFeaturesResult:i,result:o})=>{const[a,r]=z.useState(()=>new Set);z.useEffect(()=>{const d=h=>{var g;const u=Number((g=h==null?void 0:h.detail)==null?void 0:g.index);Number.isFinite(u)&&r(p=>new Set([...p,u]))};return window.addEventListener("hideTransaction",d),()=>window.removeEventListener("hideTransaction",d)},[]),z.useEffect(()=>{const d=o&&o.transactions||n&&n.transactions||[];if(!d||d.length===0)return;const h=d.map((u,g)=>{const p=u.category||nu(u),m=Number(u.amount??0),b=m<0?"expense":"income";return{index:g,date:u.date||null,description:u.description||u.merchant||null,amount:m,currency:u.currency||u.currency_code||"PHP",source_category:u.category||null,detected_category:p,inferred_type:b}});console.log("[AI] Detected categories for transactions:",h)},[o,n]);const l="w-full justify-start text-primary-foreground button-outline-on-dark bg-[hsl(var(--boogasi-black-val))]",c="mr-2 h-5 w-5";return f.jsxs(De,{className:"ai-analysis-actions-card shadow-xl",children:[f.jsxs(je,{children:[f.jsx(Te,{className:"text-2xl",children:"Boogasi AI Analysis & Portfolio Tools"}),f.jsx(lo,{children:"Get insights from your data and manage your portfolio."})]}),f.jsxs(Oe,{className:"space-y-4",children:[f.jsxs(ft,{onClick:()=>{console.log("[AIAction] Clicking Analyze Expenses"),typeof s=="function"?s("Analyze Expenses"):console.warn("AIAnalysisActions: onAnalyze prop not provided")},className:Z(l,"border-[hsl(var(--boogasi-blue-val))] hover:bg-[hsl(var(--boogasi-blue-val))]/20"),variant:"outline",disabled:t,children:[f.jsx(Ia,{className:Z(c,"text-[hsl(var(--boogasi-blue-val))] icon-neon-blue")})," ","Analyze Expense Summary"]}),f.jsxs(ft,{onClick:()=>s("Forecast Cash Flow"),className:Z(l,"border-[hsl(var(--boogasi-green-val))] hover:bg-[hsl(var(--boogasi-green-val))]/20"),variant:"outline",disabled:t,children:[f.jsx(La,{className:Z(c,"text-[hsl(var(--boogasi-green-val))] icon-neon-green")})," ","Forecast Cash Flow"]}),f.jsxs(ft,{onClick:()=>s("Flag Unusual Transactions"),className:Z(l,"border-[hsl(var(--boogasi-orange-val))] hover:bg-[hsl(var(--boogasi-orange-val))]/20"),variant:"outline",disabled:t,children:[f.jsx(os,{className:Z(c,"text-[hsl(var(--boogasi-orange-val))] icon-neon-orange")})," ","Flag Unusual Transactions"]}),f.jsxs(ft,{onClick:()=>s("Generate Weekly Report"),className:Z(l,"border-[hsl(var(--boogasi-purple-val))] hover:bg-[hsl(var(--boogasi-purple-val))]/20"),variant:"outline",disabled:t,children:[f.jsx(ro,{className:Z(c,"text-[hsl(var(--boogasi-purple-val))] icon-neon-purple")})," ","Generate Weekly Report"]}),f.jsxs(ft,{onClick:()=>s("Combined Analysis"),className:"w-full justify-start bg-gradient-to-r from-[hsl(var(--boogasi-blue-val))] to-[hsl(var(--boogasi-teal-val))] text-primary-foreground hover:opacity-90",variant:"default",disabled:t,children:[f.jsx(Fa,{className:Z(c,"icon-neon-cyan")})," Combine All Financial Analyses"]}),f.jsxs("div",{className:"pt-4 mt-4 border-t border-[hsl(var(--boogasi-purple-val))]/20",children:[f.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Portfolio Tools (Simulated by Boogasi AI)"}),f.jsxs(ft,{onClick:()=>s("Track Contributions"),className:Z(l,"border-[hsl(var(--boogasi-teal-val))] hover:bg-[hsl(var(--boogasi-teal-val))]/20"),variant:"outline",disabled:t,children:[f.jsx(Ba,{className:Z(c,"text-[hsl(var(--boogasi-teal-val))] icon-neon-teal")})," ","Track Contributions"]}),f.jsxs(ft,{onClick:()=>s("Rebalance Reminders"),className:Z(l,"border-[hsl(var(--boogasi-pink-val))] hover:bg-[hsl(var(--boogasi-pink-val))]/20 mt-2"),variant:"outline",disabled:t,children:[f.jsx(Ra,{className:Z(c,"text-[hsl(var(--boogasi-pink-val))] icon-neon-pink")})," ","Rebalance Reminders"]}),f.jsxs(ft,{onClick:()=>s("Portfolio Performance"),className:Z(l,"border-[hsl(var(--boogasi-blue-val))] hover:bg-[hsl(var(--boogasi-blue-val))]/20 mt-2"),variant:"outline",disabled:t,children:[f.jsx(Ys,{className:Z(c,"text-[hsl(var(--boogasi-blue-val))] icon-neon-blue")})," ","Portfolio Performance Report"]}),f.jsxs(ft,{onClick:()=>s("Goal Progress"),className:Z(l,"border-[hsl(var(--boogasi-green-val))] hover:bg-[hsl(var(--boogasi-green-val))]/20 mt-2"),variant:"outline",disabled:t,children:[f.jsx($a,{className:Z(c,"text-[hsl(var(--boogasi-green-val))] icon-neon-green")})," ","Goal Progress Tracking"]}),f.jsxs(ft,{onClick:()=>s("Smart Alerts"),className:Z(l,"border-[hsl(var(--boogasi-orange-val))] hover:bg-[hsl(var(--boogasi-orange-val))]/20 mt-2"),variant:"outline",disabled:t,children:[f.jsx(os,{className:Z(c,"text-[hsl(var(--boogasi-orange-val))] icon-neon-orange")})," ","Smart Portfolio Alerts"]})]}),t&&f.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-[hsl(var(--primary-foreground))]",children:[f.jsx(ka,{className:"mr-2 h-8 w-8 animate-spin icon-neon-purple"}),f.jsx("span",{className:"mt-2 text-sm",children:e||"Boogasi AI is thinking..."})]}),o&&(o.feature==="expense_summary"?f.jsx(Ss,{result:o}):o.feature==="cash_flow_forecast"?f.jsx(Ms,{data:o}):o.feature==="flag_unusual_transactions"?f.jsx(bs,{insights:o.data,transactions:o.transactions}):o.feature==="weekly_report"?f.jsx(Cs,{report:o}):o.feature==="combined_insights"?f.jsx(su,{result:o}):f.jsx(Da,{result:o}))]})]})},ou=()=>f.jsxs(De,{className:"glassmorphic shadow-xl mt-12 border-[hsl(var(--brighter-teal))]/30 bg-[hsl(var(--card-bg-bright-teal-tint))]",children:[f.jsx(je,{children:f.jsx(Te,{className:"text-2xl text-primary-foreground",children:"How it Works (Conceptual Overview)"})}),f.jsxs(Oe,{className:"space-y-4 text-muted-foreground",children:[f.jsxs("p",{children:["1. ",f.jsx("span",{className:"font-semibold text-primary-foreground",children:"Data Input:"})," You provide your financial data by uploading up to 10 files (CSV, PDF, or images like bank statements/invoices), or by manually pasting transaction data in CSV format."]}),f.jsxs("p",{children:["2. ",f.jsx("span",{className:"font-semibold text-primary-foreground",children:"File Processing (Simulated):"})," For PDFs and images, the system would conceptually perform OCR (Optical Character Recognition) to extract textual data. For CSVs, it parses the structured data. This data is then organized (conceptually like a spreadsheet) for analysis."]}),f.jsxs("p",{children:["3. ",f.jsx("span",{className:"font-semibold text-primary-foreground",children:"AI Analysis (Simulated):"})," The extracted or provided data is then (conceptually) analyzed by an AI. This simulation mimics an AI understanding financial patterns, identifying key metrics, and generating insights on:"]}),f.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-1",children:[f.jsx("li",{children:"Income, expenses, and overall profitability, presented in a clear, invoice-like format with a clean white background."}),f.jsx("li",{children:"Top spending categories and potential areas for savings, with actionable advice."}),f.jsx("li",{children:"Unnecessary or unusually high expenses, flagged for review."}),f.jsx("li",{children:"Cash flow forecasts based on historical data and trends."}),f.jsx("li",{children:"Weekly financial summaries with practical suggestions."}),f.jsx("li",{children:'Investment suggestions based on (mock) analysis of recent financial articles from credible sources, focusing on diversification, risk management, and long-term growth strategies. Data is "crunched" into shorter, digestible summaries.'})]}),f.jsxs("p",{children:["4. ",f.jsx("span",{className:"font-semibold text-primary-foreground",children:"Portfolio Tools (Simulated):"})," The assistant also provides tools to help manage your investments:"]}),f.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-1",children:[f.jsx("li",{children:"Track contributions to different investment accounts."}),f.jsx("li",{children:"Set reminders to rebalance your portfolio according to your target asset allocation."}),f.jsx("li",{children:"Generate portfolio performance reports (e.g., returns, growth over time - visualized with mock charts)."}),f.jsx("li",{children:"Monitor progress towards your financial goals."}),f.jsx("li",{children:"Receive smart alerts, for example, if your portfolio becomes too heavily weighted in a single asset or sector."})]}),f.jsxs("p",{children:["5. ",f.jsx("span",{className:"font-semibold text-primary-foreground",children:"Continuous Improvement (Conceptual):"})," The Horizons AI platform is designed for continuous learning and improvement. New features, data sources, and analytical capabilities are regularly integrated to enhance accuracy and provide even greater benefits to users over time."]}),f.jsx("p",{className:"text-sm italic",children:"Note: Full OCR, live AI model integration, real-time market data, and connections to external services like Zapier require backend capabilities. This page currently simulates these advanced functionalities to demonstrate the potential of an AI finance assistant."})]})]}),au=()=>f.jsxs(De,{className:"border-[hsl(var(--brighter-yellow))]/50 bg-[hsl(var(--brighter-yellow))]/10 dark:bg-[hsl(var(--brighter-yellow))]/5 mt-8 shadow-lg",children:[f.jsx(je,{className:"pb-3",children:f.jsxs(Te,{className:"flex items-center text-lg md:text-xl text-[hsl(var(--brighter-yellow))] dark:text-[hsl(var(--brighter-yellow))]",children:[f.jsx(os,{className:"h-6 w-6 mr-3 text-[hsl(var(--brighter-yellow))] dark:text-[hsl(var(--brighter-yellow))]"}),"AI Finance Assistant Disclaimer"]})}),f.jsxs(Oe,{className:"text-sm md:text-base text-[hsl(var(--brighter-yellow))]/90 dark:text-[hsl(var(--brighter-yellow))]/80 space-y-3",children:[f.jsx("p",{children:"Boogasi’s AI-powered financial tools and insights are provided for informational and educational purposes only. The features currently simulate AI analysis and do not constitute professional financial advice."}),f.jsx("p",{children:"You should not rely solely on this information to make investment, tax, or financial decisions. Always consult a qualified financial advisor, accountant, or other professional before taking any action based on these insights."}),f.jsx("p",{children:"Boogasi does not guarantee the accuracy, completeness, or timeliness of any data, analysis, or recommendations provided by the platform. Use these tools at your own risk."})]})]}),ru=()=>f.jsxs(De,{className:"border-blue-500/50 bg-blue-50/50 dark:bg-blue-900/10 mt-6 shadow-lg",children:[f.jsx(je,{className:"pb-3",children:f.jsxs(Te,{className:"flex items-center text-lg md:text-xl text-blue-700 dark:text-blue-400",children:[f.jsx(Oa,{className:"h-6 w-6 mr-3 text-blue-600 dark:text-blue-500"}),"Data Privacy and Security"]})}),f.jsxs(Oe,{className:"text-sm md:text-base text-blue-800 dark:text-blue-300 space-y-3",children:[f.jsx("p",{children:"Your privacy and data security are extremely important to us. When you upload financial documents or transaction data:"}),f.jsxs("ul",{className:"list-disc list-inside space-y-1 pl-4",children:[f.jsx("li",{children:"Your files are encrypted during upload and storage to protect your sensitive information."}),f.jsx("li",{children:"Uploaded documents are used solely for providing AI insights and are permanently deleted after processing, in accordance with our data retention policies."}),f.jsx("li",{children:"We do not share your personal or financial data with third parties without your explicit consent, except as required by law."})]}),f.jsxs("p",{children:["Please review our full ",f.jsx(Sa,{to:"/privacy-policy",className:"underline hover:text-primary",children:"Privacy Policy"})," to learn more about how we collect, use, and safeguard your data."]}),f.jsx("p",{children:"By using Boogasi’s AI finance tools, you agree to the collection and processing of your data as described above and in our Privacy Policy."})]})]}),lu=({data:s,transactions:t})=>{var i,o,a,r;if(!(s!=null&&s.detailed_analyses))return f.jsx("div",{className:"text-gray-500 italic",children:"No combined analysis data available"});const{detailed_analyses:e}=s;console.log("🔍 CombinedAnalysis received:",{hasTransactions:!!t,transactionCount:t==null?void 0:t.length,hasFlagged:!!e.flagged_transactions,flaggedCount:(o=(i=e.flagged_transactions)==null?void 0:i.flagged)==null?void 0:o.length});const n=ga.generateCombinedInsights(s);return f.jsxs("div",{className:"space-y-8",children:[n.overview&&f.jsx(_t,{insights:n.overview}),s.summary&&f.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border-2 border-blue-200",children:[f.jsx("h3",{className:"text-xl font-bold text-blue-900 mb-3",children:"📊 Analysis Overview"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-600",children:"Total Transactions:"}),f.jsx("span",{className:"font-semibold ml-2",children:s.summary.total_transactions})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-600",children:"Date Range:"}),f.jsxs("span",{className:"font-semibold ml-2",children:[(a=s.summary.date_range)==null?void 0:a.start," to"," ",(r=s.summary.date_range)==null?void 0:r.end]})]})]})]}),e.expense_summary&&f.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-6",children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"💰 Expense Summary"}),n.expenses&&f.jsx(_t,{insights:n.expenses}),f.jsx(Ss,{result:e.expense_summary})]}),e.cash_flow_forecast&&f.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-6",children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"📈 Cash Flow Forecast"}),n.cashFlow&&f.jsx(_t,{insights:n.cashFlow}),f.jsx(Ms,{data:e.cash_flow_forecast})]}),e.flagged_transactions&&f.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-6",children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"⚠️ Flagged Transactions"}),n.flagged&&f.jsx(_t,{insights:n.flagged}),f.jsx(bs,{insights:e.flagged_transactions,transactions:s.transactions||[]})]}),e.weekly_report&&f.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-6",children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"📅 Weekly Report"}),n.weekly&&f.jsx(_t,{insights:n.weekly}),f.jsx(Cs,{report:e.weekly_report})]})]})},cu=({feature:s,data:t})=>{if(console.log("AIInsightsDisplay received:",{feature:s,data:t}),!t)return f.jsx("div",{className:"text-gray-500 italic",children:"No analysis data available"});const e=ga.generateInsights(s,t);switch(s){case"expense_summary":return f.jsxs("div",{className:"space-y-6",children:[f.jsx(_t,{insights:e}),f.jsx(Ss,{result:t})]});case"cash_flow_forecast":return f.jsxs("div",{className:"space-y-6",children:[f.jsx(_t,{insights:e}),f.jsx(Ms,{data:t})]});case"flag_unusual_transactions":return console.log("Flagged transactions data:",t),f.jsxs("div",{className:"space-y-6",children:[f.jsx(_t,{insights:e}),f.jsx(bs,{insights:t,transactions:t.transactions||t.flagged||[]})]});case"weekly_report":return f.jsxs("div",{className:"space-y-6",children:[f.jsx(_t,{insights:e}),f.jsx(Cs,{report:t})]});case"combined_insights":const n=window.__combinedAnalysisTransactions||[];return console.log("📊 Combined insights - transactions available:",n.length),f.jsx(lu,{data:t,transactions:n});default:return f.jsxs("div",{children:[f.jsxs("p",{className:"text-yellow-600 mb-4",children:["⚠️ Unknown feature type: ",s]}),f.jsx("pre",{className:"bg-gray-50 p-4 rounded-lg overflow-auto text-sm max-h-96",children:JSON.stringify(t,null,2)})]})}},du=["previous","account","statement","cheque no","page \\d+ of \\d+","customer service","contact us","important information","transactions since last statement","www\\.","\\.com","\\.net","\\.org","total deposits","total withdrawals","interest paid","fees charged","summary of account","account summary","card number","member number","sort code","swift code","bic code","thank you for banking","visit us at","po box","p\\.o\\. box","attn:","inc\\.","llc","ltd\\.","transaction id","reference no","authorization code","processed on","credit limit","credit line","cash limit","interest rate","available credit","closing balance","payments in","payments out","total","account number","for ","your branch","we find ways","tel ","swift code","hours a day","contact us by phone","bdo\\.com","laguna","philippines"],hu=s=>{if(!s)return null;try{const t=s.trim().replace(/(\d+)(st|nd|rd|th)/,"$1");let e;if(/^\d{4}-\d{2}-\d{2}$/.test(t))e=new Date(t);else if(/^\d{2}[-\/]\d{2}[-\/]\d{4}$/.test(t)){const a=t.split(/[-\/]/);e=new Date(`${a[2]}-${a[0]}-${a[1]}`),(isNaN(e.getTime())||parseInt(a[0],10)>12)&&(e=new Date(`${a[2]}-${a[1]}-${a[0]}`))}else if(/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\.?\s+\d{1,2}(?:,)?\s+\d{4}$/i.test(t))e=new Date(t);else if(/^\d{1,2}\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\.?\s+\d{4}$/i.test(t))e=new Date(t);else if(/^\d{1,2}\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\.?$/i.test(t)){const a=new Date().getFullYear();e=new Date(`${t} ${a}`)}else e=new Date(t);if(isNaN(e.getTime()))return null;const n=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return`${n}-${i}-${o}`}catch{return null}},pa={USD:"$",JPY:"¥",ILS:"₪",PHP:"₱",EUR:"€"},Ji=Object.keys(pa),uu=s=>{const t=s.toLowerCase();let e={};Ji.forEach(c=>e[c]=0);const n=t.match(/amount\s*\(([a-z]{3})\)/i);if(n&&Ji.includes(n[1].toUpperCase()))return n[1].toUpperCase();if([...t.matchAll(/[\d,]+\.?\d*\s*p\b/gi)].length>3)return"PHP";[...t.matchAll(/[$€£¥₹₽₱₪]/gi)].forEach(c=>{const d=c[0],h=Object.entries(pa).find(([u,g])=>g===d);h&&e[h[0]]++}),[...t.matchAll(/\b(USD|JPY|ILS|PHP|EUR)\b/gi)].forEach(c=>e[c[0].toUpperCase()]++);let r="USD",l=0;for(const[c,d]of Object.entries(e))d>l&&(l=d,r=c);return r},Zi=s=>{if(!s)return null;let t=s.trim();t=t.replace(/[$€£¥₹₽₱₪]/gi,""),t=t.replace(/\s*P\s*$/i,"").trim(),t=t.replace(/(\d)\s+/g,"$1"),t=t.replace(/\s+(\d)/g,"$1"),t=t.replace(/[A-Za-z]/gi,"").trim();const e=(t.match(/\./g)||[]).length,n=(t.match(/,/g)||[]).length;if(n>0&&e>0){const o=t.lastIndexOf(",");t.lastIndexOf(".")>o?t=t.replace(/,/g,""):t=t.replace(/\./g,"").replace(",",".")}else if(n>0){const o=t.split(",");o.length===2&&o[1].length===2?t=t.replace(",","."):t=t.replace(/,/g,"")}else e>1&&(t=t.replace(/\./g,""));const i=parseFloat(t);return isNaN(i)?null:i},fu=s=>{const t={date:/\b(date|trans\.?\s*date|transaction\s*date)\b/i,description:/\b(description|details|particulars|transaction|narration)\b/i,withdrawal:/\b(withdrawal|withdrawals|debit|debits|payment|payments?\s*out)\b/i,deposit:/\b(deposit|deposits|credit|credits|payment\s*received|payments?\s*in)\b/i,balance:/\b(balance|running\s*balance)\b/i};let e=-1;for(let n=0;n<Math.min(15,s.length);n++){const o=s[n].toLowerCase(),a=t.date.test(o),r=t.description.test(o),l=t.withdrawal.test(o),c=t.deposit.test(o);if(a&&(r||l||c)){e=n;break}}return e!==-1?{headerLineIndex:e}:null},gu=s=>{const t=s.match(/^(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d{1,2},?\s+\d{4}/i);let e=null,n=s;if(t)e=hu(t[0]),n=s.substring(t[0].length).trim();else return{date:null};const i=n.split(/\t+|\s{2,}/);let o="",a=[];for(let h=0;h<i.length;h++){const u=i[h].trim();u&&(/[\d,.]/.test(u)&&Zi(u)!==null?a.push(Zi(u)):o||(o=u))}let r=null,l=null;a.length>=2&&(a.length===2?o.toLowerCase().includes("withdrawal")?r=a[0]:l=a[0]:a.length>=3&&(r=a[0],l=a.length>2?a[1]:null));let c=null,d=!1;return o.toLowerCase().includes("fund transfer")||o.toLowerCase().includes("deposit")?(c=l,d=!0):o.toLowerCase().includes("withdrawal")&&(c=r,d=!1),{date:e,description:o,transactionAmount:c,isDeposit:d}},Qi=(s,t)=>{console.log("=== BDO Philippines Bank Statement Parser ===");const e=s.split(/\r?\n/).map(l=>l.trim()).filter(l=>l.length>0);console.log(`Total lines detected: ${e.length}`);const n=uu(s);console.log("Detected Currency:",n);const i=fu(e);console.log(i?`✓ Found transaction table header at line ${i.headerLineIndex}`:"⚠ No clear transaction table header found — attempting fallback parsing");let o=i?i.headerLineIndex+1:0,a=[],r=0;console.log(`
--- Beginning Transaction Parsing ---
`);for(let l=o;l<e.length;l++){const c=e[l],d=c.toLowerCase();if(du.some(g=>new RegExp(`\\b${g}\\b`,"i").test(d))){r++;continue}if(d.includes("closing balance")||d.match(/\btotal\b/i)){r++;continue}const h=gu(c);if(!h.date){console.log(`⚠ [Line ${l}] Skipped — invalid or missing date`);continue}if(!h.description||h.description.length<2){console.log(`⚠ [Line ${l}] Skipped — missing or too short description`);continue}if(h.transactionAmount===null||h.transactionAmount===0){console.log(`⚠ [Line ${l}] Skipped — invalid or zero amount`);continue}const u=h.isDeposit?Math.abs(h.transactionAmount):-Math.abs(h.transactionAmount);a.push({date:h.date,description:h.description.replace(/\s+/g," ").trim(),amount:u,currency:n,sourceFile:(t==null?void 0:t.name)||"unknown"}),console.log(`✓ [Line ${l}] Transaction added:`,{date:h.date,description:h.description.substring(0,40)+(h.description.length>40?"...":""),amount:u})}return a.sort((l,c)=>{const d=new Date(l.date),h=new Date(c.date);return isNaN(d.getTime())||isNaN(h.getTime())?0:d-h}),console.log(`
--- Parsing Summary ---`),console.log("Ignored Lines:",r),console.log("Transactions Parsed:",a.length),console.log(`=== Parsing Complete: ${a.length} transactions found ===
`),{formattedTransactions:a,summary:{},bankName:"BDO Philippines",fileCurrency:n,rawText:s}},Ne=s=>{if(!s)return null;const t=s.trim().replace(/,/g,""),e=parseFloat(t);return isNaN(e)?null:e},to=(s,t)=>{if(!s)return null;try{const e={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},n=s.toLowerCase().trim().split(/\s+/);if(n.length<2)return null;const i=n[0].padStart(2,"0"),o=n[1].substring(0,3),a=e[o];return a?`${t}-${a}-${i}`:null}catch{return null}},pu=s=>{const t={},e={previousBalance:/Previous\s+Balance\s+([\d,]+\.?\d*)/i,paymentsAndCredits:/Payments?\s+(?:&|and)\s+Credits?\s+([\d,]+\.?\d*)/i,purchases:/Purchases\s+([\d,]+\.?\d*)/i,currentBalance:/Current\s+Balance\s+([\d,]+\.?\d*)/i};for(const[n,i]of Object.entries(e)){const o=s.match(i);o&&(t[n]=Ne(o[1]))}return t},mu=s=>{const t={},e={totalDue:/Total\s+Due\s+([\d,]+\.?\d*)/i,minimumPayment:/Minimum\s+Payment\s+([\d,]+\.?\d*)/i,paymentDueDate:/Payment\s+Due\s+Date\s+(\d{1,2}\s+\w+\s+\d{4})/i};for(const[n,i]of Object.entries(e)){const o=s.match(i);o&&(n==="paymentDueDate"?t[n]=o[1]:t[n]=Ne(o[1]))}return t},bu=s=>{const t={},e={creditLimit:/Credit\s+Limit\s+(?:\(PHP\))?\s+([\d,]+\.?\d*)/i,availableCredit:/Available\s+Credit\s+(?:\(PHP\))?\s+([\d,]+\.?\d*)/i,cashLimit:/Cash\s+Limit\s+(?:\(PHP\))?\s+([\d,]+\.?\d*)/i};for(const[n,i]of Object.entries(e)){const o=s.match(i);o&&(t[n]=Ne(o[1]))}return t},xu=s=>{const t=s.match(/Statement\s+from\s+\d{1,2}\s+\w+\s+(\d{4})/i);if(t)return parseInt(t[1],10);const e=s.match(/\b(20\d{2})\b/);return e?parseInt(e[1],10):new Date().getFullYear()},eo=(s,t)=>{console.log("=== HSBC Philippines Credit Card Parser ===");const e=s.split(/\r?\n/).map(h=>h.trim()),n=pu(s),i=mu(s),o=bu(s),a=xu(s);console.log("Statement Year:",a),console.log("Account Summary:",n),console.log("Payment Summary:",i),console.log("Credit Limit:",o);const r=[];let l=!1;const c=[/Previous\s+Statement\s+Balance/i,/ACCOUNT\s+SUMMARY/i,/PAYMENT\s+SUMMARY/i,/CREDIT\s+LIMIT/i,/INTEREST\s+RATES/i,/Total\s+Due/i,/Minimum\s+Payment/i,/Page\s+\d+\s+of\s+\d+/i,/CONTACT\s+US/i,/Customer\s+Service/i,/Continued\s+on\s+next\s+page/i,/HSBC\s+GOLD\s+VISA/i,/Card\s+Products/i,/The\s+Hongkong/i,/Makati\s+City/i,/Metro\s+Manila/i,/\d{4}[-\s]?X{4}[-\s]?X{4}[-\s]?\d{4}/i];for(let h=0;h<e.length;h++){const u=e[h];if(!u||u.length<5)continue;if(!l){const P=/POST\s+DATE\s+TRAN\s+DATE\s+DESCRIPTION\s+AMOUNT/i,O=/POST[\s\t]+TRAN/i,T=/DATE[\s\t]+DATE[\s\t]+DESCRIPTION[\s\t]+AMOUNT/i;if(P.test(u)||O.test(u)||T.test(u)){l=!0,console.log("✓ Found transaction table header at line",h);continue}}if(!l||c.some(P=>P.test(u)))continue;if(/^[\d,]+\.\d{2}$/.test(u)&&Ne(u)>5e4){console.log("✓ Reached end of transactions (Total Due line)");break}const g=/^(\d{1,2}\s+(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec))\s+(\d{1,2}\s+(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec))\s+(.+?)\s+([\d,]+\.\d{2})$/i,p=u.match(g);if(!p)continue;const m=p[1],b=p[2],x=p[3].trim(),y=p[4],_=to(m,a),w=to(b,a);if(!_){console.log("⚠ Failed to parse date:",m);continue}const v=Ne(y);if(v===null||v===0){console.log("⚠ Invalid amount:",y);continue}let S="PURCHASE",C=-v;const M=x.toLowerCase();(M.includes("payment")||M.includes("credit")||M.includes("reversal")||M.includes("refund")||M.includes("cashback"))&&(S="PAYMENT",C=v),r.push({date:_,transactionDate:w,description:x,amount:C,currency:"PHP",sourceFile:(t==null?void 0:t.name)||"unknown",type:S}),console.log("✓ Transaction added:",{date:_,description:x.substring(0,30)+"...",amount:C})}console.log(`
=== Parsing Complete: ${r.length} transactions found ===
`);const d={...n,...i,...o,statementYear:a};return{formattedTransactions:r,summary:d,accountSummary:n,paymentSummary:i,creditLimit:o,bankName:"HSBC Philippines",statementYear:a,rawText:s}},so=(s,t)=>{console.log("=== HSBC UK Bank Statement Parser ===");const e=s.split(`
`).map(l=>l.trim()).filter(l=>l.length>0),n=yu(e);console.log("Detected format:",n);const i=wu(e,s);console.log("Statement Period:",i);const o=ku(e);console.log("Account Summary:",o);const a=Su(e);console.log("Account Details:",a);const r=n==="simple-table"?_u(e,i.year):Mu(e,i.year);return console.log(`
=== Parsing Complete: ${r.length} transactions found ===`),{formattedTransactions:r,summary:o,accountSummary:o,accountDetails:a,statementPeriod:i,bankName:"HSBC UK",statementYear:i.year}},yu=s=>{for(const t of s){const e=t.toLowerCase();if(e.includes("withdrawals")&&e.includes("deposits")&&e.includes("balance")||e.includes("withdrawal")&&e.includes("deposit")||t.includes("Details of your account activity"))return"simple-table"}return"standard"},_u=(s,t)=>{const e=[];let n=-1;for(let a=0;a<s.length;a++){const r=s[a].toLowerCase();if(r.includes("date")&&r.includes("description")||r.includes("details of your account activity")){n=a+1,console.log(`✓ Found simple table header at line ${a}: "${s[a]}"`);break}}if(n===-1)return console.log("⚠ Could not find transaction table"),e;for(;n<s.length;){const a=s[n].toLowerCase();if(a.includes("withdrawal")||a.includes("deposit")||a.includes("balance")||a.includes("opening balance")||a==="date"||a==="description")console.log(`  Skipping header/opening line: "${s[n]}"`),n++;else break}let i=n,o=null;for(;i<s.length;){const a=s[i];if(console.log(`Line ${i}: "${a}"`),a.toLowerCase().includes("correspondence:")||a.toLowerCase().includes("statement page")||a.toLowerCase().includes("centenary square")||a.toLowerCase().includes("end of statement")||a.toLowerCase().includes("your closing balance")){console.log(`⏹ End of transaction section at line ${i}`);break}const r=a.match(/^(\d{1,2})\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|January|February|March|April|May|June|July|August|September|October|November|December)(\s+\d{2,4})?/i);if(r){o&&e.push(ms(o));const l=r[1].padStart(2,"0"),c=r[2];let d=r[3]?r[3].trim():t;d.length===2&&(d=parseInt(d)>50?"19"+d:"20"+d),o={date:`${l} ${c} ${d}`,type:null,description:"",paidOut:null,paidIn:null,balance:null,rawLines:[a]},console.log(`
📅 New transaction: ${o.date}`);const h=a.substring(r[0].length).trim();h&&(o.description=h,console.log(`  Description: ${h}`))}else if(o){const l=a.match(/(\d+(?:,\d{3})*\.\d{2})/g);l&&l.length>0?vu(a,o):a.trim()&&!a.match(/^(Withdrawals|Deposits|Balance)/i)&&(o.description?o.description+=" "+a.trim():o.description=a.trim(),console.log(`  Description extended: ${o.description}`))}i++}return o&&e.push(ms(o)),console.log(`
✅ Total transactions extracted: ${e.length}`),e},vu=(s,t)=>{console.log(`  💰 Parsing amounts from: "${s}"`);const e=[],n=/(\d+(?:,\d{3})*\.\d{2})/g;let i;for(;(i=n.exec(s))!==null;){const o=i[1].replace(/,/g,"");e.push(parseFloat(o))}if(console.log(`     Found ${e.length} amounts:`,e),e.length!==0){if(e.length===3)e[0]>0&&(t.paidOut=e[0]),e[1]>0&&(t.paidIn=e[1]),t.balance=e[2];else if(e.length===2){t.balance=e[1];const o=(t.description||"").toLowerCase(),a=["transfer","interest paid","deposit","credit","payment received","refund"],r=["withdrawal","atm","cheque","purchase","payment","debit","fee"],l=a.some(d=>o.includes(d)),c=r.some(d=>o.includes(d));l&&!c?t.paidIn=e[0]:t.paidOut=e[0]}else e.length===1&&(t.paidOut===null&&t.paidIn,t.balance=e[0]);console.log(`     Assigned - PaidOut: ${t.paidOut}, PaidIn: ${t.paidIn}, Balance: ${t.balance}`)}},wu=(s,t)=>{const e=/(\d{1,2})\s+([A-Za-z]+)\s+to\s+(\d{1,2})\s+([A-Za-z]+)\s+(\d{4})/i,n=/From[A-Za-z]{3}(\d{1,2}),(\d{4})to[A-Za-z]{3}(\d{1,2}),(\d{4})/i;for(const r of s){const l=r.match(e);if(l)return{startDay:l[1],startMonth:l[2],endDay:l[3],endMonth:l[4],year:l[5],fullText:l[0]};const c=r.match(n);if(c)return{startDay:c[1],startMonth:"",endDay:c[3],endMonth:"",year:c[4],fullText:r}}const i=/on\s+([A-Za-z]+)\s+(\d{1,2}),\s+(\d{4})/i;for(const r of s){const l=r.match(i);if(l)return{startDay:l[2],startMonth:l[1],endDay:"",endMonth:"",year:l[3],fullText:l[0]}}const o=t.match(/\b(20\d{2})\b/);return{startDay:"",startMonth:"",endDay:"",endMonth:"",year:o?o[1]:new Date().getFullYear().toString(),fullText:""}},ku=s=>{const t={openingBalance:null,paymentsIn:null,paymentsOut:null,closingBalance:null};for(let e=0;e<s.length;e++){const n=s[e],i=e+1<s.length?s[e+1]:"";if(n.toLowerCase().includes("opening balance")){const o=ut(n)||ut(i);o!==null&&(t.openingBalance=o)}else if(n.toLowerCase().includes("total deposits into your account")){const o=ut(n)||ut(i);o!==null&&(t.paymentsIn=o)}else if(n.toLowerCase().includes("total withdrawals from your account")){const o=ut(n)||ut(i);o!==null&&(t.paymentsOut=o)}else if(n.toLowerCase().includes("closing balance")){const o=ut(n)||ut(i);o!==null&&(t.closingBalance=o)}else if(n.toLowerCase().includes("payments in")){const o=ut(i)||ut(n);o!==null&&(t.paymentsIn=o)}else if(n.toLowerCase().includes("payments out")){const o=ut(i)||ut(n);o!==null&&(t.paymentsOut=o)}}return t},Su=s=>{const t={accountName:null,iban:null,bic:null,sortCode:null,accountNumber:null};for(let e=0;e<s.length;e++){const n=s[e];n.match(/^GB\d{2}[A-Z]{4}\d+$/)&&(t.iban=n),n.match(/^[A-Z]{4}GB[A-Z0-9]+$/)&&(t.bic=n);const i=n.match(/(\d{2}[-]\d{2}[-]\d{2})/);i&&(t.sortCode=i[1]);const o=n.match(/account number:\s*(\d{8})/i);if(o)t.accountNumber=o[1];else{const a=n.match(/\b(\d{8})\b/);a&&!t.accountNumber&&(t.accountNumber=a[1])}if(n.match(/^[A-Z\s]{3,50}$/)&&!n.match(/HSBC|LONDON|STREET|ACCOUNT|BALANCE|STATEMENT/i)&&!t.accountName&&e>0&&s[e-1].includes("HSBC")&&(t.accountName=n),n.toLowerCase().includes("account name")){const a=e+1<s.length?s[e+1]:"";a&&!a.match(/^\d/)&&a.length<50&&(t.accountName=a)}}return t},Mu=(s,t)=>{const e=[],n=["BP","CR","DD","SO","CHQ","ATM","TFR","FEE","INT","BAC","FPI","Debit","Credit"];let i=-1;for(let r=0;r<s.length;r++){const l=s[r].toLowerCase();if(l.includes("paid out")&&l.includes("paid in")||l.includes("money out")&&l.includes("money in")||l.includes("payment type")&&l.includes("details")||l==="transactions"){i=r+1,console.log(`✓ Found transaction table header at line ${r}: "${s[r]}"`);break}}if(i===-1){console.log("⚠ Could not find transaction section start");for(let r=0;r<s.length;r++)if(s[r].toLowerCase().includes("transaction")){console.log(`Found "transactions" keyword at line ${r}, searching for first date...`),i=r+1;break}}if(i===-1)return console.log("⚠ Still could not find start, aborting"),e;let o=i,a=null;for(;o<s.length&&(s[o].toLowerCase().includes("description")||s[o].toLowerCase().includes("continued")||s[o].toLowerCase().includes("details")||s[o].toLowerCase().includes("money")||s[o].toLowerCase().includes("balance")||s[o].toLowerCase()==="date");)console.log(`  Skipping header line: "${s[o]}"`),o++;for(;o<s.length;){const r=s[o];if(console.log(`Line ${o}: "${r}"`),r.toLowerCase().includes("balance carried forward")||r.toLowerCase().includes("continued on next page")||r.toLowerCase().includes("correspondence:")||r.toLowerCase().includes("statement page")||r.toLowerCase().includes("centenary square")||r.match(/^\d+\s+(High Street|Centenary Square)/)){console.log(`⏹ End of transaction section at line ${o}`);break}if(r.toUpperCase().includes("BALANCE BROUGHT FORWARD")||r.toUpperCase().includes("BALANCE B/F")||r.toUpperCase().includes("CLOSING BALANCE")){o++;continue}const l=r.match(/^(\d{1,2})\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{2,4})/i);if(l){a&&e.push(ms(a));const c=l[1].padStart(2,"0"),d=l[2],h=l[3],u=h.length===2?parseInt(h)>50?"19"+h:"20"+h:h;a={date:`${c} ${d} ${u}`,type:null,description:"",paidOut:null,paidIn:null,balance:null,rawLines:[r]},console.log(`
📅 New transaction started: ${a.date}`);const g=r.substring(l[0].length).trim();if(g){const p=g.match(/(\d+(?:,\d{3})*\.\d{2})/g);if(p){const m=g.indexOf(p[0]),b=g.substring(0,m).trim();b&&(a.description=b,console.log(`  Description (from same line): ${b}`)),no(g,a)}else a.description=g,console.log(`  Description (from same line): ${g}`)}}else a&&(a.rawLines.push(r),!a.type&&n.includes(r.trim())?(a.type=r.trim(),console.log(`  Type: ${a.type}`)):r.match(/\d+\.\d{2}/)?no(r,a):r.trim()&&!r.match(/^[\d,]+\.?\d*$/)&&r.trim().length>1&&(["continued","details","out","in","balance"].includes(r.trim().toLowerCase())||(a.description?a.description+=" "+r.trim():a.description=r.trim(),console.log(`  Description: ${a.description}`))));o++}return a&&e.push(ms(a)),console.log(`
✅ Total transactions extracted: ${e.length}`),e},no=(s,t)=>{console.log(`  💰 Parsing amounts from: "${s}"`);const e=[],n=/(\d+(?:,\d{3})*\.\d{2})/g;let i;for(;(i=n.exec(s))!==null;){const o=i[1].replace(/,/g,"");e.push(parseFloat(o))}console.log(`     Found ${e.length} amounts:`,e),e.length!==0&&(e.length>=3?(e[0]>0&&(t.paidOut=e[0]),e[1]>0&&(t.paidIn=e[1]),t.balance=e[2]):e.length===2?(t.type==="CR"||t.paidOut!==null?t.paidIn=e[0]:t.paidOut=e[0],t.balance=e[1]):e.length===1&&(t.paidOut!==null||t.paidIn!==null?t.balance=e[0]:t.type==="CR"?t.paidIn=e[0]:t.paidOut=e[0]),console.log(`     Assigned - PaidOut: ${t.paidOut}, PaidIn: ${t.paidIn}, Balance: ${t.balance}`))},ms=s=>{let t=0,e="debit";s.paidIn!==null&&s.paidIn>0?(t=s.paidIn,e="credit"):s.paidOut!==null&&s.paidOut>0&&(t=-s.paidOut,e="debit");const n={date:s.date,type:s.type||"UNKNOWN",description:Cu(s.description),amount:t,debit:s.paidOut,credit:s.paidIn,balance:s.balance,transactionType:e,category:Au(s.type,s.description)};return console.log(`✓ Finalized: ${n.date} | ${n.type} | ${n.description} | Amount: ${n.amount}`),n},Cu=s=>s?(s=s.replace(/\s+/g," ").trim(),s=s.replace(/[|]/g,""),s):"",Au=(s,t)=>{const e=(t||"").toLowerCase();switch(s){case"BP":return"Bill Payment";case"CR":return"Credit/Deposit";case"DD":return"Direct Debit";case"SO":return"Standing Order";case"CHQ":return"Cheque";case"ATM":return"ATM Withdrawal";case"TFR":return"Transfer";case"FEE":return"Fee";case"INT":return"Interest";case"BAC":return"BACS Payment";case"FPI":return"Faster Payment";default:return e.includes("salary")||e.includes("wages")?"Income":e.includes("transfer")?"Transfer":e.includes("deposit")?"Deposit":e.includes("rent")?"Rent":e.includes("groceries")||e.includes("supermarket")?"Groceries":e.includes("restaurant")||e.includes("cafe")||e.includes("coffee")?"Dining":e.includes("gas")||e.includes("electric")||e.includes("water")?"Utilities":e.includes("uber")||e.includes("taxi")?"Transport":"Other"}},ut=s=>{const t=s.match(/(\d+(?:,\d{3})*\.\d{2})/);return t?parseFloat(t[1].replace(/,/g,"")):null},io=(s,t)=>{const e=[],n=s.split(`
`).map(u=>u.trim()).filter(Boolean);let i=null;const o=s.match(/(20\d{2})/);o&&(i=o[1]);try{if(typeof ignoreWords<"u"&&Array.isArray(ignoreWords)){const u=ignoreWords.findIndex(g=>/previous\s*balance/i.test(String(g)));u!==-1&&ignoreWords.splice(u,1)}}catch{}const a=u=>{if(u===null||typeof u>"u"||u==="")return 0;const g=String(u).replace(/\(([^)]+)\)/g,(m,b)=>`-${b}`).replace(/[^0-9\.\-\,]/g,"").replace(/,/g,""),p=parseFloat(g);return Number.isFinite(p)?p:0},r=[/previous\s+balance[:\s]*([-\d,().,]+)/i,/balance\s+brought\s+forward[:\s]*([-\d,().,]+)/i,/opening\s+balance[:\s]*([-\d,().,]+)/i,/opening[:\s]*balance[:\s]*([-\d,().,]+)/i];for(const u of r){const g=s.match(u);if(g&&g[1]){const p=a(g[1]);!e.some(b=>/previous\s*balance/i.test(b.description||"")||b.category==="opening_balance")&&p!==0&&e.unshift({date:`${i||new Date().getFullYear()}-03-02`,description:"Previous balance",amount:p,category:"opening_balance",currency:"PHP",sourceFile:(t==null?void 0:t.name)||"Metrobank Statement"});break}}for(let u=0;u<n.length;u++){const p=n[u].split(/\s{2,}|\t+/).map(v=>v.trim()).filter(Boolean);if(p.length<3)continue;let m=null;for(const v of[/^\d{1,2}[\/\-]\d{1,2}(?:[\/\-]\d{2,4})?/,/^\d{1,2}\s+[A-Za-z]{3,9}\s+\d{2,4}/,/^\d{1,2}\s+[A-Za-z]{3,9}/])if(p[0].match(v)){m=p[0];break}if(!m)continue;let b=p[1],x=p[2]&&p[2]!=="-"?parseFloat(p[2].replace(/,/g,"")):0,y=p[3]&&p[3]!=="-"?parseFloat(p[3].replace(/,/g,"")):0,_=x?-Math.abs(x):y;if(/check|deposit|payment/i.test(b)&&(_=Math.abs(y||x)),/water bill|rent bill|payroll|main office wholesale|debit transaction/i.test(b)&&(_=-Math.abs(x||y)),/previous balance/i.test(b))continue;const w=v=>{const S=v.split(/[\/\-]/);if(S.length===3){let[C,M,P]=S;return P.length===2&&(P=`20${P}`),C.length===1&&(C=`0${C}`),M.length===1&&(M=`0${M}`),`${P}-${C}-${M}`}return v};e.push({date:w(m),description:b,amount:_,currency:"PHP",sourceFile:(t==null?void 0:t.name)||"Metrobank Statement"})}const l=s.match(/opening\s+balance[:\s]*([-\d,().,]+)\b/i),c=s.match(/closing\s+balance[:\s]*([-\d,().,]+)\b/i),d={openingBalance:l?a(l[1]):null,closingBalance:c?a(c[1]):null};return e.length===0&&console.warn("Metrobank parser: no transactions detected in primary passes. Raw text sample:",s.slice(0,200)),{formattedTransactions:e.map(u=>({...u,date:u.date||null})),summary:d,bankName:"METROBANK"}},oo=(s,t={})=>{console.log("=== Landbank Statement Parser ===");const e=s.split(`
`).map(m=>m.trim()).filter(m=>m.length>0),n=[],i=s.match(/(20\d{2})/),o=i?i[1]:new Date().getFullYear().toString(),a=/^(\d{2}\/\d{2}\/\d{2,4}|\d{2}-\d{2}-\d{2,4}|\d{2}\s+[A-Za-z]{3}\s+\d{2,4})/i,r=/([\d,]+\.\d{2})/,l=[/page\s+\d+\s+of\s+\d+/i,/land\s*bank\s*of\s*the\s*philippines/i,/statement\s+of\s+account/i,/account\s+number/i,/branch:/i,/date\s+printed/i,/transaction\s+history/i,/currency:\s*php/i],c=m=>{if(!m)return null;const b=m.includes("(")||m.includes("-"),x=m.replace(/[(),\s]/g,""),y=parseFloat(x);return isNaN(y)?null:b?-y:y},d=m=>{if(!m)return null;try{const b=m.match(/(\d{2})[\/-](\d{2})[\/-](\d{2,4})/);if(b){const[_,w,v,S]=b;return`${S.length===2?"20"+S:S}-${v}-${w}`}const x={JAN:"01",FEB:"02",MAR:"03",APR:"04",MAY:"05",JUN:"06",JUL:"07",AUG:"08",SEP:"09",OCT:"10",NOV:"11",DEC:"12"},y=m.match(/(\d{2})\s+([A-Za-z]{3})\s+(\d{2,4})/i);if(y){const[_,w,v,S]=y,C=x[v.toUpperCase()];return`${S.length===2?"20"+S:S}-${C}-${w}`}}catch(b){console.warn("Date parsing failed:",b)}return null},h=m=>[/transfer from banknet/i,/visa transfer from/i,/cash-?in from pay\s?&?\s?go/i].some(x=>x.test(m))?1:-1;for(let m=0;m<e.length;m++){const b=e[m].trim();if(!b||l.some(S=>S.test(b)))continue;const x=b.match(a);if(!x)continue;const y=x[0];let _=b.replace(y,"").trim();const w=_.match(new RegExp(r,"g"))||[];if(w.length===0)continue;let v=null;if(w.length>=2){const S=w[w.length-2];v=c(S),_=_.replace(new RegExp(r,"g"),"").trim()}else v=c(w[0]),_=_.replace(r,"").trim();if(v!==null){const S=h(_),C={date:d(y),description:_||"UNKNOWN TRANSACTION",amount:Math.abs(v)*S,currency:"PHP",sourceFile:(t==null?void 0:t.name)||"Landbank Statement"},M=pt.categorizeTransaction(C.description,C.amount),P=pt.correctTransaction(C);n.push({...P,category:M,category_confidence:pt.getConfidence(C.description,M)})}}const u={openingBalance:null,closingBalance:null,totalCredits:0,totalDebits:0},g=s.match(/(?:opening|previous|beginning)\s+balance\s*:?\s*([\d,]+\.\d{2})/i),p=s.match(/(?:closing|ending)\s+balance\s*:?\s*([\d,]+\.\d{2})/i);return u.openingBalance=g?c(g[1]):null,u.closingBalance=p?c(p[1]):null,n.forEach(m=>{m.amount>0?u.totalCredits+=m.amount:u.totalDebits+=Math.abs(m.amount)}),console.log(`
=== Parsing Complete: ${n.length} transactions found ===
`),{formattedTransactions:n,summary:u,bankName:"LANDBANK",statementYear:o}};let Ze=null;const Pu=async()=>{if(Ze)return Ze;try{const{data:s,error:t}=await Ma.functions.invoke("get-ocr-api-key");if(t)throw new Error(`Failed to fetch OCR API key: ${t.message}`);if(!s||!s.apiKey)throw new Error("OCR API key was not returned from the server.");return Ze=s.apiKey,Ze}catch(s){throw console.error("Exception fetching OCR API key:",s),s}},Nu=s=>{const t=s.toLowerCase();return t.includes("hsbc")?"HSBC":t.includes("bdo unibank")||t.includes("banco de oro")||t.includes("transaction date")&&t.includes("value date")?"BDO":t.includes("bank of the philippine islands")||t.includes("bpi")||t.includes("bpi family savings bank")?"BPI":t.includes("metrobank")||t.includes("metropolitan bank")||t.includes("metro bank")?"METROBANK":t.includes("land bank")||t.includes("landbank")||t.includes("land bank of the philippines")?"LANDBANK":t.includes("security bank")?"SECURITY_BANK":t.includes("citibank")||t.includes("citi")?"CITIBANK":"UNKNOWN"},ao=s=>{const t=s.toLowerCase(),e=[t.includes("paid out")&&t.includes("paid in"),t.includes("payments out")&&t.includes("payments in"),t.includes("your statement"),t.includes("sort code")||t.includes("sortcode"),/international bank account number/i.test(s),/branch identifier code/i.test(s),/\d{2}[-]\d{2}[-]\d{2}/.test(s),/balance brought forward/i.test(s),/balance carried forward/i.test(s)],n=[t.includes("credit card statement"),t.includes("post date")&&t.includes("tran date"),t.includes("hsbc gold visa"),t.includes("credit limit"),t.includes("minimum amount due"),t.includes("payment due date"),t.includes("previous balance")&&t.includes("new balance"),/available credit/i.test(s)],i=e.filter(Boolean).length,o=n.filter(Boolean).length;return console.log("HSBC Type Detection - UK Score:",i,"| Philippines Score:",o),i>o&&i>=2?"UK_BANK_STATEMENT":o>i&&o>=2?"PHILIPPINES_CREDIT_CARD":t.includes("paid out")||t.includes("paid in")?"UK_BANK_STATEMENT":t.includes("credit card statement")||t.includes("minimum amount due")?"PHILIPPINES_CREDIT_CARD":"UNKNOWN"},Du=async(s,t,e)=>{var a;const{rawText:n,formattedTransactions:i,detectedBank:o}=e;if(i&&i.length>5)return console.log("✅ Initial OCR successful, skipping recovery"),e;console.log("🔄 Performing AI-enhanced recovery...");try{const r=new FormData;r.append("file",s),r.append("apikey",t),r.append("language","eng"),r.append("isOverlayRequired","true"),r.append("detectOrientation","true"),r.append("scale","true"),r.append("OCREngine","2"),r.append("isTable","true");const l=await fetch("https://api.ocr.space/parse/image",{method:"POST",body:r});if(!l.ok)return console.warn("Enhanced OCR failed, using original results"),e;const c=await l.json();if(c.ParsedResults&&((a=c.ParsedResults[0])!=null&&a.ParsedText)){const d=c.ParsedResults[0].ParsedText,h=ba(d,o,s),u=ju(i,h.formattedTransactions);return console.log(`🔄 Recovery found ${u.length-i.length} additional transactions`),{...e,formattedTransactions:u,recoveryPerformed:!0,originalCount:i.length,recoveredCount:u.length-i.length}}}catch(r){console.error("Recovery failed:",r)}return e},ju=(s,t)=>{if(!t||t.length===0)return s;if(!s||s.length===0)return t;const e=[...s];for(const n of t)s.some(o=>Tu(o,n))||e.push({...n,recovered:!0,confidence:.7});return e.sort((n,i)=>!n.date||!i.date?0:new Date(n.date)-new Date(i.date))},Tu=(s,t)=>!!(s.date===t.date&&Math.abs((s.amount||0)-(t.amount||0))<.02||s.description&&t.description&&Ou(s.description.toLowerCase(),t.description.toLowerCase())>.8),Ou=(s,t)=>{if(!s||!t)return 0;const e=s.length>t.length?s:t,n=s.length>t.length?t:s;if(e.length===0)return 1;const i=Iu(e,n);return(e.length-i)/e.length},Iu=(s,t)=>{const e=[];for(let n=0;n<=t.length;n++)e[n]=[n];for(let n=0;n<=s.length;n++)e[0][n]=n;for(let n=1;n<=t.length;n++)for(let i=1;i<=s.length;i++)t.charAt(n-1)===s.charAt(i-1)?e[n][i]=e[n-1][i-1]:e[n][i]=Math.min(e[n-1][i-1]+1,e[n][i-1]+1,e[n-1][i]+1);return e[t.length][s.length]},ma=(s="")=>{const t=(s||"").toLowerCase();return/account statement|bank statement|statement period|statement date/i.test(t)||/opening balance|closing balance|beginning balance|ending balance/i.test(t)||/transaction history|account activity|account summary/i.test(t)||/bdo|hsbc|metrobank|landbank|bpi|security bank|citibank/i.test(t)||/(date|description|amount|balance).+(date|description|amount|balance)/i.test(t)},Ru=(s="")=>{const t=(s||"").toLowerCase();return[/(?:store\s+)?receipt|sales slip|tax invoice/i,/(?:sub-?total|tax|amount|balance).+total/i,/(?:cashier|terminal|register|store)\s+#?\d/i,/qty|@|each|item|price.+\$?\d+\.\d{2}/i,/thank you|please come again|come again/i,/card\s+(?:auth|number|type)|approved/i].filter(i=>i.test(t)).length>=2&&!ma(t)&&t.length<2e3},ba=(s="",t="UNKNOWN",e={})=>{if(!s)return{formattedTransactions:[],summary:{},rawText:""};if(ma(s))switch((t||"").toUpperCase()){case"BDO":try{return Qi(s,e)}catch(n){console.warn("BDO parse failed",n)}break;case"HSBC":{if(ao(s)==="UK_BANK_STATEMENT")try{return so(s,e)}catch(i){console.warn("HSBC UK parse failed",i)}try{return eo(s,e)}catch(i){console.warn("HSBC PH parse failed",i)}break}case"METROBANK":try{return io(s,e)}catch(n){console.warn("Metrobank parse failed",n)}break;case"LANDBANK":try{return oo(s,e)}catch(n){console.warn("Landbank parse failed",n)}break}if(Ru(s))return parseReceiptFromText(s,e);switch((t||"").toUpperCase()){case"BDO":return Qi(s,e);case"HSBC":return ao(s)==="UK_BANK_STATEMENT"?so(s):eo(s,e);case"METROBANK":return io(s,e);case"LANDBANK":return oo(s,e);default:return{formattedTransactions:[],summary:{},rawText:s}}},Lu=async(s,t,e=!0)=>{var o,a,r;let n;try{n=await Pu()}catch(l){const c=`OCR functionality is disabled. Failed to retrieve API key: ${l.message}`;return{rawText:c,formattedTransactions:[],error:c,detectedBank:"UNKNOWN",summary:{}}}if(!n){const l="OCR functionality is disabled. API key could not be retrieved.";return{rawText:l,formattedTransactions:[],error:l,detectedBank:"UNKNOWN",summary:{}}}const i=new FormData;i.append("file",s),i.append("apikey",n),i.append("language","eng"),i.append("isOverlayRequired","false"),i.append("detectOrientation","true"),i.append("scale","true"),i.append("OCREngine","2"),i.append("isTable","true");try{console.log("🔍 PASS 1: Standard OCR extraction...");const l=await fetch("https://api.ocr.space/parse/image",{method:"POST",body:i});if(!l.ok){const d=await l.json().catch(()=>({ErrorMessage:["Failed to parse error response from OCR API."]}));let h=`OCR API request failed with status ${l.status}.`;return((o=d==null?void 0:d.ErrorMessage)==null?void 0:o.length)>0&&(h+=` Details: ${d.ErrorMessage.join(", ")}`),{rawText:h,formattedTransactions:[],error:h,detectedBank:"UNKNOWN",summary:{}}}const c=await l.json();if(c.IsErroredOnProcessing){const d=((a=c.ErrorMessage)==null?void 0:a.join(", "))||"Unknown processing error";return{rawText:`OCR processing error: ${d}`,formattedTransactions:[],error:`OCR processing error: ${d}`,detectedBank:"UNKNOWN",summary:{}}}if(c.ParsedResults&&((r=c.ParsedResults[0])!=null&&r.ParsedText)){const d=c.ParsedResults[0].ParsedText,h=t||Nu(d);let u=null,g;try{g=ba(d,h,s)}catch(b){console.error("parseWithBankParser failed, falling back to empty parseResult:",b),g={formattedTransactions:[],summary:{}}}console.log(`📊 PASS 1 Results: ${((g==null?void 0:g.formattedTransactions)||[]).length} transactions found`);const p=(g.formattedTransactions||[]).map(b=>{const x=pt.categorizeTransaction(b.description||b.merchant||"",b.amount);return{...b,category:x,ai_categorized:!0}});console.log(`🤖 AI Categorization: ${p.slice(0,3).map(b=>`${b.description} → ${b.category}`).join(", ")}`);let m={rawText:d,formattedTransactions:p,detectedBank:h,summary:g.summary||{},recoveryPerformed:!1,originalCount:p.length};if(e)try{const b=await Du(s,n,{rawText:d,formattedTransactions:m.formattedTransactions,detectedBank:h,summary:m.summary});if(b&&b.formattedTransactions){const x=b.formattedTransactions.map(y=>{if(!y.category||y.category==="uncategorized"){const _=pt.categorizeTransaction(y.description||y.merchant||"",y.amount);return{...y,category:_,ai_categorized:!0}}return y});m={...m,formattedTransactions:x,recoveryPerformed:b.recoveryPerformed||!0,recoveredCount:x.length-m.originalCount,summary:b.summary||m.summary}}}catch(b){console.warn("AI recovery step failed:",b)}return m}return{rawText:"",formattedTransactions:[],detectedBank:"UNKNOWN",summary:{}}}catch(l){return console.error("OCR request failed:",l),{rawText:"",formattedTransactions:[],error:l.message||String(l),detectedBank:"UNKNOWN",summary:{}}}},Fu="http://localhost:8000";async function fe(s,t){try{const e=await fetch(`${Fu}/api/insights`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transactions:s,feature:t,...t==="weekly_report"&&{days:28}})});if(!e.ok){const n=await e.json();throw new Error(n.detail||"Failed to get insights")}return await e.json()}catch(e){throw console.error("AI Insights API Error:",e),e.message?new Error(e.message):e}}const Ws=10,xa=5,Eu=xa*1024*1024,Bu=()=>f.jsx("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-8 rounded-md shadow-md dark:bg-[hsl(var(--boogasi-yellow))]/20 dark:text-[hsl(var(--brighter-yellow-text))] dark:border-[hsl(var(--boogasi-yellow))]",role:"alert",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(ho,{className:"h-6 w-6 mr-3"}),f.jsx("p",{className:"font-bold",children:"⚠️ This tool is for research purposes only. Boogasi does not provide financial advice. Learn more below."})]})}),Qu=()=>{var T;const{toast:s}=Ca(),{user:t}=Aa(),[e,n]=z.useState([]),[i,o]=z.useState(""),[a,r]=z.useState(null),[l,c]=z.useState(""),[d,h]=z.useState({}),[u,g]=z.useState(!1),[p,m]=z.useState(""),[b,x]=z.useState("Valued User"),[y,_]=z.useState(!1),[w,v]=z.useState(null);z.useEffect(()=>{t&&t.user_metadata&&x(t.user_metadata.name||t.user_metadata.screen_name||"Valued User")},[t]);const S=".csv, .pdf, .png, .jpeg, .jpg",C=["text/csv","application/pdf","image/png","image/jpeg"],M=z.useCallback(async k=>{const N=Array.from(k.target.files);let E=e.length;const D=[];for(const j of N){if(E>=Ws){s({variant:"destructive",title:"File Limit Reached",description:`Maximum of ${Ws} files allowed.`});break}if(!C.includes(j.type)&&!S.split(", ").some(L=>j.name.toLowerCase().endsWith(L))){s({variant:"destructive",title:"Invalid file type",description:`File "${j.name}" is not a valid type.`});continue}if(j.size>Eu){s({variant:"destructive",title:"File Too Large",description:`File "${j.name}" exceeds ${xa}MB limit.`});continue}D.push(j),E++}if(D.length===0){k.target&&(k.target.value=null);return}_(!0),m(`Processing ${D.length} file(s)... AI enhancement will be enabled.`),g(!0),m(`Processing ${D.length} file(s)... This may take a moment.`);const R=[];let B=0;try{for(const j of D){let L={file:j,rawText:null,formattedTransactions:[],error:null};if(j.type.startsWith("image/")||j.type==="application/pdf"){B++,m(`Boogasi AI is performing OCR & parsing transactions for ${j.name}...`);try{const{rawText:tt,formattedTransactions:V,error:it}=await Lu(j);L.rawText=tt,L.formattedTransactions=V||[],L.error=it,h(ot=>({...ot,[j.name]:{rawText:tt,formattedTransactions:V||[],error:it}}));let ct="OCR & Parsing Attempted by Boogasi AI.";it?ct=`OCR Error: ${it}`:ct=`Text extracted. Found ${V?V.length:0} potential transactions. Review results.`,s({title:`Processed: ${j.name}`,description:ct,duration:7e3})}catch(tt){console.error(`OCR & Parsing failed for ${j.name}:`,tt);const V=`OCR Error for ${j.name}: ${tt.message}`;s({variant:"destructive",title:"OCR & Parsing Failed",description:V,duration:7e3}),h(it=>({...it,[j.name]:{rawText:V,formattedTransactions:[],error:V}})),L.rawText=V,L.error=V}}R.push(L.file)}if(R.length>0){n(tt=>[...tt,...R].slice(0,Ws));const j=`${R.length} file(s) processed.`,L=B>0?` OCR & transaction parsing attempted by Boogasi AI on ${B} image/PDF file(s).`:"";s({title:"File Processing Complete",description:j+L+" 🤖 AI enhancement enabled!",duration:5e3})}}catch(j){console.error("Error during file processing loop:",j),s({variant:"destructive",title:"File Processing Error",description:"An unexpected error occurred while processing files.",duration:7e3})}finally{g(!1),m(""),k.target&&(k.target.value=null)}},[e,s,C,S]),P=z.useCallback(k=>{var E;const N=(E=e[k])==null?void 0:E.name;n(D=>D.filter((R,B)=>B!==k)),N&&h(D=>{const R={...D};return delete R[N],R}),s({title:"File Removed",description:`"${N}" has been removed.`})},[e,s]),O=async k=>{var N,E,D;g(!0),m("Analyzing your data...");try{const B={"Analyze Expenses":"expense_summary","Forecast Cash Flow":"cash_flow_forecast","Flag Unusual Transactions":"flag_unusual_transactions","Generate Weekly Report":"weekly_report","Combined Analysis":"combined_insights"}[k];if(!B)throw new Error(`Unknown action: ${k}`);const j=Object.values(d||{}).flatMap(L=>(L==null?void 0:L.formattedTransactions)||[]).filter(L=>L&&(L.date||L.description)&&typeof L.amount<"u");if(console.log("[AI] Sending transactions to backend:",j.slice(0,3)),B==="combined_insights"){m("Running all analyses... This may take a moment.");const[L,tt,V,it]=await Promise.all([fe(j,"expense_summary"),fe(j,"cash_flow_forecast"),fe(j,"flag_unusual_transactions"),fe(j,"weekly_report")]);console.log("🚨 Flagged transactions from API:",{flagged:V,hasFlagged:!!V,flaggedKeys:Object.keys(V||{}),flaggedArray:(V==null?void 0:V.flagged)||(V==null?void 0:V.flags)});const ct={feature:"combined_insights",generated_at:new Date().toISOString(),summary:{total_transactions:j.length,date_range:{start:(N=j[0])==null?void 0:N.date,end:(E=j[j.length-1])==null?void 0:E.date}},detailed_analyses:{expense_summary:L,cash_flow_forecast:tt,flagged_transactions:V,weekly_report:it}};console.log("📦 Combined result structure:",{hasFlagged:!!ct.detailed_analyses.flagged_transactions,flaggedData:ct.detailed_analyses.flagged_transactions});const ot={feature:"combined_insights",data:ct,transactions:j};console.log("📦 Setting combined analysis result:",{hasTransactions:!!ot.transactions,transactionCount:(D=ot.transactions)==null?void 0:D.length,hasFlagged:!!ot.data.detailed_analyses.flagged_transactions}),r(ot),s({title:"Combined Analysis Complete",description:"All financial analyses have been generated."})}else{const L=await fe(j,B);r({feature:B,data:L,transactions:j}),s({title:"Analysis Complete",description:`AI insights for "${k}" are ready.`})}}catch(R){console.error("Error during AI analysis:",R),s({variant:"destructive",title:"Analysis Failed",description:R.message||"An unexpected error occurred"})}finally{g(!1),m("")}};return f.jsxs(Vs.div,{className:"container mx-auto py-12 px-4 space-y-12 brighter-theme-area",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[f.jsx(za,{}),f.jsx(Bu,{}),f.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-start",children:[f.jsx(Ha,{selectedFiles:e,handleFileChange:M,removeFile:P,manualTransactions:i,setManualTransactions:o,acceptedFileTypes:S}),f.jsx(iu,{onAnalyze:O,isLoading:u,portfolioFeaturesResult:l})]}),a&&f.jsx(Vs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mt-8 w-full",children:f.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 border-2 border-indigo-200 rounded-lg p-6 shadow-lg",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-3xl font-bold text-indigo-900",children:"📊 Analysis Results"}),f.jsxs("p",{className:"text-sm text-indigo-600 mt-1",children:["Feature:"," ",(T=a.feature)==null?void 0:T.replace(/_/g," ").toUpperCase()," • Generated at ",new Date().toLocaleString()]})]}),f.jsx("button",{onClick:()=>r(null),className:"px-4 py-2 bg-white text-indigo-600 rounded-lg shadow hover:bg-indigo-50 transition-all font-semibold",children:"✕ Clear Results"})]}),f.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 w-full max-w-none",children:f.jsx(cu,{feature:a.feature,data:a.data})})]})}),w&&f.jsxs("div",{className:"mt-6 p-4 bg-red-50 border-2 border-red-200 rounded-lg text-red-700",children:[f.jsx("strong",{children:"⚠️ Error:"})," ",w]}),f.jsxs("div",{className:"mb-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 border-2 border-blue-300 rounded-lg shadow-md",children:[f.jsxs("label",{className:"flex items-center cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:y,onChange:k=>_(k.target.checked),className:"mr-3 w-6 h-6 accent-blue-600"}),f.jsxs("div",{children:[f.jsxs("span",{className:"font-bold text-blue-900 text-lg",children:["🤖 AI Enhancement ",y?"(Active)":"(Inactive)"]}),f.jsx("p",{className:"text-sm text-blue-700 mt-1",children:e.length>0?"✅ Auto-enabled with uploaded files • Trained on 5+ bank statements":"Automatically activates when you upload bank statements"})]})]}),y&&f.jsxs("div",{className:"mt-3 p-3 bg-green-50 border border-green-300 rounded",children:[f.jsxs("p",{className:"text-sm text-green-800 font-semibold",children:["✅ AI Active: ",Object.keys(pt.categories).length," ","categories • Version ",pt.trainingData.version]}),pt.modelArtifacts&&f.jsxs("div",{className:"mt-2 text-xs text-green-700",children:["🤖 Trained Model: ",pt.modelArtifacts.version," •",pt.modelArtifacts.training_samples," datasets •",pt.modelArtifacts.total_transactions," transactions learned"]})]})]}),f.jsxs("div",{className:"mt-12 space-y-6",children:[f.jsx(au,{}),f.jsx(ru,{})]}),f.jsx(ou,{}),f.jsx("div",{className:"text-center",children:f.jsxs(ft,{variant:"neonGreen",size:"lg",onClick:()=>{var k;return(k=document.getElementById("transactions-file-input"))==null?void 0:k.click()},children:[f.jsx(co,{className:"mr-2 h-5 w-5"}),"Upload Files"]})})]})};export{Qu as default};
