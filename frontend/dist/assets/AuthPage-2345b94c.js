import{c as B,u as r,E as T,w as R,G as M,b2 as D,j as e,m as I,p as h,I as g,L as G,a as N,q as P,x as L,b1 as U,a0 as H,b3 as Y,M as J}from"./index-26d6c1e3.js";import{T as Z,a as K,b as _,c as $}from"./tabs-2c515742.js";import{C as Q,a as X,b as ee,d as se,c as ae}from"./card-024815dc.js";import{o as V,s as n,u as O,t as W,l as F}from"./types-693d289f.js";import{E as re}from"./eye-off-4bedc2aa.js";import{E as te}from"./eye-375d223a.js";import{C as ie}from"./cpu-f8b32355.js";const oe=B("MailWarning",[["path",{d:"M22 10.5V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h12.5",key:"e61zoh"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"M20 14v4",key:"1hm744"}],["path",{d:"M20 22v.01",key:"12bgn6"}]]),ne=V({email:n().email({message:"Invalid email address."}),password:n().min(6,{message:"Password must be at least 6 characters."})}),le=()=>{var C,q;const[l,i]=r.useState(!1),[s,o]=r.useState(!1),[t,c]=r.useState(!1),[v,m]=r.useState(!1),[y,j]=r.useState(""),{login:d}=T(),{toast:k}=R(),p=M(),S=((q=(C=D().state)==null?void 0:C.from)==null?void 0:q.pathname)||"/profile",{register:E,handleSubmit:a,formState:{errors:x},getValues:w}=O({resolver:W(ne)}),u=async b=>{i(!0),m(!1);try{await d(b.email,b.password),p(S,{replace:!0})}catch(z){z.message.toLowerCase().includes("email not confirmed")&&(m(!0),j(b.email))}finally{i(!1)}},f=async()=>{if(y){o(!0);try{const{error:b}=await L.auth.resend({type:"signup",email:y});if(b)throw b;k({title:"Confirmation Email Resent!",description:`A new confirmation link has been sent to ${y}. Please check your inbox and spam folder.`,duration:9e3}),m(!1)}catch(b){k({variant:"destructive",title:"Failed to Resend Email",description:b.message||"An unexpected error occurred. Please try again later."})}finally{o(!1)}}};return e.jsxs(I.form,{onSubmit:a(u),className:"space-y-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"email-login",className:"text-foreground",children:"Email"}),e.jsx(g,{id:"email-login",type:"email",placeholder:"you@example.com",...E("email"),className:`bg-input border-border focus:border-[hsl(var(--brighter-blue))] focus:ring-[hsl(var(--brighter-blue))] ${x.email?"border-destructive":""}`}),x.email&&e.jsx("p",{className:"text-sm text-destructive",children:x.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{htmlFor:"password-login",className:"text-foreground",children:"Password"}),e.jsx(G,{to:"/auth?type=forgot-password",className:"text-sm text-[hsl(var(--brighter-pink))] hover:underline",children:"Forgot password?"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"password-login",type:t?"text":"password",placeholder:"••••••••",...E("password"),className:`bg-input border-border focus:border-[hsl(var(--brighter-blue))] focus:ring-[hsl(var(--brighter-blue))] ${x.password?"border-destructive":""}`}),e.jsx(N,{type:"button",variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 text-muted-foreground hover:text-foreground",onClick:()=>c(!t),children:t?e.jsx(re,{className:"h-4 w-4"}):e.jsx(te,{className:"h-4 w-4"})})]}),x.password&&e.jsx("p",{className:"text-sm text-destructive",children:x.password.message})]}),v&&e.jsx(I.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-2",children:e.jsxs(N,{type:"button",variant:"outline",className:"w-full border-yellow-500 text-yellow-500 hover:bg-yellow-500/10 hover:text-yellow-400",onClick:f,disabled:s,children:[s?e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Resend Confirmation Email"]})}),e.jsxs(N,{type:"submit",className:"w-full bg-gradient-to-r from-[hsl(var(--brighter-blue))] to-[hsl(var(--brighter-teal))] hover:opacity-90 transition-opacity duration-300 text-primary-foreground",disabled:l,children:[l?e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Log In"]})]})},ce=V({name:n().min(2,{message:"Name must be at least 2 characters."}),screenName:n().min(3,{message:"Screen name must be at least 3 characters."}).max(30,{message:"Screen name cannot exceed 30 characters."}).regex(/^[a-zA-Z0-9_]+$/,{message:"Screen name can only contain letters, numbers, and underscores."}),email:n().email({message:"Invalid email address."}),password:n().min(8,{message:"Password must be at least 8 characters."}),company:n().min(2,{message:"Company name is required."}).optional().or(F("")),role:n().min(2,{message:"Your role is required."}).optional().or(F("")),country:n().min(2,{message:"Country is required (e.g., United States)."}).optional().or(F("")),stateProvince:n().min(2,{message:"State/Province is required (e.g., California)."}).optional().or(F(""))}),me=()=>{const{register:l,loading:i}=T(),{toast:s}=R(),[o]=U(),[t,c]=r.useState(""),[v,m]=r.useState(!1),[y,j]=r.useState(null),[d,k]=r.useState(!1),{register:p,handleSubmit:A,setError:S,setValue:E,formState:{errors:a}}=O({resolver:W(ce)});r.useEffect(()=>{const w=o.get("invite_token");w&&(j(w),(async()=>{const{data:f,error:C}=await L.from("project_invitations").select("invited_email").eq("token",w).eq("status","pending").single();C||!f?s({variant:"destructive",title:"Invalid Invitation",description:"This invitation link is invalid or has expired."}):(E("email",f.invited_email,{shouldValidate:!0}),k(!0),s({title:"Invitation Found!",description:`You've been invited! Please complete your registration for ${f.invited_email}.`}))})())},[o,E,s]);const x=async w=>{c(""),m(!0);try{const{data:u,error:f}=await L.from("profiles").select("screen_name").eq("screen_name",w.screenName).maybeSingle();if(f&&f.code!=="PGRST116")throw new Error("Could not verify screen name. Please try again.");if(u){S("screenName",{type:"manual",message:"This screen name is already taken."}),s({variant:"destructive",title:"Registration Failed",description:"Screen name already taken."}),m(!1);return}await l(w,y)}catch(u){u.message.includes("Email rate limit exceeded")?c("Too many registration attempts. Please try again later."):u.message.toLowerCase().includes("user already registered")?S("email",{type:"manual",message:"This email is already registered. Please log in."}):u.message.includes("Screen name already taken")?S("screenName",{type:"manual",message:"This screen name is already taken."}):c(u.message||"An unexpected error occurred during registration.")}finally{m(!1)}};return e.jsxs("form",{onSubmit:A(x),className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"name-register",className:"text-foreground",children:"Full Name"}),e.jsx(g,{id:"name-register",...p("name"),placeholder:"e.g., Jane Doe",className:"bg-input border-border focus:border-[hsl(var(--brighter-blue))] focus:ring-[hsl(var(--brighter-blue))]"}),a.name&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.name.message})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"screenName-register",className:"text-foreground",children:"Screen Name (Public)"}),e.jsx(g,{id:"screenName-register",...p("screenName"),placeholder:"e.g., InvestorPro_123",className:"bg-input border-border focus:border-[hsl(var(--brighter-blue))] focus:ring-[hsl(var(--brighter-blue))]"}),a.screenName&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.screenName.message})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"email-register",className:"text-foreground",children:"Email"}),e.jsx(g,{id:"email-register",type:"email",...p("email"),placeholder:"you@example.com",className:"bg-input border-border focus:border-[hsl(var(--brighter-blue))] focus:ring-[hsl(var(--brighter-blue))]",disabled:d}),a.email&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.email.message})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"password-register",className:"text-foreground",children:"Password"}),e.jsx(g,{id:"password-register",type:"password",...p("password"),placeholder:"Min. 8 characters",className:"bg-input border-border focus:border-[hsl(var(--brighter-blue))] focus:ring-[hsl(var(--brighter-blue))]"}),a.password&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.password.message})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"company-register",className:"text-foreground",children:"Company (Optional)"}),e.jsx(g,{id:"company-register",...p("company"),placeholder:"e.g., Acme Inc.",className:"bg-input border-border focus:border-[hsl(var(--brighter-blue))] focus:ring-[hsl(var(--brighter-blue))]"}),a.company&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.company.message})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"role-register",className:"text-foreground",children:"Role (Optional)"}),e.jsx(g,{id:"role-register",...p("role"),placeholder:"e.g., Founder, Legal Counsel",className:"bg-input border-border focus:border-[hsl(var(--brighter-blue))] focus:ring-[hsl(var(--brighter-blue))]"}),a.role&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.role.message})]}),t&&e.jsx("p",{className:"text-sm text-destructive text-center",children:t}),e.jsxs(N,{type:"submit",className:"w-full bg-gradient-to-r from-[hsl(var(--brighter-blue))] to-[hsl(var(--brighter-teal))] hover:opacity-90 text-primary-foreground",disabled:v||i,children:[v||i?e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(H,{className:"mr-2 h-4 w-4"}),"Register"]})]})},de=()=>{const[l,i]=r.useState(""),[s,o]=r.useState(!1),[t,c]=r.useState(""),{toast:v}=R(),m=M(),y=async j=>{j.preventDefault(),o(!0),c("");try{const{error:d}=await L.auth.resetPasswordForEmail(l,{redirectTo:`${window.location.origin}/reset-password`});if(d)throw d;c("Password reset email sent! Please check your inbox."),v({title:"Success",description:"Password reset email sent. Please check your inbox (and spam folder)."})}catch(d){c(`Error: ${d.message}`),v({variant:"destructive",title:"Error",description:d.message})}finally{o(!1)}};return e.jsxs(I.form,{onSubmit:y,className:"space-y-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"email-forgot",children:"Email"}),e.jsx(g,{id:"email-forgot",type:"email",placeholder:"you@example.com",value:l,onChange:j=>i(j.target.value),required:!0})]}),t&&e.jsx("p",{className:`text-sm ${t.startsWith("Error")?"text-destructive":"text-[var(--brighter-green-text)]"}`,children:t}),e.jsxs(N,{type:"submit",className:"w-full",variant:"default",disabled:s,children:[" ",s?e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(J,{className:"mr-2 h-4 w-4"}),"Send Reset Link"]}),e.jsxs(N,{variant:"link",className:"w-full",onClick:()=>m("/auth?type=login"),children:[" ","Back to Login"]})]})},ve=()=>{const[l]=U(),i=l.get("type")||"login",{user:s,loading:o}=T(),t=M();return r.useEffect(()=>{!o&&s&&t("/profile",{replace:!0})},[s,o,t]),o?e.jsxs("div",{className:"flex justify-center items-center h-screen",children:[e.jsx(P,{className:"h-12 w-12 animate-spin text-[var(--primary)]"})," "]}):s?e.jsx(Y,{to:"/profile",replace:!0}):e.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-200px)] py-12 brighter-theme-area",children:e.jsx(I.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.7,ease:"easeOut"},className:"w-full max-w-md",children:e.jsxs(Q,{className:"shadow-2xl",children:[e.jsxs(X,{className:"text-center",children:[e.jsxs("div",{className:"flex justify-center items-center mb-4",children:[e.jsx(ie,{className:"h-12 w-12 text-[var(--primary)] animate-pulse"})," "]}),e.jsxs(ee,{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-[var(--primary)] via-[var(--secondary)] to-[var(--accent)]",children:[" ",i==="forgot-password"?"Reset Password":"Welcome to Boogasi AI"]}),e.jsx(se,{children:i==="forgot-password"?"Enter your email to receive a password reset link.":"Access your AI-powered investment hub or create an account."})]}),e.jsx(ae,{children:i==="forgot-password"?e.jsx(de,{}):e.jsx(e.Fragment,{children:e.jsxs(Z,{defaultValue:i,className:"w-full pt-6",children:[e.jsxs(K,{className:"grid w-full grid-cols-2 mb-6",children:[e.jsx(_,{value:"login",children:"Log In"}),e.jsx(_,{value:"register",children:"Sign Up"})]}),e.jsx($,{value:"login",children:e.jsx(le,{})}),e.jsx($,{value:"register",children:e.jsx(me,{})})]})})})]})})})};export{ve as default};
