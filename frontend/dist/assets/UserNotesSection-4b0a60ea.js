import{c as w,w as L,u as a,x as d,j as e,q as v,a as o,D as E,l as _,n as I,o as U,s as O,p as g,I as q,t as P}from"./index-b765cb56.js";import{C as F,a as z,b as A,d as H,c as V,e as B}from"./card-e310dec2.js";import{T as J}from"./textarea-963d3648.js";import{P as R}from"./plus-circle-8f4a9924.js";const Y=w("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Z=w("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),X=({user:l})=>{const{toast:r}=L(),[x,C]=a.useState([]),[D,n]=a.useState(!1),[i,p]=a.useState(null),[c,h]=a.useState(""),[N,u]=a.useState(""),[j,f]=a.useState(!1),[b,y]=a.useState(!0);a.useEffect(()=>{l&&m()},[l]);const m=async()=>{try{y(!0);const{data:t,error:s}=await d.from("user_notes").select("*").eq("user_id",l.id).order("updated_at",{ascending:!1});if(s)throw s;C(t||[])}catch(t){r({variant:"destructive",title:"Error fetching notes",description:t.message})}finally{y(!1)}},S=()=>{p(null),h(""),u(""),n(!0)},k=t=>{var s;p(t),h(t.title),u(((s=t.content)==null?void 0:s.text)||""),n(!0)},T=async()=>{if(!c.trim()){r({variant:"destructive",title:"Title is required"});return}f(!0);try{const t={user_id:l.id,title:c,content:{text:N},updated_at:new Date().toISOString()};if(i){const{error:s}=await d.from("user_notes").update(t).eq("id",i.id);if(s)throw s;r({title:"Note Updated"})}else{const{error:s}=await d.from("user_notes").insert(t);if(s)throw s;r({title:"Note Created"})}n(!1),m()}catch(t){r({variant:"destructive",title:"Error saving note",description:t.message})}finally{f(!1)}},M=async t=>{if(window.confirm("Are you sure you want to delete this note?"))try{const{error:s}=await d.from("user_notes").delete().eq("id",t);if(s)throw s;r({title:"Note Deleted"}),m()}catch(s){r({variant:"destructive",title:"Error deleting note",description:s.message})}};return b?e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx(v,{className:"h-8 w-8 animate-spin text-[var(--primary)]"})}):e.jsxs("section",{className:"brighter-theme-area",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2 border-[var(--brighter-border)]",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"My Notes"}),e.jsxs(o,{variant:"outline",size:"sm",onClick:S,children:[e.jsx(R,{className:"mr-2 h-4 w-4"})," Add New Note"]})]}),e.jsx(E,{open:D,onOpenChange:n,children:e.jsxs(_,{className:"sm:max-w-lg",children:[e.jsxs(I,{children:[e.jsx(U,{children:i?"Edit Note":"Create New Note"}),e.jsx(O,{children:i?"Update your existing note.":"Jot down your thoughts, ideas, or plans."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"note-title",children:"Title"}),e.jsx(q,{id:"note-title",value:c,onChange:t=>h(t.target.value),placeholder:"My Awesome Idea"})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"note-content",children:"Content"}),e.jsx(J,{id:"note-content",value:N,onChange:t=>u(t.target.value),placeholder:"Details about my idea...",rows:8})]})]}),e.jsxs(P,{children:[e.jsx(o,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsxs(o,{onClick:T,disabled:j,variant:"default",children:[j&&e.jsx(v,{className:"mr-2 h-4 w-4 animate-spin"}),i?"Update Note":"Save Note"]})]})]})}),x.length>0?e.jsx("div",{className:"space-y-3",children:x.map(t=>{var s;return e.jsxs(F,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(z,{children:[e.jsx(A,{className:"text-lg",children:t.title}),e.jsxs(H,{children:["Last updated: ",new Date(t.updated_at).toLocaleDateString()]})]}),e.jsx(V,{children:e.jsx("p",{className:"text-sm line-clamp-3",children:((s=t.content)==null?void 0:s.text)||"No content."})}),e.jsxs(B,{className:"flex justify-end space-x-2",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>k(t),children:[e.jsx(Y,{className:"mr-1 h-3 w-3"})," Edit"]}),e.jsxs(o,{variant:"destructive",size:"sm",onClick:()=>M(t.id),children:[e.jsx(Z,{className:"mr-1 h-3 w-3"})," Delete"]})]})]},t.id)})}):e.jsx("p",{className:"text-center py-4",children:"You haven't added any notes yet."})]})};export{Y as P,Z as T,X as U};
