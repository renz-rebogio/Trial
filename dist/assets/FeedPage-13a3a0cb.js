import{c as B,al as ge,am as pe,an as q,ao as K,ap as Q,aq as J,ar as ee,d as te,w as $,u,x as M,j as e,a as k,F as W,q as H,as as ve,D as Ne,l as je,n as be,o as _e,s as ye,A as re,h as ie,i as ne,t as we,G as le,ai as Ce,at as ke,m as oe,ah as Se,au as Pe,H as Me,Z as ze,aj as Fe,E as Ee}from"./index-59f5f71c.js";import{T as ce}from"./textarea-e62d43bd.js";import{C as L,a as U,b as T,c as O,d as de,e as me}from"./card-b8828134.js";import{X as Y}from"./x-circle-3542237b.js";import{V as Re}from"./video-e62a3e1e.js";import{U as Ie}from"./UserNotesSection-166f3748.js";import{R as he}from"./refresh-cw-2c06bf13.js";import{F as De}from"./filter-b020ee7e.js";import{c as Ae,g as Le,a as Ue}from"./getRoundingMethod-20b9baab.js";import{M as Te}from"./message-square-1223fc40.js";import"./plus-circle-3fa46472.js";const Oe=B("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),Be=B("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),ue=B("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]),$e=B("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),Ve=B("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);function qe(t,r,i){const m=ge(),_=(i==null?void 0:i.locale)??m.locale??pe,x=Ae(t,r);if(isNaN(x))throw new RangeError("Invalid time value");const p=Object.assign({},i,{addSuffix:i==null?void 0:i.addSuffix,comparison:x});let j,N;x>0?(j=q(r),N=q(t)):(j=q(t),N=q(r));const g=Le((i==null?void 0:i.roundingMethod)??"round"),b=N.getTime()-j.getTime(),y=b/te,S=K(N)-K(j),c=(b-S)/te,w=i==null?void 0:i.unit;let v;if(w?v=w:y<1?v="second":y<60?v="minute":y<Q?v="hour":c<J?v="day":c<ee?v="month":v="year",v==="second"){const f=g(b/1e3);return _.formatDistance("xSeconds",f,p)}else if(v==="minute"){const f=g(y);return _.formatDistance("xMinutes",f,p)}else if(v==="hour"){const f=g(y/60);return _.formatDistance("xHours",f,p)}else if(v==="day"){const f=g(c/Q);return _.formatDistance("xDays",f,p)}else if(v==="month"){const f=g(c/J);return f===12&&w!=="month"?_.formatDistance("xYears",1,p):_.formatDistance("xMonths",f,p)}else{const f=g(c/ee);return _.formatDistance("xYears",f,p)}}function He(t,r){return qe(t,Ue(t),r)}const G=10,se="boogasi",Ze=t=>{const{toast:r}=$(),[i,m]=u.useState([]),[_,x]=u.useState(!0),[p,j]=u.useState(1),[N,g]=u.useState(!0),[b,y]=u.useState("latest"),S=u.useCallback(async(a=1,l=!1)=>{if(!N&&!l&&a>1)return;x(!0);const s=(a-1)*G,o=a*G-1;try{let n=M.from("posts").select(`
              *,
              profiles (id, screen_name, name, avatar_url),
              listings (id, title, amount_sought),
              digital_products (id, title, price),
              post_reactions (id, user_id, reaction_type),
              post_comments (id, user_id, content, created_at, profiles (screen_name, name, avatar_url)),
              reposts (id, user_id)
            `).range(s,o);b==="latest"?n=n.order("created_at",{ascending:!1}):b==="popular"&&(n=n.order("created_at",{ascending:!1}),r({title:"Popular filter coming soon!",description:"Showing latest posts for now."}));const{data:d,error:C}=await n;if(C)throw C;m(F=>l?d||[]:[...F,...d||[]]),j(a),g((d||[]).length===G)}catch(n){console.error("Error fetching posts:",n),r({variant:"destructive",title:"Error fetching posts",description:n.message})}finally{x(!1)}},[r,b,N]),c=u.useCallback(()=>{m([]),j(1),g(!0),S(1,!0)},[S]);u.useEffect(()=>{t&&c()},[t,b,c]);const w=async(a,l)=>{if(!a||!t)return null;const s=a.name.split(".").pop(),o=`${l}/${t.id}/${Date.now()}.${s}`,{data:n,error:d}=await M.storage.from(se).upload(o,a,{contentType:a.type});if(d)throw d;return M.storage.from(se).getPublicUrl(n.path).data.publicUrl};return{posts:i,isLoadingPosts:_,hasMorePosts:N,filter:b,setFilter:y,handleRefreshPosts:c,handlePostCreated:async a=>{if(!t||!t.id){r({variant:"destructive",title:"Authentication Error",description:"User ID is missing. Cannot create post."});return}let l=null,s=null,o=null,n=null,d=null;a.imageFile&&(l=await w(a.imageFile,"feed_images")),a.videoFile&&(s=await w(a.videoFile,"feed_videos")),a.otherFile&&(o=await w(a.otherFile,"feed_files"),n=a.otherFile.name,d=a.otherFile.type);const{data:C,error:F}=await M.from("posts").insert({user_id:t.id,content:a.content,image_upload_url:l,video_upload_url:s,file_upload_url:o,file_upload_name:n,file_upload_type:d}).select("*, profiles (id, screen_name, name, avatar_url), post_reactions(*), post_comments(*), reposts(*)").single();if(F)throw console.error("Error in handlePostCreated (insert):",F),F;m(h=>[C,...h]),b!=="latest"&&c()},handleReaction:async(a,l)=>{var o;if(!t||!t.id){r({variant:"destructive",title:"Not Logged In"});return}const s=(o=i.find(n=>n.id===a))==null?void 0:o.post_reactions.find(n=>n.user_id===t.id&&n.reaction_type===l);try{s?await M.from("post_reactions").delete().match({id:s.id}):await M.from("post_reactions").insert({post_id:a,user_id:t.id,reaction_type:l});const n=i.map(d=>{if(d.id===a){let C=[...d.post_reactions||[]];return s?C=C.filter(F=>F.id!==s.id):C.push({user_id:t.id,reaction_type:l,post_id:a,id:`temp-${Date.now()}`}),{...d,post_reactions:C}}return d});m(n)}catch(n){console.error("Error in handleReaction:",n),r({variant:"destructive",title:"Error Reacting",description:n.message}),c()}},handleCommentSubmit:async(a,l)=>{if(!t||!t.id||!l.trim())return null;try{const{data:s,error:o}=await M.from("post_comments").insert({post_id:a,user_id:t.id,content:l}).select("*, profiles(screen_name, name, avatar_url)").single();if(o)throw o;const n=i.map(d=>d.id===a?{...d,post_comments:[...d.post_comments||[],s]}:d);return m(n),r({title:"Comment Posted!"}),s}catch(s){return console.error("Error in handleCommentSubmit:",s),r({variant:"destructive",title:"Error Posting Comment",description:s.message}),null}},handleRepost:async a=>{var s;if(!t||!t.id){r({variant:"destructive",title:"Not Logged In"});return}const l=(s=i.find(o=>o.id===a))==null?void 0:s.reposts.find(o=>o.user_id===t.id);try{l?(await M.from("reposts").delete().match({user_id:t.id,original_post_id:a}),r({title:"Repost Removed"})):(await M.from("reposts").insert({original_post_id:a,user_id:t.id}),r({title:"Post Reposted!"}));const o=i.map(n=>{if(n.id===a){let d=[...n.reposts||[]];return l?d=d.filter(C=>!(C.user_id===t.id&&C.original_post_id===a)):d.push({user_id:t.id,original_post_id:a,id:`temp-repost-${Date.now()}`}),{...n,reposts:d}}return n});m(o)}catch(o){console.error("Error in handleRepost:",o),r({variant:"destructive",title:"Error Reposting",description:o.message}),c()}},fetchNextPage:()=>S(p+1)}},Xe=t=>{const{toast:r}=$(),[i,m]=u.useState([]),[_,x]=u.useState(!1),[p,j]=u.useState(null),[N,g]=u.useState(""),[b,y]=u.useState(""),[S,c]=u.useState(!1),w=u.useCallback(async()=>{if(t)try{const{data:a,error:l}=await M.from("user_notes").select("*").eq("user_id",t.id).order("updated_at",{ascending:!1});if(l)throw l;m(a||[])}catch(a){r({variant:"destructive",title:"Error fetching notes",description:a.message})}},[t,r]);return u.useEffect(()=>{w()},[w]),{userNotes:i,isNoteModalOpen:_,setIsNoteModalOpen:x,currentNote:p,noteTitle:N,setNoteTitle:g,noteContent:b,setNoteContent:y,savingNote:S,handleOpenNewNoteModal:()=>{j(null),g(""),y(""),x(!0)},handleOpenEditNoteModal:a=>{var l;j(a),g(a.title),y(((l=a.content)==null?void 0:l.text)||""),x(!0)},handleSaveNote:async()=>{if(!t||!N.trim()){r({variant:"warning",title:"Missing Title"});return}c(!0);try{const a={user_id:t.id,title:N,content:{text:b},updated_at:new Date().toISOString()};if(p){const{data:l,error:s}=await M.from("user_notes").update(a).eq("id",p.id).select().single();if(s)throw s;m(i.map(o=>o.id===l.id?l:o))}else{const{data:l,error:s}=await M.from("user_notes").insert(a).select().single();if(s)throw s;m([l,...i])}x(!1),r({title:"Note Saved!"})}catch(a){r({variant:"destructive",title:"Error saving note",description:a.message})}finally{c(!1)}},handleDeleteNote:async a=>{if(window.confirm("Are you sure?"))try{await M.from("user_notes").delete().eq("id",a),m(i.filter(l=>l.id!==a)),r({title:"Note Deleted"})}catch(l){r({variant:"destructive",title:"Error deleting note",description:l.message})}}}},fe=10,xe=25,Ye=fe*1024*1024,ae=xe*1024*1024,Ge=({user:t,onPostCreated:r})=>{var C,F;const{toast:i}=$(),[m,_]=u.useState(""),[x,p]=u.useState(!1),[j,N]=u.useState(null),[g,b]=u.useState(null),[y,S]=u.useState(null),[c,w]=u.useState(null),[v,f]=u.useState(""),[z,E]=u.useState(""),a=u.useRef(null),l=u.useRef(null),s=u.useRef(null),o=(h,I,D,Z,A)=>{const R=h.target.files[0];if(R){if(R.size>Z){i({variant:"destructive",title:"File Too Large",description:`${A} exceeds ${A==="Image"||A==="Video"?xe:fe}MB limit.`}),h.target.value=null;return}if(I(R),A==="Image"&&D){const P=new FileReader;P.onloadend=()=>D(P.result),P.readAsDataURL(R)}else D&&D(R.name)}},n=h=>{h==="image"&&(N(null),w(null),a.current&&(a.current.value=null)),h==="video"&&(b(null),f(""),l.current&&(l.current.value=null)),h==="file"&&(S(null),E(""),s.current&&(s.current.value=null))},d=async()=>{if(!m.trim()&&!j&&!g&&!y){i({variant:"warning",title:"Empty Post",description:"Please write something or add media."});return}if(!t){i({variant:"destructive",title:"Not Logged In",description:"Please log in to post."});return}p(!0);const h={content:m,imageFile:j,videoFile:g,otherFile:y};try{await r(h),_(""),n("image"),n("video"),n("file"),i({title:"Post Created!",description:"Your post is now live on the feed."})}catch(I){i({variant:"destructive",title:"Error Creating Post",description:I.message})}finally{p(!1)}};return e.jsxs(L,{className:"shadow-lg feed-create-post-form",children:[e.jsx(U,{children:e.jsx(T,{className:"text-feed-primary",children:"Create Post"})}),e.jsxs(O,{children:[e.jsx(ce,{placeholder:`What's on your mind, ${((C=t==null?void 0:t.user_metadata)==null?void 0:C.screen_name)||((F=t==null?void 0:t.user_metadata)==null?void 0:F.name)||"User"}?`,value:m,onChange:h=>_(h.target.value),rows:3,className:"mb-3 bg-input border-border text-foreground placeholder:text-muted-foreground"}),c&&e.jsxs("div",{className:"my-2 relative w-32 h-32",children:[e.jsx("img",{src:c,alt:"Preview",className:"rounded object-cover w-full h-full"}),e.jsx(k,{variant:"ghost",size:"icon",className:"absolute top-0 right-0 bg-black/50 text-white hover:bg-black/70 h-6 w-6",onClick:()=>n("image"),children:e.jsx(Y,{size:16})})]}),v&&e.jsxs("div",{className:"my-2 text-sm flex items-center text-foreground",children:["Video: ",v," ",e.jsx(k,{variant:"ghost",size:"icon",className:"ml-2 text-destructive h-6 w-6",onClick:()=>n("video"),children:e.jsx(Y,{size:16})})]}),z&&e.jsxs("div",{className:"my-2 text-sm flex items-center text-foreground",children:["File: ",z," ",e.jsx(k,{variant:"ghost",size:"icon",className:"ml-2 text-destructive h-6 w-6",onClick:()=>n("file"),children:e.jsx(Y,{size:16})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex space-x-1",children:[e.jsxs(k,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-feed-primary",onClick:()=>{var h;return(h=a.current)==null?void 0:h.click()},children:[e.jsx(Be,{size:20}),e.jsx("input",{type:"file",ref:a,onChange:h=>o(h,N,w,ae,"Image"),accept:"image/*",hidden:!0})]}),e.jsxs(k,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-feed-primary",onClick:()=>{var h;return(h=l.current)==null?void 0:h.click()},children:[e.jsx(Re,{size:20}),e.jsx("input",{type:"file",ref:l,onChange:h=>o(h,b,f,ae,"Video"),accept:"video/*",hidden:!0})]}),e.jsxs(k,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-feed-primary",onClick:()=>{var h;return(h=s.current)==null?void 0:h.click()},children:[e.jsx(W,{size:20}),e.jsx("input",{type:"file",ref:s,onChange:h=>o(h,S,E,Ye,"File"),accept:".*",hidden:!0})]})]}),e.jsxs(k,{onClick:d,disabled:x||!m.trim()&&!j&&!g&&!y,className:"bg-feed-primary hover:bg-feed-primary/90 text-primary-foreground",children:[x?e.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ve,{className:"mr-2 h-4 w-4"})," Post"]})]})]})]})},We=({isOpen:t,setIsOpen:r,post:i,user:m,onSubmitComment:_})=>{var b,y,S;const[x,p]=u.useState(""),[j,N]=u.useState(!1),g=async()=>{if(!(!m||!i||!x.trim())){N(!0);try{await _(i.id,x),p("")}finally{N(!1)}}};return i?e.jsx(Ne,{open:t,onOpenChange:r,children:e.jsxs(je,{className:"sm:max-w-lg bg-[hsl(var(--feed-card-bg-brighter))] text-card-foreground border-[hsl(var(--feed-primary-brighter))]/50",children:[e.jsxs(be,{children:[e.jsxs(_e,{className:"text-[hsl(var(--feed-primary-brighter))]",children:["Comment on ",(b=i.profiles)==null?void 0:b.screen_name,"'s post"]}),e.jsx(ye,{className:"whitespace-pre-wrap line-clamp-3 text-muted-foreground",children:i.content})]}),e.jsxs("div",{className:"py-2 max-h-60 overflow-y-auto",children:[(y=i.post_comments)==null?void 0:y.map(c=>{var w,v,f,z;return e.jsxs("div",{className:"mb-2 p-2 border border-[hsl(var(--feed-secondary-brighter))]/30 rounded-md bg-background/50 text-sm",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsxs(re,{className:"h-6 w-6 mr-2 border-[hsl(var(--feed-primary-brighter))] border",children:[e.jsx(ie,{src:(w=c.profiles)==null?void 0:w.avatar_url}),e.jsx(ne,{className:"bg-[hsl(var(--feed-secondary-brighter))] text-secondary-foreground",children:((f=(v=c.profiles)==null?void 0:v.screen_name)==null?void 0:f.substring(0,1).toUpperCase())||"U"})]}),e.jsx("span",{className:"font-semibold text-[hsl(var(--feed-primary-brighter))] text-xs",children:((z=c.profiles)==null?void 0:z.screen_name)||"User"}),e.jsx("span",{className:"text-muted-foreground text-xs ml-2",children:new Date(c.created_at).toLocaleTimeString()})]}),e.jsx("p",{className:"text-foreground pl-8 text-xs",children:c.content})]},c.id)}),((S=i.post_comments)==null?void 0:S.length)===0&&e.jsx("p",{className:"text-muted-foreground text-sm text-center",children:"No comments yet. Be the first!"})]}),e.jsx(ce,{value:x,onChange:c=>p(c.target.value),placeholder:"Write a comment...",className:"bg-input text-foreground placeholder:text-muted-foreground border-[hsl(var(--feed-secondary-brighter))]/50 focus:border-[hsl(var(--feed-primary-brighter))]"}),e.jsxs(we,{children:[e.jsx(k,{variant:"outline",onClick:()=>r(!1),className:"border-[hsl(var(--feed-secondary-brighter))] text-foreground hover:bg-muted",children:"Cancel"}),e.jsxs(k,{onClick:g,disabled:j||!x.trim(),className:"bg-[hsl(var(--feed-primary-brighter))] text-primary-foreground hover:bg-[hsl(var(--feed-primary-brighter))]/90",children:[j&&e.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}),"Comment"]})]})]})}):null},Ke=({userNotes:t,isNoteModalOpen:r,setIsNoteModalOpen:i,currentNote:m,noteTitle:_,setNoteTitle:x,noteContent:p,setNoteContent:j,handleSaveNote:N,savingNote:g,handleOpenNewNoteModal:b,handleOpenEditNoteModal:y,handleDeleteNote:S,filter:c,setFilter:w})=>{const v=le(),{toast:f}=$();return e.jsxs("aside",{className:"lg:col-span-3 space-y-6",children:[e.jsxs(L,{className:"shadow-xl",children:[e.jsxs(U,{children:[e.jsx(T,{className:"text-[hsl(var(--boogasi-green-val))]",children:"My Notes"}),e.jsx(de,{children:"Quick personal notes."})]}),e.jsx(O,{className:"max-h-96 overflow-y-auto",children:e.jsx(Ie,{userNotes:t.slice(0,3),isNoteModalOpen:r,setIsNoteModalOpen:i,currentNote:m,noteTitle:_,setNoteTitle:x,noteContent:p,setNoteContent:j,handleSaveNote:N,savingNote:g,handleOpenNewNoteModal:b,handleOpenEditNoteModal:y,handleDeleteNote:S})}),e.jsx(me,{children:e.jsx(k,{variant:"outline",className:"w-full border-[hsl(var(--boogasi-green-val))] text-[hsl(var(--boogasi-green-val))] hover:bg-[hsl(var(--boogasi-green-val))]/10",onClick:()=>v("/profile",{state:{activeTab:"notes"}}),children:"View All Notes"})})]}),e.jsxs(L,{className:"shadow-xl p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-[hsl(var(--brighter-text-info))]",children:"Feed Filters"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{variant:c==="latest"?"default":"outline",className:"w-full justify-start",onClick:()=>w("latest"),children:[e.jsx(he,{size:16,className:"mr-2"})," Latest"]}),e.jsxs(k,{variant:c==="popular"?"default":"outline",className:"w-full justify-start",onClick:()=>w("popular"),children:[e.jsx(De,{size:16,className:"mr-2"})," Popular (Soon)"]}),e.jsxs(k,{variant:"outline",className:"w-full justify-start",onClick:()=>f({title:"🚧 Feature not implemented"}),children:[e.jsx(ue,{size:16,className:"mr-2"})," Announcements (Soon)"]}),e.jsxs(k,{variant:"outline",className:"w-full justify-start",onClick:()=>f({title:"🚧 Feature not implemented"}),children:[e.jsx(Ce,{size:16,className:"mr-2"})," Marketplace (Soon)"]}),e.jsxs(k,{variant:"outline",className:"w-full justify-start",onClick:()=>f({title:"🚧 Feature not implemented"}),children:[e.jsx(ke,{size:16,className:"mr-2"})," User Activity (Soon)"]})]})]})]})},Qe=({post:t,user:r,onReaction:i,onComment:m,onRepost:_,onItemClick:x})=>{var S,c,w,v,f,z,E,a,l;const p={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,y:-10,transition:{duration:.2}}},j=(S=t.post_reactions)==null?void 0:S.some(s=>s.user_id===(r==null?void 0:r.id)&&s.reaction_type==="like"),N=(c=t.reposts)==null?void 0:c.some(s=>s.user_id===(r==null?void 0:r.id)),g=()=>{var o,n,d,C;if(t.listings)return e.jsx(Me,{size:18,className:"text-[hsl(var(--boogasi-blue-val))]"});if(t.digital_products)return e.jsx(ze,{size:18,className:"text-[hsl(var(--boogasi-purple-val))]"});if(t.shared_article_url)return e.jsx(W,{size:18,className:"text-[hsl(var(--boogasi-teal-val))]"});const s=((o=t.content)==null?void 0:o.toLowerCase())||"";return s.includes("announcement")||s.includes("update")?e.jsx(ue,{size:18,className:"text-[hsl(var(--boogasi-orange-val))]"}):s.includes("launch")||s.includes("new product")?e.jsx(Ve,{size:18,className:"text-[hsl(var(--boogasi-pink-val))]"}):(d=(n=t.profiles)==null?void 0:n.screen_name)!=null&&d.toLowerCase().includes("boogasi admin")?e.jsx(Oe,{size:18,className:"text-[hsl(var(--boogasi-red-val))]"}):(C=t.profiles)!=null&&C.avatar_url?e.jsx(ie,{src:t.profiles.avatar_url,alt:t.profiles.screen_name}):e.jsx(Je,{size:18,className:"text-[hsl(var(--boogasi-green-val))]"})},b=()=>{var o,n,d,C;if((o=t.profiles)!=null&&o.screen_name)return t.profiles.screen_name.substring(0,1).toUpperCase();if(t.listings)return"L";if(t.digital_products)return"P";if(t.shared_article_url)return"A";const s=((n=t.content)==null?void 0:n.toLowerCase())||"";return s.includes("announcement")||s.includes("update")?"!":s.includes("launch")||s.includes("new product")?"🚀":(C=(d=t.profiles)==null?void 0:d.screen_name)!=null&&C.toLowerCase().includes("boogasi admin")?"B":"U"},y=t.created_at?He(new Date(t.created_at),{addSuffix:!0}):"recently";return e.jsx(oe.div,{variants:p,initial:"hidden",animate:"visible",exit:"exit",layout:!0,children:e.jsxs(L,{className:"shadow-md overflow-hidden feed-card-style border border-[hsl(var(--brighter-border-val))]",children:[e.jsxs(U,{className:"flex flex-row items-start space-x-3 p-4",children:[e.jsxs(re,{className:"h-10 w-10 border-2 border-[hsl(var(--feed-primary-brighter))]",children:[g(),e.jsx(ne,{className:"bg-[hsl(var(--feed-secondary-brighter))] text-[hsl(var(--secondary-foreground))]",children:b()})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{onClick:()=>x(t),className:"cursor-pointer",children:[e.jsx(T,{className:"text-base font-semibold hover:underline text-[hsl(var(--brighter-foreground-val))]",children:((w=t.profiles)==null?void 0:w.screen_name)||((v=t.profiles)==null?void 0:v.name)||"Boogasi Update"}),e.jsx(de,{className:"text-xs text-[hsl(var(--brighter-muted-foreground-val))]",children:y})]})})]}),e.jsxs(O,{className:"px-4 pb-2 text-sm text-[hsl(var(--brighter-foreground-val))] cursor-pointer",onClick:()=>x(t),children:[t.shared_article_url&&e.jsxs("div",{className:"mb-3 p-3 border rounded-md bg-[hsl(var(--brighter-card-alt-bg-val))]",children:[e.jsx("p",{className:"text-xs text-[hsl(var(--brighter-muted-foreground-val))]",children:"Shared Article:"}),e.jsxs("a",{href:t.shared_article_url,target:"_blank",rel:"noopener noreferrer",className:"text-[hsl(var(--brighter-text-accent))] hover:underline font-semibold text-base block",onClick:s=>s.stopPropagation(),children:[t.shared_article_title||"View Article"," ",e.jsx(Se,{size:14,className:"inline ml-1"})]}),t.shared_article_source&&e.jsxs("p",{className:"text-xs text-[hsl(var(--brighter-muted-foreground-val))]",children:["Source: ",t.shared_article_source]}),t.shared_article_summary&&e.jsx("p",{className:"text-xs text-[hsl(var(--brighter-muted-foreground-val))] mt-1 line-clamp-2",children:t.shared_article_summary})]}),e.jsx("p",{className:"whitespace-pre-wrap line-clamp-4",children:t.content}),t.image_upload_url&&e.jsx("img",{loading:"lazy",src:t.image_upload_url,alt:"Post image",className:"mt-2 rounded-md max-h-72 w-auto mx-auto object-contain"}),t.video_upload_url&&e.jsx("div",{className:"mt-2 relative rounded-md overflow-hidden",style:{paddingBottom:"56.25%",height:0},children:e.jsx("video",{src:t.video_upload_url,controls:!0,className:"absolute top-0 left-0 w-full h-full",onClick:s=>s.stopPropagation()})}),t.file_upload_url&&e.jsxs("div",{className:"mt-2 p-2 border rounded-md bg-[hsl(var(--brighter-card-alt-bg-val))] flex items-center justify-between",children:[e.jsxs("a",{href:t.file_upload_url,target:"_blank",rel:"noopener noreferrer",className:"text-[hsl(var(--brighter-text-accent))] hover:underline flex items-center",onClick:s=>s.stopPropagation(),children:[e.jsx(W,{size:16,className:"mr-1"}),t.file_upload_name||"View Attached File"]}),e.jsx("span",{className:"text-xs text-[hsl(var(--brighter-muted-foreground-val))]",children:t.file_upload_type})]}),t.listings&&e.jsxs("div",{className:"mt-3 border rounded-md p-3 bg-[hsl(var(--brighter-card-alt-bg-val))] hover:shadow-sm",children:[e.jsx("p",{className:"font-semibold text-xs text-[hsl(var(--brighter-text-primary))]",children:"Marketplace Listing Attached:"}),e.jsx("p",{className:"text-sm font-medium",children:t.listings.title}),e.jsxs("p",{className:"text-xs",children:["Seeking: $",(f=t.listings.amount_sought)==null?void 0:f.toLocaleString()]})]}),t.digital_products&&e.jsxs("div",{className:"mt-3 border rounded-md p-3 bg-[hsl(var(--brighter-card-alt-bg-val))] hover:shadow-sm",children:[e.jsx("p",{className:"font-semibold text-xs text-[hsl(var(--brighter-text-info))]",children:"Digital Product Attached:"}),e.jsx("p",{className:"text-sm font-medium",children:t.digital_products.title}),e.jsxs("p",{className:"text-xs",children:["Price: $",(z=t.digital_products.price)==null?void 0:z.toLocaleString()]})]})]}),e.jsxs(me,{className:"flex justify-around p-2 border-t border-[hsl(var(--brighter-border-val))]",children:[e.jsxs(k,{variant:"ghost",size:"sm",className:`hover:text-[hsl(var(--primary))] ${j?"text-[hsl(var(--primary))]":"text-[hsl(var(--brighter-muted-foreground-val))]"}`,onClick:s=>{s.stopPropagation(),i(t.id,"like")},children:[e.jsx(Pe,{size:16,className:"mr-1"})," Like (",((E=t.post_reactions)==null?void 0:E.filter(s=>s.reaction_type==="like").length)||0,")"]}),e.jsxs(k,{variant:"ghost",size:"sm",className:"hover:text-[hsl(var(--primary))] text-[hsl(var(--brighter-muted-foreground-val))]",onClick:s=>{s.stopPropagation(),m(t)},children:[e.jsx(Te,{size:16,className:"mr-1"})," Comment (",((a=t.post_comments)==null?void 0:a.length)||0,")"]}),e.jsxs(k,{variant:"ghost",size:"sm",className:`hover:text-[hsl(var(--primary))] ${N?"text-[hsl(var(--primary))]":"text-[hsl(var(--brighter-muted-foreground-val))]"}`,onClick:s=>{s.stopPropagation(),_(t.id)},children:[e.jsx($e,{size:16,className:"mr-1"})," Repost (",((l=t.reposts)==null?void 0:l.length)||0,")"]})]}),t.post_comments&&t.post_comments.length>0&&e.jsxs("div",{className:"px-4 pb-2 pt-1 bg-[hsl(var(--brighter-card-alt-bg-val))] border-t border-[hsl(var(--brighter-border-val))]",children:[e.jsx("h4",{className:"text-xs font-semibold mb-1 text-[hsl(var(--brighter-foreground-val))]",children:"Comments:"}),t.post_comments.slice(0,1).map(s=>{var o;return e.jsxs("div",{className:"text-xs mb-1 p-1 rounded ",children:[e.jsxs("span",{className:"font-semibold text-[hsl(var(--brighter-text-primary))]",children:[((o=s.profiles)==null?void 0:o.screen_name)||"User",": "]}),e.jsx("span",{className:"text-[hsl(var(--brighter-muted-foreground-val))] line-clamp-1",children:s.content})]},s.id)}),t.post_comments.length>1&&e.jsx(k,{variant:"link",size:"sm",className:"text-xs p-0 h-auto text-[hsl(var(--brighter-text-accent))] hover:text-[hsl(var(--primary))]",onClick:s=>{s.stopPropagation(),m(t)},children:"View all comments"})]})]})})},Je=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"}),e.jsx("path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"})]}),et=({posts:t,isLoading:r,user:i,handleReaction:m,openCommentModalHandler:_,handleRepost:x,handleItemClick:p,hasMorePosts:j,fetchNextPage:N})=>r&&t.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(H,{className:"h-10 w-10 animate-spin text-[hsl(var(--feed-primary-brighter))]"})}):t.length===0&&!r?e.jsx("p",{className:"text-center py-10 text-muted-foreground",children:"No posts yet. Be the first to share something!"}):e.jsxs(e.Fragment,{children:[e.jsx(oe.div,{layout:!0,className:"space-y-6",children:e.jsx(Fe,{initial:!1,children:t.map(g=>e.jsx(Qe,{post:g,user:i,onReaction:m,onComment:_,onRepost:x,onItemClick:p},g.id))})}),j&&!r&&t.length>0&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsxs(k,{onClick:N,disabled:r,children:[r?e.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}):null," Load More"]})})]}),tt=()=>{const{toast:t}=$(),r=["#AIInnovation","#StartupGrowth","#CryptoNews","#EcoInvesting","#BoogasiUpdates"];return e.jsxs("aside",{className:"lg:col-span-3 space-y-6 hidden lg:block",children:[e.jsxs(L,{className:"shadow-xl",children:[e.jsx(U,{children:e.jsx(T,{className:"text-[hsl(var(--boogasi-purple-val))]",children:"Trending Topics"})}),e.jsx(O,{children:e.jsx("ul",{className:"space-y-1 text-sm",children:r.map(i=>e.jsx("li",{children:e.jsx(k,{variant:"link",className:"p-0 h-auto text-muted-foreground hover:text-[hsl(var(--boogasi-purple-val))]",onClick:()=>t({title:"🚧 Feature not implemented"}),children:i})},i))})})]}),e.jsxs(L,{className:"shadow-xl",children:[e.jsx(U,{children:e.jsx(T,{className:"text-[hsl(var(--boogasi-orange-val))]",children:"Sponsored"})}),e.jsx(O,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Premium tools for investors - Coming Soon!"})})]})]})},ut=()=>{const{user:t}=Ee(),r=le(),{posts:i,isLoadingPosts:m,hasMorePosts:_,filter:x,setFilter:p,handleRefreshPosts:j,handlePostCreated:N,handleReaction:g,handleCommentSubmit:b,handleRepost:y,fetchNextPage:S}=Ze(t),{userNotes:c,isNoteModalOpen:w,setIsNoteModalOpen:v,currentNote:f,noteTitle:z,setNoteTitle:E,noteContent:a,setNoteContent:l,savingNote:s,handleOpenNewNoteModal:o,handleOpenEditNoteModal:n,handleSaveNote:d,handleDeleteNote:C}=Xe(t),[F,h]=u.useState(!1),[I,D]=u.useState(null),Z=P=>{D(P),h(!0)},A=async(P,V)=>{await b(P,V)&&h(!1)},R=P=>{var V,X;(V=P.listings)!=null&&V.id?r(`/marketplace?listing=${P.listings.id}`):(X=P.digital_products)!=null&&X.id?r(`/product/${P.digital_products.id}`):P.shared_article_url&&window.open(P.shared_article_url,"_blank")};return e.jsxs("div",{className:"container mx-auto py-8 px-2 md:px-4 grid grid-cols-1 lg:grid-cols-12 gap-8 brighter-theme-area",children:[e.jsx(Ke,{userNotes:c,isNoteModalOpen:w,setIsNoteModalOpen:v,currentNote:f,noteTitle:z,setNoteTitle:E,noteContent:a,setNoteContent:l,handleSaveNote:d,savingNote:s,handleOpenNewNoteModal:o,handleOpenEditNoteModal:n,handleDeleteNote:C,filter:x,setFilter:p}),e.jsxs("main",{className:"lg:col-span-6 space-y-6",children:[e.jsx(Ge,{user:t,onPostCreated:N}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(k,{variant:"outline",size:"sm",onClick:j,disabled:m,children:[e.jsx(he,{size:16,className:`mr-2 ${m?"animate-spin":""}`})," Refresh Feed"]})}),e.jsx(et,{posts:i,isLoading:m,user:t,handleReaction:g,openCommentModalHandler:Z,handleRepost:y,handleItemClick:R,hasMorePosts:_,fetchNextPage:S})]}),I&&e.jsx(We,{isOpen:F,setIsOpen:h,post:I,user:t,onSubmitComment:A}),e.jsx(tt,{})]})};export{ut as default};
