import{E as A,w as k,u as h,j as e,p as x,I as p,a as E,q as P,x as S,G as q,m as L,R as W,$ as V,a0 as z,F as J,a1 as K}from"./index-59f5f71c.js";import{o as B,s as v,l as H,b as Y,u as $,t as G}from"./types-9a93e89b.js";import{T as Q}from"./textarea-e62d43bd.js";import{C as M}from"./checkbox-5ec660f3.js";import{U}from"./upload-cloud-99f1496b.js";import{P as X}from"./ProductSubmissionForm-e6c50523.js";import{C as D}from"./check-circle-17b1b3e8.js";import"./index-be2d9432.js";import"./select-4f727b9b.js";import"./x-circle-3542237b.js";import"./video-e62a3e1e.js";import"./plus-circle-3fa46472.js";const Z=B({companyName:v().min(2,"Name must be at least 2 characters").max(100),contactEmail:v().email("Invalid email address"),billingAddress:v().min(10,"Billing address is too short").max(200),phoneNumber:v().min(7,"Phone number seems too short").max(20),websitePortfolio:v().url("Invalid URL").optional().or(H("")),taxId:v().min(5,"Tax ID seems too short").max(50),agreeToTerms:Y().refine(r=>r===!0,{message:"You must agree to the terms and conditions."}),digitalSignature:v().min(2,"Signature must be at least 2 characters").max(100)}),R="boogasi",ee=({onNext:r})=>{const{user:c}=A(),{toast:l}=k(),[f,i]=h.useState(!1),[o,C]=h.useState(null),[b,m]=h.useState(null),{register:d,handleSubmit:w,formState:{errors:a},setValue:T,watch:j}=$({resolver:G(Z),defaultValues:{companyName:"",contactEmail:(c==null?void 0:c.email)||"",billingAddress:"",phoneNumber:"",websitePortfolio:"",taxId:"",agreeToTerms:!1,digitalSignature:""}}),y=s=>t=>{const n=t.target.files[0];if(n){if(n.size>5*1024*1024){l({variant:"destructive",title:"File too large",description:"Please upload a file smaller than 5MB."}),t.target.value=null;return}s(n)}},N=async(s,t)=>{if(!s||!c)return null;const n=`${t}/${c.id}/${Date.now()}-${s.name.replace(/\s+/g,"_")}`;try{const{data:u,error:g}=await S.storage.from(R).upload(n,s);if(g)throw g;const{data:_}=S.storage.from(R).getPublicUrl(u.path);return _.publicUrl}catch(u){throw console.error(`Error uploading ${t}:`,u),l({variant:"destructive",title:`Upload Failed for ${s.name}`,description:u.message}),u}},F=async s=>{if(!c){l({variant:"destructive",title:"Not Authenticated",description:"Please log in to register as a seller."});return}i(!0);try{const t=await N(o,"seller-documents/government-ids"),n=await N(b,"seller-documents/tax-certificates"),{data:u,error:g}=await S.from("sellers").insert({user_id:c.id,company_name:s.companyName,contact_email:s.contactEmail,billing_address:s.billingAddress,phone_number:s.phoneNumber,website_portfolio:s.websitePortfolio||null,tax_id:s.taxId,government_id_url:t,tax_certificate_url:n,agreed_to_terms:s.agreeToTerms,digital_signature:s.digitalSignature,status:"pending_agreement"}).select().single();if(g)throw g;l({title:"Registration Step 1 Complete",description:"Please review and sign the marketing agreement."}),r(u)}catch(t){l({variant:"destructive",title:"Registration Failed",description:t.message})}finally{i(!1)}};return e.jsxs("form",{onSubmit:w(F),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"companyName",children:"Company or Individual Name"}),e.jsx(p,{id:"companyName",...d("companyName")}),a.companyName&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.companyName.message})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"contactEmail",children:"Contact Email"}),e.jsx(p,{id:"contactEmail",type:"email",...d("contactEmail")}),a.contactEmail&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.contactEmail.message})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"billingAddress",children:"Billing Address"}),e.jsx(Q,{id:"billingAddress",...d("billingAddress")}),a.billingAddress&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.billingAddress.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(p,{id:"phoneNumber",type:"tel",...d("phoneNumber")}),a.phoneNumber&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.phoneNumber.message})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"websitePortfolio",children:"Website or Portfolio (Optional)"}),e.jsx(p,{id:"websitePortfolio",...d("websitePortfolio"),placeholder:"https://example.com"}),a.websitePortfolio&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.websitePortfolio.message})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"taxId",children:"EIN or SSN (based on region)"}),e.jsx(p,{id:"taxId",...d("taxId")}),a.taxId&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.taxId.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"governmentIdFile",children:"Upload Government-Issued ID (Required)"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md border-border hover:border-primary transition-colors",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx(U,{className:"mx-auto h-10 w-10 text-muted-foreground"}),e.jsx("div",{className:"flex text-sm text-muted-foreground",children:e.jsxs("label",{htmlFor:"governmentIdFile",className:"relative cursor-pointer rounded-md font-medium text-primary hover:text-primary/80 focus-within:outline-none focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",children:[e.jsx("span",{children:o?o.name:"Upload a file"}),e.jsx(p,{id:"governmentIdFile",type:"file",className:"sr-only",onChange:y(C),accept:"image/*,application/pdf",required:!0})]})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"PDF, PNG, JPG up to 5MB"})]})})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"taxCertificateFile",children:"Tax Certificate (Optional)"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md border-border hover:border-primary transition-colors",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx(U,{className:"mx-auto h-10 w-10 text-muted-foreground"}),e.jsx("div",{className:"flex text-sm text-muted-foreground",children:e.jsxs("label",{htmlFor:"taxCertificateFile",className:"relative cursor-pointer rounded-md font-medium text-primary hover:text-primary/80 focus-within:outline-none focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",children:[e.jsx("span",{children:b?b.name:"Upload a file"}),e.jsx(p,{id:"taxCertificateFile",type:"file",className:"sr-only",onChange:y(m),accept:"image/*,application/pdf"})]})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"PDF, PNG, JPG up to 5MB"})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:"agreeToTerms",checked:j("agreeToTerms"),onCheckedChange:s=>T("agreeToTerms",s)}),e.jsx(x,{htmlFor:"agreeToTerms",className:"cursor-pointer",children:"I agree to the Boogasi Seller Terms and Conditions."})]}),a.agreeToTerms&&e.jsx("p",{className:"text-sm text-destructive",children:a.agreeToTerms.message})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"digitalSignature",children:"Digital Signature (Type your full name)"}),e.jsx(p,{id:"digitalSignature",...d("digitalSignature"),placeholder:"Your Full Name"}),a.digitalSignature&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:a.digitalSignature.message})]}),e.jsxs(E,{type:"submit",className:"w-full",disabled:f,children:[f&&e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Proceed to Agreement"]})]})},te=B({agreeToContractTerms:Y().refine(r=>r===!0,{message:"You must agree to the contract terms."}),typedName:v().min(2,"Signature must be at least 2 characters").max(100)}),re=({sellerData:r,onNext:c})=>{var j;const{user:l}=A(),{toast:f}=k(),[i,o]=h.useState(!1),{register:C,handleSubmit:b,formState:{errors:m},setValue:d,watch:w}=$({resolver:G(te),defaultValues:{agreeToContractTerms:(r==null?void 0:r.agreed_to_terms_current)||!1,typedName:(r==null?void 0:r.digital_signature)||((j=l==null?void 0:l.user_metadata)==null?void 0:j.name)||""}}),a=`
    Digital Marketing & Seller Agreement
    Boogasi Seller Agreement
    Last Updated: ${new Date().toLocaleDateString()}
    
    1. Commission Terms
    You (the Seller) agree that Boogasi ("Platform") will collect payment on your behalf for any digital product sold through the platform.
    We retain 25% of the final sale price as a service and marketing fee.
    You receive 75% of each sale.
    No listing fees, registration fees, or marketing charges. Lifetime free membership for all vendors.
    Payouts are made according to the Platform's payout schedule (e.g., biweekly or monthly, to be detailed separately).
    
    2. What We Provide
    - SEO-friendly public seller page.
    - Tools for 1-click purchase and automated delivery of digital goods.
    - Access to buyers and exposure through our marketplace.
    - Dedicated product listing form and management tools.
    - Secure payment collection.
    
    3. What You Must Provide
    - A working digital product with clear instructions for use.
    - Reliable delivery via file download or access link.
    - Product photos (up to 5 per listing).
    - Clear warranty or refund information for your products.
    - Accurate tax and identification information (e.g., SSN, EIN) as required.
    
    4. Legal Terms
    - You certify that all content and products you list are owned by you or that you have the legal right to sell them.
    - Refunds will be processed based on the policy you provide for each product. The Platform will facilitate this.
    - The Platform may remove listings or suspend accounts for products that violate laws, intellectual property rights, or marketplace guidelines.
    - Commission rates and payout terms are as stated herein and are non-negotiable. Payouts are automated based on sales.
    
    5. Signature
    By checking the box and submitting this form with your typed full name, you acknowledge that you have read, understood, and agree to be bound by the terms of this Digital Marketing & Seller Agreement.
      `,T=async y=>{if(!l||!(r!=null&&r.id)){f({variant:"destructive",title:"Error",description:"User or seller data is missing. Please try again."});return}o(!0);try{const{error:N}=await S.from("seller_agreements").insert({seller_id:r.id,user_id:l.id,agreement_text:a,signed_name:y.typedName,signed_date:new Date().toISOString().split("T")[0],ip_address:"not_collected"});if(N)throw N;const{data:F,error:s}=await S.from("sellers").update({status:"pending_approval",agreed_to_terms_current:!0,digital_signature:y.typedName,signature_date:new Date().toISOString()}).eq("id",r.id).select().single();if(s)throw s;f({title:"Agreement Signed!",description:"You can now start listing your products."}),c(F)}catch(N){f({variant:"destructive",title:"Agreement Submission Failed",description:N.message})}finally{o(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-foreground",children:"Digital Marketing & Seller Agreement"}),e.jsx("div",{className:"paper-document-style max-h-96 overflow-y-auto",children:e.jsx("pre",{children:a})}),e.jsxs("form",{onSubmit:b(T),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:"agreeToContractTerms",checked:w("agreeToContractTerms"),onCheckedChange:y=>d("agreeToContractTerms",y)}),e.jsx(x,{htmlFor:"agreeToContractTerms",className:"cursor-pointer text-foreground",children:"I agree to the Seller Terms and 25% Commission."})]}),m.agreeToContractTerms&&e.jsx("p",{className:"text-sm text-destructive",children:m.agreeToContractTerms.message})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"typedName",className:"text-foreground",children:"Typed Full Name (Digital Signature)"}),e.jsx(p,{id:"typedName",...C("typedName"),placeholder:"Your Full Name",className:"bg-input text-foreground border-border"}),m.typedName&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:m.typedName.message})]}),e.jsxs("div",{children:[e.jsx(x,{className:"text-foreground",children:"Date"}),e.jsx(p,{type:"text",value:new Date().toLocaleDateString(),disabled:!0,className:"bg-muted text-muted-foreground"})]}),e.jsxs(E,{type:"submit",className:"w-full bg-primary text-primary-foreground hover:bg-primary/90",disabled:i,children:[i&&e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Agree & Continue"]})]})]})},I=[{id:"registration",title:"Seller Registration",icon:z},{id:"agreement",title:"Marketing Agreement",icon:J},{id:"first_product",title:"List First Product",icon:K},{id:"completed",title:"Onboarding Complete",icon:D}],pe=()=>{const{user:r,loading:c}=A(),l=q(),{toast:f}=k(),[i,o]=h.useState("registration"),[C,b]=h.useState(!0),[m,d]=h.useState(null),[w,a]=h.useState(!1),T=h.useCallback(async()=>{if(!(!r||w)){b(!0);try{const{data:t,error:n}=await S.from("sellers").select("*").eq("user_id",r.id).maybeSingle();if(n&&n.code!=="PGRST116")throw n;if(d(t),t)if(t.status==="pending_approval"||t.status==="active"){const{data:u,error:g}=await S.from("digital_products").select("id",{count:"exact",head:!0}).eq("seller_id",t.id).limit(1);g&&g.code!=="PGRST116"&&console.warn("Error checking products:",g.message),u&&u.length>0?o("completed"):t.agreed_to_terms_current?o("first_product"):o("agreement")}else t.status==="pending_agreement"?o("agreement"):o("registration");else o("registration");a(!0)}catch(t){f({variant:"destructive",title:"Error fetching seller status",description:t.message}),o("registration")}finally{b(!1)}}},[r,f,w]);h.useEffect(()=>{!c&&r?T():!c&&!r&&(l("/auth?type=login&redirect=/sell-on-boogasi"),b(!1))},[r,c,l,T]);const j=t=>{d(t||m),i==="registration"?o("agreement"):i==="agreement"?o("first_product"):i==="first_product"&&o("completed")},y=t=>{d(t),j(t)},N=t=>{d(t),j(t)},F=t=>{d(t),j(t)};if(C||c)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(P,{className:"h-12 w-12 animate-spin text-primary"})});const s=()=>I.findIndex(t=>t.id===i);return e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs(L.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold mb-3 bg-clip-text text-transparent bg-gradient-to-r from-primary to-secondary",children:"Become a Seller on Boogasi"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Follow these steps to start selling your digital products."})]}),e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("div",{className:"mb-8 flex items-center justify-between",children:I.map((t,n)=>{const u=s(),g=n<u,_=n===u,O=t.icon;return e.jsxs(W.Fragment,{children:[e.jsxs("div",{className:`flex flex-col items-center text-center ${_?"text-primary":g?"text-green-500":"text-muted-foreground"}`,children:[e.jsx("div",{className:`p-3 rounded-full border-2 mb-2 transition-all duration-300
                        ${_?"bg-primary/10 border-primary":g?"bg-green-500/10 border-green-500":"border-border"}
                      `,children:g?e.jsx(V,{className:"h-6 w-6"}):e.jsx(O,{className:"h-6 w-6"})}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:t.title})]}),n<I.length-1&&e.jsx("div",{className:`flex-1 h-1 mx-2 rounded-full transition-all duration-500 ${g||_&&n<u?"bg-green-500":_?"bg-primary":"bg-border"}`})]},t.id)})}),e.jsxs(L.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.5},className:"p-6 sm:p-8 border rounded-xl shadow-xl bg-card",children:[i==="registration"&&e.jsx(ee,{onNext:y}),i==="agreement"&&m&&e.jsx(re,{sellerData:m,onNext:N}),i==="agreement"&&!m&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Loading seller details for agreement..."}),e.jsx(P,{className:"h-8 w-8 animate-spin text-primary mx-auto"})]}),i==="first_product"&&m&&e.jsx(X,{sellerData:m,onNext:F}),i==="first_product"&&!m&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Loading seller details for product submission..."}),e.jsx(P,{className:"h-8 w-8 animate-spin text-primary mx-auto"})]}),i==="completed"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(D,{className:"h-24 w-24 text-green-500 mx-auto mb-6"}),e.jsx("h2",{className:"text-3xl font-semibold mb-4",children:"Onboarding Complete!"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Congratulations! Your seller account is set up and your first product is listed (or pending approval). You can now manage your store and products from your dashboard."}),e.jsx(E,{onClick:()=>l("/seller-dashboard"),size:"lg",children:"Go to Seller Dashboard"})]})]},i)]})]})};export{pe as default};
